{"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/tur-mgx.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nrequire(\"@imstar15/api-augment\");\nvar _api = require(\"@polkadot/api\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _oakHelper = _interopRequireDefault(require(\"./common/oakHelper\"));\nvar _mangataHelper = _interopRequireDefault(require(\"./common/mangataHelper\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst SUBSTRATE_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst TURING_ENDPOINT = process.env.TURING_ENDPOINT;\nconst MANGATA_ENDPOINT = process.env.MANGATA_ENDPOINT;\n\n// const OAK_SOV_ACCOUNT = \"68kxzikS2WZNkYSPWdYouqH5sEZujecVCy3TFt9xHWB5MDG5\";\n\nasync function main() {\n  await (0, _utilCrypto.cryptoWaitReady)();\n  const keyring = new _api.Keyring();\n  const keyPair = keyring.addFromUri('//Alice', undefined, 'sr25519');\n  console.log('Account address: ', keyPair.address);\n\n  // Initialize\n  await _oakHelper.default.initialize(TURING_ENDPOINT);\n  await _mangataHelper.default.initialize(MANGATA_ENDPOINT);\n  const oakApi = _oakHelper.default.getApi();\n  const freeBalance = await _mangataHelper.default.checkFreeBalance(keyPair.address);\n  console.log(\"freeBalance on Mangata\", freeBalance.toString());\n  const proxyAccount = _oakHelper.default.getProxyAccount(keyPair.address);\n  console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n  _mangataHelper.default.addProxy(proxyAccount, keyPair);\n  console.log('Add proxy on mangata successfully!');\n  const proxyExtrinsic = _mangataHelper.default.getApi().tx.system.remarkWithEvent(\"Hello, world!\");\n  const mangataProxyCall = await _mangataHelper.default.createProxyCall(keyPair.address, proxyExtrinsic);\n  const encodedMangataProxyCall = mangataProxyCall.method.toHex(mangataProxyCall);\n  const mangataProxyCallFees = await mangataProxyCall.paymentInfo(keyPair.address);\n  console.log('encodedMangataProxyCall: ', encodedMangataProxyCall);\n  console.log('mangataProxyCallFees: ', mangataProxyCallFees.toHuman());\n\n  // Schedule automated task on Oak\n  // 1. Create the call for scheduleXcmpTask \n  const providedId = \"xcmp_automation_test_\" + (Math.random() + 1).toString(36).substring(7);\n  const xcmpCall = oakApi.tx.automationTime.scheduleXcmpTask(providedId, {\n    Fixed: {\n      executionTimes: [0]\n    }\n  }, MANGATA_PARA_ID, 0, encodedMangataProxyCall, mangataProxyCallFees.weight);\n  console.log('xcmpCall: ', xcmpCall);\n  const xcmFrees = await _oakHelper.default.getXcmFees(keyPair.address, xcmpCall);\n  console.log(\"xcmFrees:\", xcmFrees.toHuman());\n\n  // 3. Sign and send scheduleXcmpTask call.\n  // Get TaskId for Task.\n  const taskId = await oakApi.rpc.automationTime.generateTaskId(keyPair.address, providedId);\n  console.log(\"TaskId:\", taskId.toHuman());\n  await _oakHelper.default.sendXcmExtrinsic(xcmpCall, keyPair, taskId);\n}\nmain().catch(console.error).finally(() => process.exit());\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTVUJTVFJBVEVfU1M1OCIsIlRBUkdFVF9QQVJBX0lEIiwicHJvY2VzcyIsImVudiIsIk9BS19FTkRQT0lOVCIsIlRBUkdFVF9FTkRQT0lOVCIsIm1haW4iLCJjcnlwdG9XYWl0UmVhZHkiLCJrZXlyaW5nIiwiS2V5cmluZyIsImtleVBhaXIiLCJhZGRGcm9tVXJpIiwidW5kZWZpbmVkIiwiY29uc29sZSIsImxvZyIsImFkZHJlc3MiLCJvYWtIZWxwZXIiLCJpbml0aWFsaXplIiwibWFuZ2F0YUhlbHBlciIsIm9ha0FwaSIsImdldEFwaSIsImZyZWVCYWxhbmNlIiwiY2hlY2tGcmVlQmFsYW5jZSIsInRvU3RyaW5nIiwicHJveHlBY2NvdW50IiwiZ2V0UHJveHlBY2NvdW50IiwiZW5jb2RlQWRkcmVzcyIsImFkZFByb3h5IiwicHJveHlFeHRyaW5zaWMiLCJ0eCIsInN5c3RlbSIsInJlbWFya1dpdGhFdmVudCIsIm1hbmdhdGFQcm94eUNhbGwiLCJjcmVhdGVQcm94eUNhbGwiLCJlbmNvZGVkTWFuZ2F0YVByb3h5Q2FsbCIsIm1ldGhvZCIsInRvSGV4IiwibWFuZ2F0YVByb3h5Q2FsbEZlZXMiLCJwYXltZW50SW5mbyIsInRvSHVtYW4iLCJwcm92aWRlZElkIiwiTWF0aCIsInJhbmRvbSIsInN1YnN0cmluZyIsInhjbXBDYWxsIiwiYXV0b21hdGlvblRpbWUiLCJzY2hlZHVsZVhjbXBUYXNrIiwiRml4ZWQiLCJleGVjdXRpb25UaW1lcyIsIndlaWdodCIsInhjbUZyZWVzIiwiZ2V0WGNtRmVlcyIsInRhc2tJZCIsInJwYyIsImdlbmVyYXRlVGFza0lkIiwic2VuZFhjbUV4dHJpbnNpYyIsImNhdGNoIiwiZXJyb3IiLCJmaW5hbGx5IiwiZXhpdCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL21pa2FzYS9Db2RlL3hjbS1kZW1vL3hjbXBfYXV0b21hdGlvbi9zcmMvIiwic291cmNlcyI6WyJ0dXItbWd4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcIkBpbXN0YXIxNS9hcGktYXVnbWVudFwiO1xuaW1wb3J0IHsgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyBjcnlwdG9XYWl0UmVhZHkgfSBmcm9tICdAcG9sa2Fkb3QvdXRpbC1jcnlwdG8nO1xuaW1wb3J0IG9ha0hlbHBlciBmcm9tIFwiLi9jb21tb24vb2FrSGVscGVyXCI7XG5pbXBvcnQgbWFuZ2F0YUhlbHBlciBmcm9tIFwiLi9jb21tb24vbWFuZ2F0YUhlbHBlclwiO1xuXG5jb25zdCBTVUJTVFJBVEVfU1M1OCA9IDQyO1xuY29uc3QgVEFSR0VUX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5UQVJHRVRfUEFSQV9JRDtcbmNvbnN0IE9BS19FTkRQT0lOVCA9IHByb2Nlc3MuZW52Lk9BS19FTkRQT0lOVDtcbmNvbnN0IFRBUkdFVF9FTkRQT0lOVCA9IHByb2Nlc3MuZW52LlRBUkdFVF9FTkRQT0lOVDtcblxuLy8gY29uc3QgT0FLX1NPVl9BQ0NPVU5UID0gXCI2OGt4emlrUzJXWk5rWVNQV2RZb3VxSDVzRVp1amVjVkN5M1RGdDl4SFdCNU1ERzVcIjtcblxuYXN5bmMgZnVuY3Rpb24gbWFpbiAoKSB7XG4gIGF3YWl0IGNyeXB0b1dhaXRSZWFkeSgpO1xuXG4gIGNvbnN0IGtleXJpbmcgPSBuZXcgS2V5cmluZygpO1xuICBjb25zdCBrZXlQYWlyID0ga2V5cmluZy5hZGRGcm9tVXJpKCcvL0FsaWNlJywgdW5kZWZpbmVkLCAnc3IyNTUxOScpO1xuICBjb25zb2xlLmxvZygnQWNjb3VudCBhZGRyZXNzOiAnLCBrZXlQYWlyLmFkZHJlc3MpO1xuXG4gIC8vIEluaXRpYWxpemVcbiAgYXdhaXQgb2FrSGVscGVyLmluaXRpYWxpemUoT0FLX0VORFBPSU5UKTtcbiAgYXdhaXQgbWFuZ2F0YUhlbHBlci5pbml0aWFsaXplKFRBUkdFVF9FTkRQT0lOVCk7XG4gIGNvbnN0IG9ha0FwaSA9IG9ha0hlbHBlci5nZXRBcGkoKTtcblxuICBjb25zdCBmcmVlQmFsYW5jZSA9IGF3YWl0IG1hbmdhdGFIZWxwZXIuY2hlY2tGcmVlQmFsYW5jZShrZXlQYWlyLmFkZHJlc3MpO1xuICBjb25zb2xlLmxvZyhcImZyZWVCYWxhbmNlIG9uIE1hbmdhdGFcIiwgZnJlZUJhbGFuY2UudG9TdHJpbmcoKSk7XG5cbiAgY29uc3QgcHJveHlBY2NvdW50ID0gb2FrSGVscGVyLmdldFByb3h5QWNjb3VudChrZXlQYWlyLmFkZHJlc3MpO1xuICBjb25zb2xlLmxvZyhcInByb3h5IGFjY291bnQ6XCIsIGtleXJpbmcuZW5jb2RlQWRkcmVzcyhwcm94eUFjY291bnQsIFNVQlNUUkFURV9TUzU4KSk7XG5cbiAgbWFuZ2F0YUhlbHBlci5hZGRQcm94eShwcm94eUFjY291bnQsIGtleVBhaXIpO1xuICBjb25zb2xlLmxvZygnQWRkIHByb3h5IG9uIG1hbmdhdGEgc3VjY2Vzc2Z1bGx5IScpO1xuXG4gIGNvbnN0IHByb3h5RXh0cmluc2ljID0gbWFuZ2F0YUhlbHBlci5nZXRBcGkoKS50eC5zeXN0ZW0ucmVtYXJrV2l0aEV2ZW50KFwiSGVsbG8sIHdvcmxkIVwiKTtcbiAgY29uc3QgbWFuZ2F0YVByb3h5Q2FsbCA9IGF3YWl0IG1hbmdhdGFIZWxwZXIuY3JlYXRlUHJveHlDYWxsKGtleVBhaXIuYWRkcmVzcywgcHJveHlFeHRyaW5zaWMpO1xuICBjb25zdCBlbmNvZGVkTWFuZ2F0YVByb3h5Q2FsbCA9IG1hbmdhdGFQcm94eUNhbGwubWV0aG9kLnRvSGV4KG1hbmdhdGFQcm94eUNhbGwpO1xuICBjb25zdCBtYW5nYXRhUHJveHlDYWxsRmVlcyA9IGF3YWl0IG1hbmdhdGFQcm94eUNhbGwucGF5bWVudEluZm8oa2V5UGFpci5hZGRyZXNzKTtcblxuICBjb25zb2xlLmxvZygnZW5jb2RlZE1hbmdhdGFQcm94eUNhbGw6ICcsIGVuY29kZWRNYW5nYXRhUHJveHlDYWxsKTtcbiAgY29uc29sZS5sb2coJ21hbmdhdGFQcm94eUNhbGxGZWVzOiAnLCBtYW5nYXRhUHJveHlDYWxsRmVlcy50b0h1bWFuKCkpO1xuXG4gICAvLyBTY2hlZHVsZSBhdXRvbWF0ZWQgdGFzayBvbiBPYWtcbiAgLy8gMS4gQ3JlYXRlIHRoZSBjYWxsIGZvciBzY2hlZHVsZVhjbXBUYXNrIFxuICBjb25zdCBwcm92aWRlZElkID0gXCJ4Y21wX2F1dG9tYXRpb25fdGVzdF9cIiArIChNYXRoLnJhbmRvbSgpICsgMSkudG9TdHJpbmcoMzYpLnN1YnN0cmluZyg3KTtcbiAgY29uc3QgeGNtcENhbGwgPSAgb2FrQXBpLnR4LmF1dG9tYXRpb25UaW1lLnNjaGVkdWxlWGNtcFRhc2soXG4gICAgcHJvdmlkZWRJZCxcbiAgICB7IEZpeGVkOiB7IGV4ZWN1dGlvblRpbWVzOiBbMF0gfSB9LFxuICAgIFRBUkdFVF9QQVJBX0lELFxuICAgIDAsXG4gICAgZW5jb2RlZE1hbmdhdGFQcm94eUNhbGwsXG4gICAgbWFuZ2F0YVByb3h5Q2FsbEZlZXMud2VpZ2h0LFxuICApO1xuICBjb25zb2xlLmxvZygneGNtcENhbGw6ICcsIHhjbXBDYWxsKTtcblxuICBjb25zdCB4Y21GcmVlcyA9IGF3YWl0IG9ha0hlbHBlci5nZXRYY21GZWVzKGtleVBhaXIuYWRkcmVzcywgeGNtcENhbGwpO1xuICBjb25zb2xlLmxvZyhcInhjbUZyZWVzOlwiLCB4Y21GcmVlcy50b0h1bWFuKCkpO1xuXG4gIC8vIDMuIFNpZ24gYW5kIHNlbmQgc2NoZWR1bGVYY21wVGFzayBjYWxsLlxuICAvLyBHZXQgVGFza0lkIGZvciBUYXNrLlxuICBjb25zdCB0YXNrSWQgPSBhd2FpdCBvYWtBcGkucnBjLmF1dG9tYXRpb25UaW1lLmdlbmVyYXRlVGFza0lkKGtleVBhaXIuYWRkcmVzcywgcHJvdmlkZWRJZCk7XG4gIGNvbnNvbGUubG9nKFwiVGFza0lkOlwiLCB0YXNrSWQudG9IdW1hbigpKTtcblxuICBhd2FpdCBvYWtIZWxwZXIuc2VuZFhjbUV4dHJpbnNpYyh4Y21wQ2FsbCwga2V5UGFpciwgdGFza0lkKTtcbn1cblxubWFpbigpLmNhdGNoKGNvbnNvbGUuZXJyb3IpLmZpbmFsbHkoKCkgPT4gcHJvY2Vz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","map":{"version":3,"names":["SUBSTRATE_SS58","MANGATA_PARA_ID","process","env","TURING_ENDPOINT","MANGATA_ENDPOINT","main","cryptoWaitReady","keyring","Keyring","keyPair","addFromUri","undefined","console","log","address","oakHelper","initialize","mangataHelper","oakApi","getApi","freeBalance","checkFreeBalance","toString","proxyAccount","getProxyAccount","encodeAddress","addProxy","proxyExtrinsic","tx","system","remarkWithEvent","mangataProxyCall","createProxyCall","encodedMangataProxyCall","method","toHex","mangataProxyCallFees","paymentInfo","toHuman","providedId","Math","random","substring","xcmpCall","automationTime","scheduleXcmpTask","Fixed","executionTimes","weight","xcmFrees","getXcmFees","taskId","rpc","generateTaskId","sendXcmExtrinsic","catch","error","finally","exit"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/","sources":["tur-mgx.js"],"sourcesContent":["import \"@imstar15/api-augment\";\nimport { Keyring } from \"@polkadot/api\";\nimport { cryptoWaitReady } from '@polkadot/util-crypto';\nimport oakHelper from \"./common/oakHelper\";\nimport mangataHelper from \"./common/mangataHelper\";\n\nconst SUBSTRATE_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst TURING_ENDPOINT = process.env.TURING_ENDPOINT;\nconst MANGATA_ENDPOINT = process.env.MANGATA_ENDPOINT;\n\n// const OAK_SOV_ACCOUNT = \"68kxzikS2WZNkYSPWdYouqH5sEZujecVCy3TFt9xHWB5MDG5\";\n\nasync function main () {\n  await cryptoWaitReady();\n\n  const keyring = new Keyring();\n  const keyPair = keyring.addFromUri('//Alice', undefined, 'sr25519');\n  console.log('Account address: ', keyPair.address);\n\n  // Initialize\n  await oakHelper.initialize(TURING_ENDPOINT);\n  await mangataHelper.initialize(MANGATA_ENDPOINT);\n  const oakApi = oakHelper.getApi();\n\n  const freeBalance = await mangataHelper.checkFreeBalance(keyPair.address);\n  console.log(\"freeBalance on Mangata\", freeBalance.toString());\n\n  const proxyAccount = oakHelper.getProxyAccount(keyPair.address);\n  console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n  mangataHelper.addProxy(proxyAccount, keyPair);\n  console.log('Add proxy on mangata successfully!');\n\n  const proxyExtrinsic = mangataHelper.getApi().tx.system.remarkWithEvent(\"Hello, world!\");\n  const mangataProxyCall = await mangataHelper.createProxyCall(keyPair.address, proxyExtrinsic);\n  const encodedMangataProxyCall = mangataProxyCall.method.toHex(mangataProxyCall);\n  const mangataProxyCallFees = await mangataProxyCall.paymentInfo(keyPair.address);\n\n  console.log('encodedMangataProxyCall: ', encodedMangataProxyCall);\n  console.log('mangataProxyCallFees: ', mangataProxyCallFees.toHuman());\n\n   // Schedule automated task on Oak\n  // 1. Create the call for scheduleXcmpTask \n  const providedId = \"xcmp_automation_test_\" + (Math.random() + 1).toString(36).substring(7);\n  const xcmpCall =  oakApi.tx.automationTime.scheduleXcmpTask(\n    providedId,\n    { Fixed: { executionTimes: [0] } },\n    MANGATA_PARA_ID,\n    0,\n    encodedMangataProxyCall,\n    mangataProxyCallFees.weight,\n  );\n  console.log('xcmpCall: ', xcmpCall);\n\n  const xcmFrees = await oakHelper.getXcmFees(keyPair.address, xcmpCall);\n  console.log(\"xcmFrees:\", xcmFrees.toHuman());\n\n  // 3. Sign and send scheduleXcmpTask call.\n  // Get TaskId for Task.\n  const taskId = await oakApi.rpc.automationTime.generateTaskId(keyPair.address, providedId);\n  console.log(\"TaskId:\", taskId.toHuman());\n\n  await oakHelper.sendXcmExtrinsic(xcmpCall, keyPair, taskId);\n}\n\nmain().catch(console.error).finally(() => process.exit());\n"],"mappings":"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"}},"mtime":1668661477173},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/oakHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _types = require(\"@imstar15/types\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass OakHelper {\n  initialize = async endpoint => {\n    const api = await _api.ApiPromise.create({\n      provider: new _api.WsProvider(endpoint),\n      rpc: _types.rpc\n    });\n    this.api = api;\n  };\n  getApi = () => this.api;\n  getAccountInfo = async address => {\n    // Retrieve the account balance & nonce via the system module\n    const {\n      data: balance\n    } = await this.api.query.system.account(address);\n    const turBalance = balance.free.div(new _bn.default(DECIMAL.TUR)).toNumber();\n\n    // TODO: figure out how to retrieve balance of other tokens\n    return {\n      TUR: turBalance\n    };\n  };\n  getProxyAddressMangata = address => {\n    const keyring = new _api.Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [{\n          Parachain: MANGATA_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: keyring.decodeAddress(mangataAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const proxyAccount = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  };\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100,\n      // does not except negative?\n      runtimeVersion: this.api.runtimeVersion\n    });\n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  };\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\", dest, message);\n    return new Promise(async resolve => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async resolve => {\n      const unsub = await xcmpCall.signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n\n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n}\n;\nvar _default = new OakHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPQUtfUEFSQV9JRCIsIk1BTkdBVEFfU1M1OCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdYIiwiS1NNIiwiVFVSIiwiT2FrSGVscGVyIiwiaW5pdGlhbGl6ZSIsImVuZHBvaW50IiwiYXBpIiwiQXBpUHJvbWlzZSIsImNyZWF0ZSIsInByb3ZpZGVyIiwiV3NQcm92aWRlciIsInJwYyIsImdldEFwaSIsImdldEFjY291bnRJbmZvIiwiYWRkcmVzcyIsImRhdGEiLCJiYWxhbmNlIiwicXVlcnkiLCJzeXN0ZW0iLCJhY2NvdW50IiwidHVyQmFsYW5jZSIsImZyZWUiLCJkaXYiLCJCTiIsInRvTnVtYmVyIiwiZ2V0UHJveHlBZGRyZXNzTWFuZ2F0YSIsImtleXJpbmciLCJLZXlyaW5nIiwibWFuZ2F0YUFkZHJlc3MiLCJlbmNvZGVBZGRyZXNzIiwibG9jYXRpb24iLCJwYXJlbnRzIiwiaW50ZXJpb3IiLCJYMiIsIlBhcmFjaGFpbiIsIkFjY291bnRJZDMyIiwibmV0d29yayIsImlkIiwiZGVjb2RlQWRkcmVzcyIsIm11bHRpbG9jYXRpb24iLCJjcmVhdGVUeXBlIiwidG9IYXNoIiwiVWludDhBcnJheSIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwidG9VOGEiLCJwcm94eUFjY291bnQiLCJ1OGFUb0hleCIsInJlZ2lzdHJ5IiwiaGFzaCIsInNsaWNlIiwiZ2V0WGNtRmVlcyIsInhjbXBDYWxsIiwiZmFrZVNpZ25lZFhjbXBDYWxsIiwic2lnbkZha2UiLCJibG9ja0hhc2giLCJnZW5lc2lzSGFzaCIsIm5vbmNlIiwicnVudGltZVZlcnNpb24iLCJmZWVzIiwieGNtcEhhbmRsZXIiLCJ0b0hleCIsInhjbVNlbmQiLCJkZXN0IiwibWVzc2FnZSIsImNvbnNvbGUiLCJsb2ciLCJQcm9taXNlIiwicmVzb2x2ZSIsInVuc3ViIiwidHgiLCJwb2xrYWRvdFhjbSIsInNlbmQiLCJzaWduQW5kU2VuZCIsImtleVBhaXIiLCJzdGF0dXMiLCJpc0luQmxvY2siLCJhc0luQmxvY2siLCJ0eXBlIiwic2VuZFhjbUV4dHJpbnNpYyIsInRhc2tJZCIsInRhc2siLCJhdXRvbWF0aW9uVGltZSIsImFjY291bnRUYXNrcyIsInRvSHVtYW4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby94Y21wX2F1dG9tYXRpb24vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbIm9ha0hlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBycGMgfSBmcm9tICdAaW1zdGFyMTUvdHlwZXMnO1xuaW1wb3J0IHsgQXBpUHJvbWlzZSwgV3NQcm92aWRlciwgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyB1OGFUb0hleCB9IGZyb20gXCJAcG9sa2Fkb3QvdXRpbFwiO1xuaW1wb3J0IEJOIGZyb20gJ2JuLmpzJztcblxuY29uc3QgT0FLX1BBUkFfSUQgPSAyMTE0O1xuY29uc3QgTUFOR0FUQV9TUzU4ID0gNDI7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5cbmNvbnN0IERFQ0lNQUwgPSB7XG4gIE1HWDogJzEwMDAwMDAwMDAwMDAwMDAwMDAnLFxuICBLU006ICcxMDAwMDAwMDAwMDAwJyxcbiAgVFVSOiAnMTAwMDAwMDAwMDAnLFxufTtcblxuY2xhc3MgT2FrSGVscGVyIHtcbiAgaW5pdGlhbGl6ZSA9IGFzeW5jIChlbmRwb2ludCkgPT4ge1xuICAgIGNvbnN0IGFwaSA9IGF3YWl0IEFwaVByb21pc2UuY3JlYXRlKHsgcHJvdmlkZXI6IG5ldyBXc1Byb3ZpZGVyKGVuZHBvaW50KSwgcnBjIH0pO1xuXHRcdHRoaXMuYXBpID0gYXBpO1xuICB9XG5cbiAgZ2V0QXBpID0gKCkgPT4gdGhpcy5hcGk7XG5cbiAgZ2V0QWNjb3VudEluZm8gPSBhc3luYyhhZGRyZXNzKT0+e1xuICAgIC8vIFJldHJpZXZlIHRoZSBhY2NvdW50IGJhbGFuY2UgJiBub25jZSB2aWEgdGhlIHN5c3RlbSBtb2R1bGVcbiAgICBjb25zdCB7IGRhdGE6IGJhbGFuY2UgfSA9IGF3YWl0IHRoaXMuYXBpLnF1ZXJ5LnN5c3RlbS5hY2NvdW50KGFkZHJlc3MpO1xuXG4gICAgY29uc3QgdHVyQmFsYW5jZSA9IGJhbGFuY2UuZnJlZS5kaXYobmV3IEJOKERFQ0lNQUwuVFVSKSkudG9OdW1iZXIoKVxuXG4gICAgLy8gVE9ETzogZmlndXJlIG91dCBob3cgdG8gcmV0cmlldmUgYmFsYW5jZSBvZiBvdGhlciB0b2tlbnNcbiAgICByZXR1cm4ge1RVUjogdHVyQmFsYW5jZX07XG4gIH1cblxuICBnZXRQcm94eUFkZHJlc3NNYW5nYXRhID0gKGFkZHJlc3MpID0+IHtcbiAgICBjb25zdCBrZXlyaW5nID0gbmV3IEtleXJpbmcoKTtcbiAgICBjb25zdCBtYW5nYXRhQWRkcmVzcyA9IGtleXJpbmcuZW5jb2RlQWRkcmVzcyhhZGRyZXNzLCBNQU5HQVRBX1NTNTgpO1xuXG4gICAgY29uc3QgbG9jYXRpb24gPSB7XG4gICAgICBwYXJlbnRzOiAxLFxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogTUFOR0FUQV9QQVJBX0lEIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgQWNjb3VudElkMzI6IHtcbiAgICAgICAgICAgICAgbmV0d29yazogXCJBbnlcIixcbiAgICAgICAgICAgICAgaWQ6IGtleXJpbmcuZGVjb2RlQWRkcmVzcyhtYW5nYXRhQWRkcmVzcyksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG11bHRpbG9jYXRpb24gPSB0aGlzLmFwaS5jcmVhdGVUeXBlKFwiWGNtVjFNdWx0aUxvY2F0aW9uXCIsIGxvY2F0aW9uKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBwcm94eUFjY291bnQgPSB1OGFUb0hleCh0aGlzLmFwaS5yZWdpc3RyeS5oYXNoKHRvSGFzaCkuc2xpY2UoMCwgMzIpKTtcbiAgICByZXR1cm4gcHJveHlBY2NvdW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBYQ00gZmVlc1xuICAgKiBGYWtlIHNpZ24gdGhlIGNhbGwgaW4gb3JkZXIgdG8gZ2V0IHRoZSBjb21iaW5lZCBmZWVzIGZyb20gVHVyaW5nLlxuICAgKiBUdXJpbmcgeGNtcEhhbmRsZXJfZmVlcyBSUEMgcmVxdWlyZXMgdGhlIGVuY29kZWQgY2FsbCBpbiB0aGlzIGZvcm1hdC5cbiAgICogRmVlcyByZXR1cm5lZCBpbmNsdWRlIGluY2x1c2lvbiwgYWxsIGV4ZWN1dGlvbnMsIGFuZCBYQ01QIGZlZXMgdG8gcnVuIG9uIFRhcmdldCBDaGFpbi5cbiAgICogQHBhcmFtIHsqfSBhZGRyZXNzIFxuICAgKiBAcGFyYW0geyp9IHhjbXBDYWxsIFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIGdldFhjbUZlZXMgPSBhc3luYyAoYWRkcmVzcywgeGNtcENhbGwpID0+IHtcbiAgICBjb25zdCBmYWtlU2lnbmVkWGNtcENhbGwgPSB4Y21wQ2FsbC5zaWduRmFrZShhZGRyZXNzLCB7XG4gICAgICBibG9ja0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgZ2VuZXNpc0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgbm9uY2U6IDEwMCwgLy8gZG9lcyBub3QgZXhjZXB0IG5lZ2F0aXZlP1xuICAgICAgcnVudGltZVZlcnNpb246IHRoaXMuYXBpLnJ1bnRpbWVWZXJzaW9uLFxuICAgIH0pO1xuICBcbiAgICBjb25zdCBmZWVzID0gYXdhaXQgdGhpcy5hcGkucnBjLnhjbXBIYW5kbGVyLmZlZXMoZmFrZVNpZ25lZFhjbXBDYWxsLnRvSGV4KCkpO1xuICAgIHJldHVybiBmZWVzO1xuICB9XG5cbiAgeGNtU2VuZCA9IGFzeW5jIChkZXN0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJ4Y21TZW5kLFwiLGRlc3QsbWVzc2FnZSk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IHVuc3ViID0gYXdhaXQgdGhpcy5hcGkudHgucG9sa2Fkb3RYY20uc2VuZChkZXN0LCBtZXNzYWdlKS5zaWduQW5kU2VuZChrZXlQYWlyLCB7IG5vbmNlOiAtMSB9LCBhc3luYyAoeyBzdGF0dXMgfSkgPT4ge1xuICAgICAgICBpZiAoc3RhdHVzLmlzSW5CbG9jaykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsIHdpdGggaGFzaCAnICsgc3RhdHVzLmFzSW5CbG9jay50b0hleCgpKTtcbiAgXG4gICAgICAgICAgdW5zdWIoKTtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N0YXR1czogJyArIHN0YXR1cy50eXBlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbiAgc2VuZFhjbUV4dHJpbnNpYyA9IGFzeW5jICh4Y21wQ2FsbCwga2V5UGFpciwgdGFza0lkKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCB1bnN1YiA9IGF3YWl0IHhjbXBDYWxsLnNpZ25BbmRTZW5kKGtleVBhaXIsIHsgbm9uY2U6IC0xIH0sIGFzeW5jICh7IHN0YXR1cyB9KSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXMuaXNJbkJsb2NrKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWwgd2l0aCBoYXNoICcgKyBzdGF0dXMuYXNJbkJsb2NrLnRvSGV4KCkpO1xuICBcbiAgICAgICAgICAvLyBHZXQgVGFza1xuICAgICAgICAgIGNvbnN0IHRhc2sgPSBhd2FpdCB0aGlzLmFwaS5xdWVyeS5hdXRvbWF0aW9uVGltZS5hY2NvdW50VGFza3Moa2V5UGFpci5hZGRyZXNzLCB0YXNrSWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGFzazpcIiwgdGFzay50b0h1bWFuKCkpO1xuICBcbiAgICAgICAgICB1bnN1YigpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU3RhdHVzOiAnICsgc3RhdHVzLnR5cGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbmV3IE9ha0hlbHBlcigpOyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBdUI7QUFFdkIsTUFBTUEsV0FBVyxHQUFHLElBQUk7QUFDeEIsTUFBTUMsWUFBWSxHQUFHLEVBQUU7QUFDdkIsTUFBTUMsZUFBZSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsZUFBZTtBQUVuRCxNQUFNRyxPQUFPLEdBQUc7RUFDZEMsR0FBRyxFQUFFLHFCQUFxQjtFQUMxQkMsR0FBRyxFQUFFLGVBQWU7RUFDcEJDLEdBQUcsRUFBRTtBQUNQLENBQUM7QUFFRCxNQUFNQyxTQUFTLENBQUM7RUFDZEMsVUFBVSxHQUFHLE1BQU9DLFFBQVEsSUFBSztJQUMvQixNQUFNQyxHQUFHLEdBQUcsTUFBTUMsZUFBVSxDQUFDQyxNQUFNLENBQUM7TUFBRUMsUUFBUSxFQUFFLElBQUlDLGVBQVUsQ0FBQ0wsUUFBUSxDQUFDO01BQUVNLEdBQUcsRUFBSEE7SUFBSSxDQUFDLENBQUM7SUFDbEYsSUFBSSxDQUFDTCxHQUFHLEdBQUdBLEdBQUc7RUFDZCxDQUFDO0VBRURNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQ04sR0FBRztFQUV2Qk8sY0FBYyxHQUFHLE1BQU1DLE9BQU8sSUFBRztJQUMvQjtJ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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_SS58","MANGATA_PARA_ID","process","env","DECIMAL","MGX","KSM","TUR","OakHelper","initialize","endpoint","api","ApiPromise","create","provider","WsProvider","rpc","getApi","getAccountInfo","address","data","balance","query","system","account","turBalance","free","div","BN","toNumber","getProxyAddressMangata","keyring","Keyring","mangataAddress","encodeAddress","location","parents","interior","X2","Parachain","AccountId32","network","id","decodeAddress","multilocation","createType","toHash","Uint8Array","TextEncoder","encode","toU8a","proxyAccount","u8aToHex","registry","hash","slice","getXcmFees","xcmpCall","fakeSignedXcmpCall","signFake","blockHash","genesisHash","nonce","runtimeVersion","fees","xcmpHandler","toHex","xcmSend","dest","message","console","log","Promise","resolve","unsub","tx","polkadotXcm","send","signAndSend","keyPair","status","isInBlock","asInBlock","type","sendXcmExtrinsic","taskId","task","automationTime","accountTasks","toHuman"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/","sources":["oakHelper.js"],"sourcesContent":["import { rpc } from '@imstar15/types';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport BN from 'bn.js';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\n\nclass OakHelper {\n  initialize = async (endpoint) => {\n    const api = await ApiPromise.create({ provider: new WsProvider(endpoint), rpc });\n\t\tthis.api = api;\n  }\n\n  getApi = () => this.api;\n\n  getAccountInfo = async(address)=>{\n    // Retrieve the account balance & nonce via the system module\n    const { data: balance } = await this.api.query.system.account(address);\n\n    const turBalance = balance.free.div(new BN(DECIMAL.TUR)).toNumber()\n\n    // TODO: figure out how to retrieve balance of other tokens\n    return {TUR: turBalance};\n  }\n\n  getProxyAddressMangata = (address) => {\n    const keyring = new Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [\n          { Parachain: MANGATA_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: keyring.decodeAddress(mangataAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const proxyAccount = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  }\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100, // does not except negative?\n      runtimeVersion: this.api.runtimeVersion,\n    });\n  \n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  }\n\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\",dest,message);\n\n    return new Promise(async (resolve) => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n}\n\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async (resolve) => {\n      const unsub = await xcmpCall.signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  }\n};\n\nexport default new OakHelper();"],"mappings":"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"}},"mtime":1668757269868},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/mangataHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass MangataHelper {\n  initialize = async mangataEndpoint => {\n    const mangata = _sdk.Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n    this.mangata = mangata;\n    this.api = mangataApi;\n  };\n  getApi = () => this.api;\n  checkFreeBalance = async address => {\n    const tokenBalance = await this.mangata.getTokenBalance('0', address);\n    return tokenBalance.free;\n  };\n  getChainInfo = async account => {\n    // 2. Read chain asssets\n    const assets = await this.mangata.getAssetsInfo();\n    return assets;\n  };\n  getAccountInfo = async address => {\n    const balances = {};\n    balances.MGX = await this.getAssetFreeAmount(0, address, DECIMAL.MGX);\n    balances.KSM = await this.getAssetFreeAmount(4, address, DECIMAL.KSM);\n    balances.TUR = await this.getAssetFreeAmount(7, address, DECIMAL.TUR);\n    // balances['KSM-MGX'] = await this.mangata.getTokenBalance('5', account.address);\n    return balances;\n  };\n  getAssetFreeAmount = async (assetId, address, digits) => {\n    const asset = await this.mangata.getTokenBalance(assetId.toString(), address);\n    return asset.free.div(new _bn.default(digits)).toNumber();\n  };\n  getProxyAccount = address => {\n    const decodedAddress = (0, _utilCrypto.decodeAddress)(address);\n    const decondedAddressHex = (0, _util.u8aToHex)(decodedAddress); // a SS58 public key\n    console.log(\"decondedAddressHex\", decondedAddressHex);\n    const location = {\n      parents: 1,\n      // From Turing to Mangata\n      interior: {\n        X2: [{\n          Parachain: TURING_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: (0, _util.u8aToHex)(decodedAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    console.log(\"multilocation\", multilocation.toString());\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const DescendOriginAddress32 = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return DescendOriginAddress32;\n  };\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n  createPool = async account => {\n    return new Promise(async resolve => {\n      await this.mangata.createPool(account, '0', new _bn.default('1000000000000000000000'),\n      // 1000 MGX (MGX is 18 decimals)\n      '4', new _bn.default('1000000000000'),\n      // 1 TUR (TUR is 12 decimals)\n      {\n        statusCallback: result => {\n          // result is of the form ISubmittableResult\n          console.log(result);\n        },\n        extrinsicStatus: result => {\n          // result is of the form MangataGenericEvent[]\n          for (let index = 0; index < result.length; index++) {\n            console.log('Phase', result[index].phase.toString());\n            console.log('Section', result[index].section);\n            console.log('Method', result[index].method);\n            console.log('Documentation', result[index].metaDocumentation);\n          }\n        }\n      });\n    });\n  };\n  getPools = async () => {\n    return this.mangata.getPools();\n  };\n}\n;\nvar _default = new MangataHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPQUtfUEFSQV9JRCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdYIiwiS1NNIiwiVFVSIiwiTWFuZ2F0YUhlbHBlciIsImluaXRpYWxpemUiLCJtYW5nYXRhRW5kcG9pbnQiLCJtYW5nYXRhIiwiTWFuZ2F0YSIsImdldEluc3RhbmNlIiwibWFuZ2F0YUFwaSIsImdldEFwaSIsImFwaSIsImNoZWNrRnJlZUJhbGFuY2UiLCJhZGRyZXNzIiwidG9rZW5CYWxhbmNlIiwiZ2V0VG9rZW5CYWxhbmNlIiwiZnJlZSIsImdldENoYWluSW5mbyIsImFjY291bnQiLCJhc3NldHMiLCJnZXRBc3NldHNJbmZvIiwiZ2V0QWNjb3VudEluZm8iLCJiYWxhbmNlcyIsImdldEFzc2V0RnJlZUFtb3VudCIsImFzc2V0SWQiLCJkaWdpdHMiLCJhc3NldCIsInRvU3RyaW5nIiwiZGl2IiwiQk4iLCJ0b051bWJlciIsImdldFByb3h5QWNjb3VudCIsImRlY29kZWRBZGRyZXNzIiwiZGVjb2RlQWRkcmVzcyIsImRlY29uZGVkQWRkcmVzc0hleCIsInU4YVRvSGV4IiwiY29uc29sZSIsImxvZyIsImxvY2F0aW9uIiwicGFyZW50cyIsImludGVyaW9yIiwiWDIiLCJQYXJhY2hhaW4iLCJBY2NvdW50SWQzMiIsIm5ldHdvcmsiLCJpZCIsIm11bHRpbG9jYXRpb24iLCJjcmVhdGVUeXBlIiwidG9IYXNoIiwiVWludDhBcnJheSIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwidG9VOGEiLCJEZXNjZW5kT3JpZ2luQWRkcmVzczMyIiwicmVnaXN0cnkiLCJoYXNoIiwic2xpY2UiLCJhZGRQcm94eSIsInByb3h5QWNjb3VudCIsImtleVBhaXIiLCJ0eCIsInByb3h5Iiwic2lnbkFuZFNlbmQiLCJjcmVhdGVQcm94eUNhbGwiLCJleHRyaW5zaWMiLCJjcmVhdGVQb29sIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzdGF0dXNDYWxsYmFjayIsInJlc3VsdCIsImV4dHJpbnNpY1N0YXR1cyIsImluZGV4IiwibGVuZ3RoIiwicGhhc2UiLCJzZWN0aW9uIiwibWV0aG9kIiwibWV0YURvY3VtZW50YXRpb24iLCJnZXRQb29scyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL21pa2FzYS9Db2RlL3hjbS1kZW1vL3hjbXBfYXV0b21hdGlvbi9zcmMvY29tbW9uLyIsInNvdXJjZXMiOlsibWFuZ2F0YUhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYW5nYXRhIH0gZnJvbSAnQG1hbmdhdGEtZmluYW5jZS9zZGsnO1xuaW1wb3J0IHsgQXBpUHJvbWlzZSwgV3NQcm92aWRlciwgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyB1OGFUb0hleCB9IGZyb20gXCJAcG9sa2Fkb3QvdXRpbFwiO1xuaW1wb3J0IHsgZGVjb2RlQWRkcmVzcyB9IGZyb20gJ0Bwb2xrYWRvdC91dGlsLWNyeXB0byc7XG5pbXBvcnQgQk4gZnJvbSAnYm4uanMnO1xuXG5jb25zdCBPQUtfUEFSQV9JRCA9IDIxMTQ7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5cbmNvbnN0IERFQ0lNQUwgPSB7XG4gIE1HWDogJzEwMDAwMDAwMDAwMDAwMDAwMDAnLFxuICBLU006ICcxMDAwMDAwMDAwMDAwJyxcbiAgVFVSOiAnMTAwMDAwMDAwMDAnLFxufTtcbmNsYXNzIE1hbmdhdGFIZWxwZXIge1xuICBpbml0aWFsaXplID0gYXN5bmMgKG1hbmdhdGFFbmRwb2ludCkgPT4ge1xuICAgIGNvbnN0IG1hbmdhdGEgPSBNYW5nYXRhLmdldEluc3RhbmNlKFttYW5nYXRhRW5kcG9pbnRdKTtcbiAgICBjb25zdCBtYW5nYXRhQXBpID0gYXdhaXQgbWFuZ2F0YS5nZXRBcGkoKTtcblxuICAgIHRoaXMubWFuZ2F0YSA9IG1hbmdhdGE7XG4gICAgdGhpcy5hcGkgPSBtYW5nYXRhQXBpO1xuICB9XG5cbiAgZ2V0QXBpID0gKCkgPT4gdGhpcy5hcGk7XG5cbiAgY2hlY2tGcmVlQmFsYW5jZSA9IGFzeW5jIChhZGRyZXNzKSA9PiB7XG4gICAgY29uc3QgdG9rZW5CYWxhbmNlID0gYXdhaXQgdGhpcy5tYW5nYXRhLmdldFRva2VuQmFsYW5jZSgnMCcsIGFkZHJlc3MpO1xuICAgIHJldHVybiB0b2tlbkJhbGFuY2UuZnJlZTtcbiAgfVxuXG4gIGdldENoYWluSW5mbyA9IGFzeW5jIChhY2NvdW50KSA9PiB7XG4gICAgICAgIC8vIDIuIFJlYWQgY2hhaW4gYXNzc2V0c1xuICAgIGNvbnN0IGFzc2V0cyA9IGF3YWl0IHRoaXMubWFuZ2F0YS5nZXRBc3NldHNJbmZvKCk7XG4gICAgcmV0dXJuIGFzc2V0cztcbiAgfVxuXG4gIGdldEFjY291bnRJbmZvID0gYXN5bmMgKGFkZHJlc3MpID0+IHtcbiAgICBjb25zdCBiYWxhbmNlcyA9IHt9O1xuICAgIGJhbGFuY2VzLk1HWCA9IGF3YWl0IHRoaXMuZ2V0QXNzZXRGcmVlQW1vdW50KDAsIGFkZHJlc3MsIERFQ0lNQUwuTUdYKTtcbiAgICBiYWxhbmNlcy5LU00gPSBhd2FpdCB0aGlzLmdldEFzc2V0RnJlZUFtb3VudCg0LCBhZGRyZXNzLCBERUNJTUFMLktTTSk7XG4gICAgYmFsYW5jZXMuVFVSID0gYXdhaXQgdGhpcy5nZXRBc3NldEZyZWVBbW91bnQoNywgYWRkcmVzcywgREVDSU1BTC5UVVIpO1xuICAgIC8vIGJhbGFuY2VzWydLU00tTUdYJ10gPSBhd2FpdCB0aGlzLm1hbmdhdGEuZ2V0VG9rZW5CYWxhbmNlKCc1JywgYWNjb3VudC5hZGRyZXNzKTtcbiAgICByZXR1cm4gYmFsYW5jZXM7XG4gIH1cblxuICBnZXRBc3NldEZyZWVBbW91bnQgPSBhc3luYyAoYXNzZXRJZCwgYWRkcmVzcywgZGlnaXRzICk9PntcbiAgICBjb25zdCBhc3NldCA9IGF3YWl0IHRoaXMubWFuZ2F0YS5nZXRUb2tlbkJhbGFuY2UoYXNzZXRJZC50b1N0cmluZygpLCBhZGRyZXNzKTtcbiAgICByZXR1cm4gYXNzZXQuZnJlZS5kaXYobmV3IEJOKGRpZ2l0cykpLnRvTnVtYmVyKCk7XG4gIH0gXG5cbiAgZ2V0UHJveHlBY2NvdW50ID0gKGFkZHJlc3MpID0+IHtcbiAgICBjb25zdCBkZWNvZGVkQWRkcmVzcyA9IGRlY29kZUFkZHJlc3MoYWRkcmVzcyk7XG4gICAgY29uc3QgZGVjb25kZWRBZGRyZXNzSGV4ID0gdThhVG9IZXgoZGVjb2RlZEFkZHJlc3MpOyAvLyBhIFNTNTggcHVibGljIGtleVxuICAgIGNvbnNvbGUubG9nKFwiZGVjb25kZWRBZGRyZXNzSGV4XCIsIGRlY29uZGVkQWRkcmVzc0hleCk7XG4gICAgXG4gICAgY29uc3QgbG9jYXRpb24gPSB7XG4gICAgICBwYXJlbnRzOiAxLCAvLyBGcm9tIFR1cmluZyB0byBNYW5nYXRhXG4gICAgICBpbnRlcmlvcjoge1xuICAgICAgICBYMjogW1xuICAgICAgICAgIHsgUGFyYWNoYWluOiBPQUtfUEFSQV9JRCB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIEFjY291bnRJZDMyOiB7XG4gICAgICAgICAgICAgIG5ldHdvcms6IFwiQW55XCIsXG4gICAgICAgICAgICAgIGlkOiB1OGFUb0hleChkZWNvZGVkQWRkcmVzcyksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG11bHRpbG9jYXRpb24gPSB0aGlzLmFwaS5jcmVhdGVUeXBlKFwiWGNtVjFNdWx0aUxvY2F0aW9uXCIsIGxvY2F0aW9uKTtcblxuICAgIGNvbnNvbGUubG9nKFwibXVsdGlsb2NhdGlvblwiLCBtdWx0aWxvY2F0aW9uLnRvU3RyaW5nKCkpO1xuXG4gICAgY29uc3QgdG9IYXNoID0gbmV3IFVpbnQ4QXJyYXkoW1xuICAgICAgLi4ubmV3IFVpbnQ4QXJyYXkoWzMyXSksXG4gICAgICAuLi5uZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoXCJtdWx0aWxvY1wiKSxcbiAgICAgIC4uLm11bHRpbG9jYXRpb24udG9VOGEoKSxcbiAgICBdKTtcblxuICAgIGNvbnN0IERlc2NlbmRPcmlnaW5BZGRyZXNzMzIgPSB1OGFUb0hleCh0aGlzLmFwaS5yZWdpc3RyeS5oYXNoKHRvSGFzaCkuc2xpY2UoMCwgMzIpKTtcblxuICAgIHJldHVybiBEZXNjZW5kT3JpZ2luQWRkcmVzczMyO1xuICB9XG5cbiAgYWRkUHJveHkgPSBhc3luYyAocHJveHlBY2NvdW50LCBrZXlQYWlyKSA9PiB0aGlzLmFwaS50eC5wcm94eS5hZGRQcm94eShwcm94eUFjY291bnQsIFwiQW55XCIsIDApLnNpZ25BbmRTZW5kKGtleVBhaXIpO1xuXG4gIGNyZWF0ZVByb3h5Q2FsbCA9IGFzeW5jIChhZGRyZXNzLCBleHRyaW5zaWMpID0+IHRoaXMuYXBpLnR4LnByb3h5LnByb3h5KGFkZHJlc3MsICdBbnknLCBleHRyaW5zaWMpO1xuXG4gIGNyZWF0ZVBvb2wgPSBhc3luYyAoYWNjb3VudCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5tYW5nYXRhLmNyZWF0ZVBvb2woXG4gICAgICAgIGFjY291bnQsXG4gICAgICAgICcwJyxcbiAgICAgICAgbmV3IEJOKCcxMDAwMDAwMDAwMDAwMDAwMDAwMDAwJyksIC8vIDEwMDAgTUdYIChNR1ggaXMgMTggZGVjaW1hbHMpXG4gICAgICAgICc0JyxcbiAgICAgICAgbmV3IEJOKCcxMDAwMDAwMDAwMDAwJyksIC8vIDEgVFVSIChUVVIgaXMgMTIgZGVjaW1hbHMpXG4gICAgICAgIHtcbiAgICAgICAgICBzdGF0dXNDYWxsYmFjazogKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgLy8gcmVzdWx0IGlzIG9mIHRoZSBmb3JtIElTdWJtaXR0YWJsZVJlc3VsdFxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGV4dHJpbnNpY1N0YXR1czogKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgLy8gcmVzdWx0IGlzIG9mIHRoZSBmb3JtIE1hbmdhdGFHZW5lcmljRXZlbnRbXVxuICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHJlc3VsdC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQaGFzZScsIHJlc3VsdFtpbmRleF0ucGhhc2UudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTZWN0aW9uJywgcmVzdWx0W2luZGV4XS5zZWN0aW9uKVxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01ldGhvZCcsIHJlc3VsdFtpbmRleF0ubWV0aG9kKVxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RvY3VtZW50YXRpb24nLCByZXN1bHRbaW5kZXhdLm1ldGFEb2N1bWVudGF0aW9uKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG4gIH1cblxuICBnZXRQb29scyA9IGFzeW5jKCkgPT57XG4gICAgcmV0dXJuIHRoaXMubWFuZ2F0YS5nZXRQb29scygpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBuZXcgTWFuZ2F0YUhlbHBlcigpOyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUF1QjtBQUV2QixNQUFNQSxXQUFXLEdBQUcsSUFBSTtBQUN4QixNQUFNQyxlQUFlLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixlQUFlO0FBRW5ELE1BQU1HLE9BQU8sR0FBRztFQUNkQyxHQUFHLEVBQUUscUJBQXFCO0VBQzFCQyxHQUFHLEVBQUUsZUFBZTtFQUNwQkMsR0FBRyxFQUFFO0FBQ1AsQ0FBQztBQUNELE1BQU1DLGFBQWEsQ0FBQztFQUNsQkMsVUFBVSxHQUFHLE1BQU9DLGVBQWUsSUFBSztJQUN0QyxNQUFNQyxPQUFPLEdBQUdDLFlBQU8sQ0FBQ0MsV0FBVyxDQUFDLENBQUNILGVBQWUs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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_PARA_ID","process","env","DECIMAL","MGX","KSM","TUR","MangataHelper","initialize","mangataEndpoint","mangata","Mangata","getInstance","mangataApi","getApi","api","checkFreeBalance","address","tokenBalance","getTokenBalance","free","getChainInfo","account","assets","getAssetsInfo","getAccountInfo","balances","getAssetFreeAmount","assetId","digits","asset","toString","div","BN","toNumber","getProxyAccount","decodedAddress","decodeAddress","decondedAddressHex","u8aToHex","console","log","location","parents","interior","X2","Parachain","AccountId32","network","id","multilocation","createType","toHash","Uint8Array","TextEncoder","encode","toU8a","DescendOriginAddress32","registry","hash","slice","addProxy","proxyAccount","keyPair","tx","proxy","signAndSend","createProxyCall","extrinsic","createPool","Promise","resolve","statusCallback","result","extrinsicStatus","index","length","phase","section","method","metaDocumentation","getPools"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/","sources":["mangataHelper.js"],"sourcesContent":["import { Mangata } from '@mangata-finance/sdk';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { decodeAddress } from '@polkadot/util-crypto';\nimport BN from 'bn.js';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\nclass MangataHelper {\n  initialize = async (mangataEndpoint) => {\n    const mangata = Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n\n    this.mangata = mangata;\n    this.api = mangataApi;\n  }\n\n  getApi = () => this.api;\n\n  checkFreeBalance = async (address) => {\n    const tokenBalance = await this.mangata.getTokenBalance('0', address);\n    return tokenBalance.free;\n  }\n\n  getChainInfo = async (account) => {\n        // 2. Read chain asssets\n    const assets = await this.mangata.getAssetsInfo();\n    return assets;\n  }\n\n  getAccountInfo = async (address) => {\n    const balances = {};\n    balances.MGX = await this.getAssetFreeAmount(0, address, DECIMAL.MGX);\n    balances.KSM = await this.getAssetFreeAmount(4, address, DECIMAL.KSM);\n    balances.TUR = await this.getAssetFreeAmount(7, address, DECIMAL.TUR);\n    // balances['KSM-MGX'] = await this.mangata.getTokenBalance('5', account.address);\n    return balances;\n  }\n\n  getAssetFreeAmount = async (assetId, address, digits )=>{\n    const asset = await this.mangata.getTokenBalance(assetId.toString(), address);\n    return asset.free.div(new BN(digits)).toNumber();\n  } \n\n  getProxyAccount = (address) => {\n    const decodedAddress = decodeAddress(address);\n    const decondedAddressHex = u8aToHex(decodedAddress); // a SS58 public key\n    console.log(\"decondedAddressHex\", decondedAddressHex);\n    \n    const location = {\n      parents: 1, // From Turing to Mangata\n      interior: {\n        X2: [\n          { Parachain: TURING_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: u8aToHex(decodedAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    console.log(\"multilocation\", multilocation.toString());\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const DescendOriginAddress32 = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n\n    return DescendOriginAddress32;\n  }\n\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n\n  createPool = async (account) => {\n    return new Promise(async (resolve) => {\n      await this.mangata.createPool(\n        account,\n        '0',\n        new BN('1000000000000000000000'), // 1000 MGX (MGX is 18 decimals)\n        '4',\n        new BN('1000000000000'), // 1 TUR (TUR is 12 decimals)\n        {\n          statusCallback: (result) => {\n            // result is of the form ISubmittableResult\n            console.log(result);\n          },\n          extrinsicStatus: (result) => {\n            // result is of the form MangataGenericEvent[]\n            for (let index = 0; index < result.length; index++) {\n                  console.log('Phase', result[index].phase.toString())\n                  console.log('Section', result[index].section)\n                  console.log('Method', result[index].method)\n                  console.log('Documentation', result[index].metaDocumentation)\n            }\n          },\n        }\n      );\n    });\n  }\n\n  getPools = async() =>{\n    return this.mangata.getPools();\n  }\n};\n\nexport default new MangataHelper();"],"mappings":"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"}},"mtime":1668817450730},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/xcm.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nrequire(\"@imstar15/api-augment\");\nvar _api = require(\"@polkadot/api\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _oakHelper = _interopRequireDefault(require(\"./common/oakHelper\"));\nvar _mangataHelper = _interopRequireDefault(require(\"./common/mangataHelper\"));\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _utils = require(\"./common/utils\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst SUBSTRATE_SS58 = 42;\nconst TURING_SS58 = 51;\nconst MANGATA_SS58 = 42;\nconst TURING_PARA_ID = process.env.TURING_PARA_ID;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst TURING_ENDPOINT = process.env.TURING_ENDPOINT;\nconst MANGATA_ENDPOINT = process.env.MANGATA_ENDPOINT;\nconst mgxCurrencyId = 0;\nconst turCurrencyId = 7;\n\n// const OAK_SOV_ACCOUNT = \"68kxzikS2WZNkYSPWdYouqH5sEZujecVCy3TFt9xHWB5MDG5\";\nconst keyring = new _api.Keyring();\nasync function main() {\n  await (0, _utilCrypto.cryptoWaitReady)();\n\n  // Initialize\n  await _oakHelper.default.initialize(TURING_ENDPOINT);\n  await _mangataHelper.default.initialize(MANGATA_ENDPOINT);\n  const oakApi = _oakHelper.default.getApi();\n  const account = keyring.addFromUri('//Alice', undefined, 'sr25519');\n  const {\n    address\n  } = account;\n  const rococoAddress = keyring.encodeAddress(address, SUBSTRATE_SS58);\n  const turingAddress = keyring.encodeAddress(address, TURING_SS58);\n  const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n  const mangataAccountInfo = await _mangataHelper.default.getAccountInfo(mangataAddress);\n  const turingAccountInfo = await _oakHelper.default.getAccountInfo(turingAddress);\n  console.log(\"Rococo address: \", rococoAddress);\n  console.log(\"Turing address: \", turingAddress, turingAccountInfo);\n  console.log(\"Mangata address: \", mangataAddress, mangataAccountInfo);\n  const DescendOriginAddress32 = _mangataHelper.default.getProxyAccount(mangataAddress);\n  console.log('32 byte address is %s', DescendOriginAddress32);\n\n  // console.log(\"mangata account from turing:\", keyring.encodeAddress(turingAddress MANGATA_SS58));\n  //   console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n  // Create pool\n\n  const mgxAddress = keyring.encodeAddress(\"0xec00ad0ec6eeb271a9689888f644d9262016a26a25314ff4ff5d756404c44112\", MANGATA_SS58);\n  console.log(\"mgxAddress\", mgxAddress);\n\n  // console.log('Minting TUR tokens with sudo permission ...');\n  // const mintTokenExtrinsic = mangataHelper.getApi().tx.tokens.mint(turCurrencyId, address, 5000000000000000);\n  // await sendExtrinsic(mangataHelper.getApi(), mintTokenExtrinsic, account, { isSudo: true });\n\n  // console.log('Minting KSM tokens with sudo permission ...');\n  // const mintTokenExtrinsic = mangataHelper.getApi().tx.tokens.mint(4, address, 5000000000000000);\n  // await sendExtrinsic(mangataHelper.getApi(), mintTokenExtrinsic, account, { isSudo: true });\n\n  // console.log('Creating a TUR-MGX pool with ${} ${} and ${} ${}...');\n  // await mangataHelper.createPool(account);\n\n  // console.log('Creating a KSM-MGX pool with ${} ${} and ${} ${}...');\n  // await mangataHelper.createPool(account);\n\n  const pools = await _mangataHelper.default.getPools();\n  console.log('Pools: ', pools);\n\n  // const chainInfo = await mangataHelper.getChainInfo();\n  // console.log(\"chainInfo\",chainInfo);\n\n  // '8': {\n  //     id: '8',\n  //     chainId: 0,\n  //     decimals: 18,\n  //     name: 'Liquidity Pool Token',\n  //     symbol: 'MGR-TUR',\n  //     address: ''\n  //   }\n  console.log(\"Bob is trying to add liquidity to the MGX-TUR pool\");\n  const bob = keyring.addFromUri('//Bob', undefined, 'sr25519');\n  const {\n    addressBob\n  } = bob;\n  await printAccountInfo(bob);\n\n  //   const proxyAccount = mangataHelper.getProxyAddressMangata(keyPair.address);\n  //   console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n  //   mangataHelper.addProxy(proxyAccount, keyPair);\n  //   console.log('Add proxy on mangata successfully!');\n\n  const message = \"empty\";\n  //   await oakHelper.xcmSend(dest, message);\n}\n\nasync function printAccountInfo(account) {\n  const {\n    address\n  } = account;\n  const rococoAddress = keyring.encodeAddress(address, SUBSTRATE_SS58);\n  const turingAddress = keyring.encodeAddress(address, TURING_SS58);\n  const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n  const mangataAccountInfo = await _mangataHelper.default.getAccountInfo(mangataAddress);\n  const turingAccountInfo = await _oakHelper.default.getAccountInfo(turingAddress);\n  console.log(\"Rococo address: \", rococoAddress);\n  console.log(\"Turing address: \", turingAddress, turingAccountInfo);\n  console.log(\"Mangata address: \", mangataAddress, mangataAccountInfo);\n}\nmain().catch(console.error).finally(() => process.exit());\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTVUJTVFJBVEVfU1M1OCIsIlRVUklOR19TUzU4IiwiTUFOR0FUQV9TUzU4IiwiT0FLX1BBUkFfSUQiLCJwcm9jZXNzIiwiZW52IiwiTUFOR0FUQV9QQVJBX0lEIiwiT0FLX0VORFBPSU5UIiwiVEFSR0VUX0VORFBPSU5UIiwibWd4Q3VycmVuY3lJZCIsInR1ckN1cnJlbmN5SWQiLCJrZXlyaW5nIiwiS2V5cmluZyIsIm1haW4iLCJjcnlwdG9XYWl0UmVhZHkiLCJvYWtIZWxwZXIiLCJpbml0aWFsaXplIiwibWFuZ2F0YUhlbHBlciIsIm9ha0FwaSIsImdldEFwaSIsImFjY291bnQiLCJhZGRGcm9tVXJpIiwidW5kZWZpbmVkIiwiYWRkcmVzcyIsInJvY29jb0FkZHJlc3MiLCJlbmNvZGVBZGRyZXNzIiwidHVyaW5nQWRkcmVzcyIsIm1hbmdhdGFBZGRyZXNzIiwibWFuZ2F0YUFjY291bnRJbmZvIiwiZ2V0QWNjb3VudEluZm8iLCJ0dXJpbmdBY2NvdW50SW5mbyIsImNvbnNvbGUiLCJsb2ciLCJEZXNjZW5kT3JpZ2luQWRkcmVzczMyIiwiZ2V0UHJveHlBY2NvdW50IiwibWd4QWRkcmVzcyIsInBvb2xzIiwiZ2V0UG9vbHMiLCJib2IiLCJhZGRyZXNzQm9iIiwicHJpbnRBY2NvdW50SW5mbyIsIm1lc3NhZ2UiLCJjYXRjaCIsImVycm9yIiwiZmluYWxseSIsImV4aXQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby94Y21wX2F1dG9tYXRpb24vc3JjLyIsInNvdXJjZXMiOlsieGNtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcIkBpbXN0YXIxNS9hcGktYXVnbWVudFwiO1xuaW1wb3J0IHsgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyBjcnlwdG9XYWl0UmVhZHkgfSBmcm9tICdAcG9sa2Fkb3QvdXRpbC1jcnlwdG8nO1xuaW1wb3J0IG9ha0hlbHBlciBmcm9tIFwiLi9jb21tb24vb2FrSGVscGVyXCI7XG5pbXBvcnQgbWFuZ2F0YUhlbHBlciBmcm9tIFwiLi9jb21tb24vbWFuZ2F0YUhlbHBlclwiO1xuaW1wb3J0IEJOIGZyb20gJ2JuLmpzJztcbmltcG9ydCB7IE1hbmdhdGEgfSBmcm9tIFwiQG1hbmdhdGEtZmluYW5jZS9zZGtcIjtcbmltcG9ydCB7IHNlbmRFeHRyaW5zaWMgfSBmcm9tIFwiLi9jb21tb24vdXRpbHNcIjtcblxuY29uc3QgU1VCU1RSQVRFX1NTNTggPSA0MjtcbmNvbnN0IFRVUklOR19TUzU4ID0gNTE7XG5jb25zdCBNQU5HQVRBX1NTNTggPSA0MjtcbmNvbnN0IE9BS19QQVJBX0lEID0gcHJvY2Vzcy5lbnYuT0FLX1BBUkFfSUQ7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5jb25zdCBPQUtfRU5EUE9JTlQgPSBwcm9jZXNzLmVudi5PQUtfRU5EUE9JTlQ7XG5jb25zdCBUQVJHRVRfRU5EUE9JTlQgPSBwcm9jZXNzLmVudi5UQVJHRVRfRU5EUE9JTlQ7XG5cbmNvbnN0IG1neEN1cnJlbmN5SWQgPSAwO1xuY29uc3QgdHVyQ3VycmVuY3lJZCA9IDc7XG5cbi8vIGNvbnN0IE9BS19TT1ZfQUNDT1VOVCA9IFwiNjhreHppa1MyV1pOa1lTUFdkWW91cUg1c0VadWplY1ZDeTNURnQ5eEhXQjVNREc1XCI7XG5jb25zdCBrZXlyaW5nID0gbmV3IEtleXJpbmcoKTtcblxuYXN5bmMgZnVuY3Rpb24gbWFpbiAoKSB7XG4gIGF3YWl0IGNyeXB0b1dhaXRSZWFkeSgpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZVxuICAgIGF3YWl0IG9ha0hlbHBlci5pbml0aWFsaXplKE9BS19FTkRQT0lOVCk7XG4gICAgYXdhaXQgbWFuZ2F0YUhlbHBlci5pbml0aWFsaXplKFRBUkdFVF9FTkRQT0lOVCk7XG4gICAgY29uc3Qgb2FrQXBpID0gb2FrSGVscGVyLmdldEFwaSgpO1xuXG4gIGNvbnN0IGFjY291bnQgPSBrZXlyaW5nLmFkZEZyb21VcmkoJy8vQWxpY2UnLCB1bmRlZmluZWQsICdzcjI1NTE5Jyk7XG4gIGNvbnN0IHthZGRyZXNzfSA9IGFjY291bnQ7XG4gIGNvbnN0IHJvY29jb0FkZHJlc3MgPSBrZXlyaW5nLmVuY29kZUFkZHJlc3MoYWRkcmVzcywgU1VCU1RSQVRFX1NTNTgpO1xuICBjb25zdCB0dXJpbmdBZGRyZXNzID0ga2V5cmluZy5lbmNvZGVBZGRyZXNzKGFkZHJlc3MsIFRVUklOR19TUzU4KTtcbiAgY29uc3QgbWFuZ2F0YUFkZHJlc3MgPSBrZXlyaW5nLmVuY29kZUFkZHJlc3MoYWRkcmVzcywgTUFOR0FUQV9TUzU4KTtcbiAgY29uc3QgbWFuZ2F0YUFjY291bnRJbmZvID0gYXdhaXQgbWFuZ2F0YUhlbHBlci5nZXRBY2NvdW50SW5mbyhtYW5nYXRhQWRkcmVzcyk7XG4gIGNvbnN0IHR1cmluZ0FjY291bnRJbmZvID0gYXdhaXQgb2FrSGVscGVyLmdldEFjY291bnRJbmZvKHR1cmluZ0FkZHJlc3MpO1xuICBjb25zb2xlLmxvZyhcIlJvY29jbyBhZGRyZXNzOiBcIiwgcm9jb2NvQWRkcmVzcyk7XG4gIGNvbnNvbGUubG9nKFwiVHVyaW5nIGFkZHJlc3M6IFwiLCB0dXJpbmdBZGRyZXNzLCB0dXJpbmdBY2NvdW50SW5mbyk7XG4gIGNvbnNvbGUubG9nKFwiTWFuZ2F0YSBhZGRyZXNzOiBcIiwgbWFuZ2F0YUFkZHJlc3MsIG1hbmdhdGFBY2NvdW50SW5mbyk7XG5cbiAgY29uc3QgRGVzY2VuZE9yaWdpbkFkZHJlc3MzMiA9IG1hbmdhdGFIZWxwZXIuZ2V0UHJveHlBY2NvdW50KG1hbmdhdGFBZGRyZXNzKTtcbiAgY29uc29sZS5sb2coJzMyIGJ5dGUgYWRkcmVzcyBpcyAlcycsIERlc2NlbmRPcmlnaW5BZGRyZXNzMzIpO1xuXG4gICAgLy8gY29uc29sZS5sb2coXCJtYW5nYXRhIGFjY291bnQgZnJvbSB0dXJpbmc6XCIsIGtleXJpbmcuZW5jb2RlQWRkcmVzcyh0dXJpbmdBZGRyZXNzIE1BTkdBVEFfU1M1OCkpO1xuICAvLyAgIGNvbnNvbGUubG9nKFwicHJveHkgYWNjb3VudDpcIiwga2V5cmluZy5lbmNvZGVBZGRyZXNzKHByb3h5QWNjb3VudCwgU1VCU1RSQVRFX1NTNTgpKTtcblxuICAvLyBDcmVhdGUgcG9vbFxuXG4gICAgY29uc3QgbWd4QWRkcmVzcyA9IGtleXJpbmcuZW5jb2RlQWRkcmVzcyhcIjB4ZWMwMGFkMGVjNmVlYjI3MWE5Njg5ODg4ZjY0NGQ5MjYyMDE2YTI2YTI1MzE0ZmY0ZmY1ZDc1NjQwNGM0NDExMlwiLCBNQU5HQVRBX1NTNTgpO1xuICAgIGNvbnNvbGUubG9nKFwibWd4QWRkcmVzc1wiLCBtZ3hBZGRyZXNzKTtcbiAgICAgICAgXG4gICAgLy8gY29uc29sZS5sb2coJ01pbnRpbmcgVFVSIHRva2VucyB3aXRoIHN1ZG8gcGVybWlzc2lvbiAuLi4nKTtcbiAgICAvLyBjb25zdCBtaW50VG9rZW5FeHRyaW5zaWMgPSBtYW5nYXRhSGVscGVyLmdldEFwaSgpLnR4LnRva2Vucy5taW50KHR1ckN1cnJlbmN5SWQsIGFkZHJlc3MsIDUwMDAwMDAwMDAwMDAwMDApO1xuICAgIC8vIGF3YWl0IHNlbmRFeHRyaW5zaWMobWFuZ2F0YUhlbHBlci5nZXRBcGkoKSwgbWludFRva2VuRXh0cmluc2ljLCBhY2NvdW50LCB7IGlzU3VkbzogdHJ1ZSB9KTtcblxuICAgIC8vIGNvbnNvbGUubG9nKCdNaW50aW5nIEtTTSB0b2tlbnMgd2l0aCBzdWRvIHBlcm1pc3Npb24gLi4uJyk7XG4gICAgLy8gY29uc3QgbWludFRva2VuRXh0cmluc2ljID0gbWFuZ2F0YUhlbHBlci5nZXRBcGkoKS50eC50b2tlbnMubWludCg0LCBhZGRyZXNzLCA1MDAwMDAwMDAwMDAwMDAwKTtcbiAgICAvLyBhd2FpdCBzZW5kRXh0cmluc2ljKG1hbmdhdGFIZWxwZXIuZ2V0QXBpKCksIG1pbnRUb2tlbkV4dHJpbnNpYywgYWNjb3VudCwgeyBpc1N1ZG86IHRydWUgfSk7XG5cblx0Ly8gY29uc29sZS5sb2coJ0NyZWF0aW5nIGEgVFVSLU1HWCBwb29sIHdpdGggJHt9ICR7fSBhbmQgJHt9ICR7fS4uLicpO1xuICAgIC8vIGF3YWl0IG1hbmdhdGFIZWxwZXIuY3JlYXRlUG9vbChhY2NvdW50KTtcblxuICAgIC8vIGNvbnNvbGUubG9nKCdDcmVhdGluZyBhIEtTTS1NR1ggcG9vbCB3aXRoICR7fSAke30gYW5kICR7fSAke30uLi4nKTtcbiAgICAvLyBhd2FpdCBtYW5nYXRhSGVscGVyLmNyZWF0ZVBvb2woYWNjb3VudCk7XG4gICBcblx0Y29uc3QgcG9vbHMgPSBhd2FpdCBtYW5nYXRhSGVscGVyLmdldFBvb2xzKCk7XG5cdGNvbnNvbGUubG9nKCdQb29sczogJywgcG9vbHMpO1xuXG4gICAgLy8gY29uc3QgY2hhaW5JbmZvID0gYXdhaXQgbWFuZ2F0YUhlbHBlci5nZXRDaGFpbkluZm8oKTtcbiAgICAvLyBjb25zb2xlLmxvZyhcImNoYWluSW5mb1wiLGNoYWluSW5mbyk7XG5cbiAgICAvLyAnOCc6IHtcbiAgICAvLyAgICAgaWQ6ICc4JyxcbiAgICAvLyAgICAgY2hhaW5JZDogMCxcbiAgICAvLyAgICAgZGVjaW1hbHM6IDE4LFxuICAgIC8vICAgICBuYW1lOiAnTGlxdWlkaXR5IFBvb2wgVG9rZW4nLFxuICAgIC8vICAgICBzeW1ib2w6ICdNR1ItVFVSJyxcbiAgICAvLyAgICAgYWRkcmVzczogJydcbiAgICAvLyAgIH1cbiAgICBjb25zb2xlLmxvZyhcIkJvYiBpcyB0cnlpbmcgdG8gYWRkIGxpcXVpZGl0eSB0byB0aGUgTUdYLVRVUiBwb29sXCIpO1xuICAgIGNvbnN0IGJvYiA9IGtleXJpbmcuYWRkRnJvbVVyaSgnLy9Cb2InLCB1bmRlZmluZWQsICdzcjI1NTE5Jyk7XG4gICAgY29uc3Qge2FkZHJlc3NCb2J9ID0gYm9iO1xuICAgIGF3YWl0IHByaW50QWNjb3VudEluZm8oYm9iKTtcblxuLy8gICBjb25zdCBwcm94eUFjY291bnQgPSBtYW5nYXRhSGVscGVyLmdldFByb3h5QWRkcmVzc01hbmdhdGEoa2V5UGFpci5hZGRyZXNzKTtcbi8vICAgY29uc29sZS5sb2coXCJwcm94eSBhY2NvdW50OlwiLCBrZXlyaW5nLmVuY29kZUFkZHJlc3MocHJveHlBY2NvdW50LCBTVUJTVFJBVEVfU1M1OCkpO1xuXG4vLyAgIG1hbmdhdGFIZWxwZXIuYWRkUHJveHkocHJveHlBY2NvdW50LCBrZXlQYWlyKTtcbi8vICAgY29uc29sZS5sb2coJ0FkZCBwcm94eSBvbiBtYW5nYXRhIHN1Y2Nlc3NmdWxseSEnKTtcblxuICBjb25zdCBtZXNzYWdlID0gXCJlbXB0eVwiO1xuLy8gICBhd2FpdCBvYWtIZWxwZXIueGNtU2VuZChkZXN0LCBtZXNzYWdlKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcHJpbnRBY2NvdW50SW5mbyAgKGFjY291bnQpIHtcbiAgICBjb25zdCB7YWRkcmVzc30gPSBhY2NvdW50O1xuICAgIGNvbnN0IHJvY29jb0FkZHJlc3MgPSBrZXlyaW5nLmVuY29kZUFkZHJlc3MoYWRkcmVzcywgU1VCU1RSQVRFX1NTNTgpO1xuICAgIGNvbnN0IHR1cmluZ0FkZHJlc3MgPSBrZXlyaW5nLmVuY29kZUFkZHJlc3MoYWRkcmVzcywgVFVSSU5HX1NTNTgpO1xuICAgIGNvbnN0IG1hbmdhdGFBZGRyZXNzID0ga2V5cmluZy5lbmNvZGVBZGRyZXNzKGFkZHJlc3MsIE1BTkdBVEFfU1M1OCk7XG4gICAgY29uc3QgbWFuZ2F0YUFjY291bnRJbmZvID0gYXdhaXQgbWFuZ2F0YUhlbHBlci5nZXRBY2NvdW50SW5mbyhtYW5nYXRhQWRkcmVzcyk7XG4gICAgY29uc3QgdHVyaW5nQWNjb3VudEluZm8gPSBhd2FpdCBvYWtIZWxwZXIuZ2V0QWNjb3VudEluZm8odHVyaW5nQWRkcmVzcyk7XG5cbiAgICBjb25zb2xlLmxvZyhcIlJvY29jbyBhZGRyZXNzOiBcIiwgcm9jb2NvQWRkcmVzcyk7XG4gICAgY29uc29sZS5sb2coXCJUdXJpbmcgYWRkcmVzczogXCIsIHR1cmluZ0FkZHJlc3MsIHR1cmluZ0FjY291bnRJbmZvKTtcbiAgICBjb25zb2xlLmxvZyhcIk1hbmdhdGEgYWRkcmVzczogXCIsIG1hbmdhdGFBZGRyZXNzLCBtYW5nYXRhQWNjb3VudEluZm8pO1xufVxuXG5tYWluKCkuY2F0Y2goY29uc29sZS5lcnJvcikuZmluYWxseSgoKSA9PiBwcm9jZXNzLmV4aXQoKSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUErQztBQUUvQyxNQUFNQSxjQUFjLEdBQUcsRUFBRTtBQUN6QixNQUFNQyxXQUFXLEdBQUcsRUFBRTtBQUN0QixNQUFNQyxZQUFZLEdBQUcsRUFBRTtBQUN2QixNQUFNQyxXQUFXLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixXQUFXO0FBQzNDLE1BQU1HLGVBQWUsR0FBR0YsT0FBTyxDQUFDQyxHQUFHLENBQUNDLGVBQWU7QUFDbkQsTUFBTUMsWUFBWSxHQUFHSCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0UsWUFBWTtBQUM3QyxNQUFNQyxlQUFlLEdBQUdKLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRyxlQUFlO0FBRW5ELE1BQU1DLGFBQWEsR0FBRyxDQUFDO0FBQ3ZCLE1BQU1DLGFBQWEsR0FBRyxDQUFDOztBQUV2QjtBQUNBLE1BQU1DLE9BQU8sR0FBRyxJQUFJQyxZQUFPLEVBQUU7QUFFN0IsZUFBZUMsSUFBSSxHQUFJO0VBQ3JCLE1BQU0sSUFBQUMsMkJBQWUsR0FBRTs7RUFFckI7RUFDQSxNQUFNQyxrQkFBUyxDQUFDQyxVQUFVLENBQUNULFlBQVksQ0FBQztFQUN4QyxNQUFNVSxzQkFBYSxDQUFDRCxVQUFVLENBQUNSLGVBQWUsQ0FBQztFQUMvQyxNQUFNVSxNQUFNLEdBQUdILGtCQUFTLENBQUNJLE1BQU0sRUFBRTtFQUVuQyxNQUFNQyxPQUFPLEdBQUdULE9BQU8sQ0FBQ1UsVUFBVSxDQUFDLFNBQVMsRUFBRUMsU0FBUyxFQUFFLFNBQVMsQ0FBQztFQUNuRSxNQUFNO0lBQUNDO0VBQU8sQ0FBQyxHQUFHSCxPQUFPO0VBQ3pCLE1BQU1JLGFBQWEsR0FBR2IsT0FBTyxDQUFD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","map":{"version":3,"names":["SUBSTRATE_SS58","TURING_SS58","MANGATA_SS58","TURING_PARA_ID","process","env","MANGATA_PARA_ID","TURING_ENDPOINT","MANGATA_ENDPOINT","mgxCurrencyId","turCurrencyId","keyring","Keyring","main","cryptoWaitReady","oakHelper","initialize","mangataHelper","oakApi","getApi","account","addFromUri","undefined","address","rococoAddress","encodeAddress","turingAddress","mangataAddress","mangataAccountInfo","getAccountInfo","turingAccountInfo","console","log","DescendOriginAddress32","getProxyAccount","mgxAddress","pools","getPools","bob","addressBob","printAccountInfo","message","catch","error","finally","exit"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/","sources":["xcm.js"],"sourcesContent":["import \"@imstar15/api-augment\";\nimport { Keyring } from \"@polkadot/api\";\nimport { cryptoWaitReady } from '@polkadot/util-crypto';\nimport oakHelper from \"./common/oakHelper\";\nimport mangataHelper from \"./common/mangataHelper\";\nimport BN from 'bn.js';\nimport { Mangata } from \"@mangata-finance/sdk\";\nimport { sendExtrinsic } from \"./common/utils\";\n\nconst SUBSTRATE_SS58 = 42;\nconst TURING_SS58 = 51;\nconst MANGATA_SS58 = 42;\nconst TURING_PARA_ID = process.env.TURING_PARA_ID;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst TURING_ENDPOINT = process.env.TURING_ENDPOINT;\nconst MANGATA_ENDPOINT = process.env.MANGATA_ENDPOINT;\n\nconst mgxCurrencyId = 0;\nconst turCurrencyId = 7;\n\n// const OAK_SOV_ACCOUNT = \"68kxzikS2WZNkYSPWdYouqH5sEZujecVCy3TFt9xHWB5MDG5\";\nconst keyring = new Keyring();\n\nasync function main () {\n  await cryptoWaitReady();\n\n    // Initialize\n    await oakHelper.initialize(TURING_ENDPOINT);\n    await mangataHelper.initialize(MANGATA_ENDPOINT);\n    const oakApi = oakHelper.getApi();\n\n  const account = keyring.addFromUri('//Alice', undefined, 'sr25519');\n  const {address} = account;\n  const rococoAddress = keyring.encodeAddress(address, SUBSTRATE_SS58);\n  const turingAddress = keyring.encodeAddress(address, TURING_SS58);\n  const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n  const mangataAccountInfo = await mangataHelper.getAccountInfo(mangataAddress);\n  const turingAccountInfo = await oakHelper.getAccountInfo(turingAddress);\n  console.log(\"Rococo address: \", rococoAddress);\n  console.log(\"Turing address: \", turingAddress, turingAccountInfo);\n  console.log(\"Mangata address: \", mangataAddress, mangataAccountInfo);\n\n  const DescendOriginAddress32 = mangataHelper.getProxyAccount(mangataAddress);\n  console.log('32 byte address is %s', DescendOriginAddress32);\n\n    // console.log(\"mangata account from turing:\", keyring.encodeAddress(turingAddress MANGATA_SS58));\n  //   console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n  // Create pool\n\n    const mgxAddress = keyring.encodeAddress(\"0xec00ad0ec6eeb271a9689888f644d9262016a26a25314ff4ff5d756404c44112\", MANGATA_SS58);\n    console.log(\"mgxAddress\", mgxAddress);\n        \n    // console.log('Minting TUR tokens with sudo permission ...');\n    // const mintTokenExtrinsic = mangataHelper.getApi().tx.tokens.mint(turCurrencyId, address, 5000000000000000);\n    // await sendExtrinsic(mangataHelper.getApi(), mintTokenExtrinsic, account, { isSudo: true });\n\n    // console.log('Minting KSM tokens with sudo permission ...');\n    // const mintTokenExtrinsic = mangataHelper.getApi().tx.tokens.mint(4, address, 5000000000000000);\n    // await sendExtrinsic(mangataHelper.getApi(), mintTokenExtrinsic, account, { isSudo: true });\n\n\t// console.log('Creating a TUR-MGX pool with ${} ${} and ${} ${}...');\n    // await mangataHelper.createPool(account);\n\n    // console.log('Creating a KSM-MGX pool with ${} ${} and ${} ${}...');\n    // await mangataHelper.createPool(account);\n   \n\tconst pools = await mangataHelper.getPools();\n\tconsole.log('Pools: ', pools);\n\n    // const chainInfo = await mangataHelper.getChainInfo();\n    // console.log(\"chainInfo\",chainInfo);\n\n    // '8': {\n    //     id: '8',\n    //     chainId: 0,\n    //     decimals: 18,\n    //     name: 'Liquidity Pool Token',\n    //     symbol: 'MGR-TUR',\n    //     address: ''\n    //   }\n    console.log(\"Bob is trying to add liquidity to the MGX-TUR pool\");\n    const bob = keyring.addFromUri('//Bob', undefined, 'sr25519');\n    const {addressBob} = bob;\n    await printAccountInfo(bob);\n\n//   const proxyAccount = mangataHelper.getProxyAddressMangata(keyPair.address);\n//   console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n//   mangataHelper.addProxy(proxyAccount, keyPair);\n//   console.log('Add proxy on mangata successfully!');\n\n  const message = \"empty\";\n//   await oakHelper.xcmSend(dest, message);\n}\n\nasync function printAccountInfo  (account) {\n    const {address} = account;\n    const rococoAddress = keyring.encodeAddress(address, SUBSTRATE_SS58);\n    const turingAddress = keyring.encodeAddress(address, TURING_SS58);\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n    const mangataAccountInfo = await mangataHelper.getAccountInfo(mangataAddress);\n    const turingAccountInfo = await oakHelper.getAccountInfo(turingAddress);\n\n    console.log(\"Rococo address: \", rococoAddress);\n    console.log(\"Turing address: \", turingAddress, turingAccountInfo);\n    console.log(\"Mangata address: \", mangataAddress, mangataAccountInfo);\n}\n\nmain().catch(console.error).finally(() => process.exit());\n"],"mappings":"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"}},"mtime":1668818073198},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/oakHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _types = require(\"@imstar15/types\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass OakHelper {\n  initialize = async endpoint => {\n    const api = await _api.ApiPromise.create({\n      provider: new _api.WsProvider(endpoint),\n      rpc: _types.rpc\n    });\n    this.api = api;\n  };\n  getApi = () => this.api;\n  getAccountInfo = async address => {\n    // Retrieve the account balance & nonce via the system module\n    const {\n      data: balance\n    } = await this.api.query.system.account(address);\n    const turBalance = balance.free.div(new _bn.default(DECIMAL.TUR)).toNumber();\n\n    // TODO: figure out how to retrieve balance of other tokens\n    return {\n      TUR: turBalance\n    };\n  };\n  getProxyAddressMangata = address => {\n    const keyring = new _api.Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [{\n          Parachain: MANGATA_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: keyring.decodeAddress(mangataAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const proxyAccount = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  };\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100,\n      // does not except negative?\n      runtimeVersion: this.api.runtimeVersion\n    });\n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  };\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\", dest, message);\n    return new Promise(async resolve => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async resolve => {\n      const unsub = await xcmpCall.signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n\n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n}\n;\nvar _default = new OakHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPQUtfUEFSQV9JRCIsIk1BTkdBVEFfU1M1OCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdYIiwiS1NNIiwiVFVSIiwiT2FrSGVscGVyIiwiaW5pdGlhbGl6ZSIsImVuZHBvaW50IiwiYXBpIiwiQXBpUHJvbWlzZSIsImNyZWF0ZSIsInByb3ZpZGVyIiwiV3NQcm92aWRlciIsInJwYyIsImdldEFwaSIsImdldEFjY291bnRJbmZvIiwiYWRkcmVzcyIsImRhdGEiLCJiYWxhbmNlIiwicXVlcnkiLCJzeXN0ZW0iLCJhY2NvdW50IiwidHVyQmFsYW5jZSIsImZyZWUiLCJkaXYiLCJCTiIsInRvTnVtYmVyIiwiZ2V0UHJveHlBZGRyZXNzTWFuZ2F0YSIsImtleXJpbmciLCJLZXlyaW5nIiwibWFuZ2F0YUFkZHJlc3MiLCJlbmNvZGVBZGRyZXNzIiwibG9jYXRpb24iLCJwYXJlbnRzIiwiaW50ZXJpb3IiLCJYMiIsIlBhcmFjaGFpbiIsIkFjY291bnRJZDMyIiwibmV0d29yayIsImlkIiwiZGVjb2RlQWRkcmVzcyIsIm11bHRpbG9jYXRpb24iLCJjcmVhdGVUeXBlIiwidG9IYXNoIiwiVWludDhBcnJheSIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwidG9VOGEiLCJwcm94eUFjY291bnQiLCJ1OGFUb0hleCIsInJlZ2lzdHJ5IiwiaGFzaCIsInNsaWNlIiwiZ2V0WGNtRmVlcyIsInhjbXBDYWxsIiwiZmFrZVNpZ25lZFhjbXBDYWxsIiwic2lnbkZha2UiLCJibG9ja0hhc2giLCJnZW5lc2lzSGFzaCIsIm5vbmNlIiwicnVudGltZVZlcnNpb24iLCJmZWVzIiwieGNtcEhhbmRsZXIiLCJ0b0hleCIsInhjbVNlbmQiLCJkZXN0IiwibWVzc2FnZSIsImNvbnNvbGUiLCJsb2ciLCJQcm9taXNlIiwicmVzb2x2ZSIsInVuc3ViIiwidHgiLCJwb2xrYWRvdFhjbSIsInNlbmQiLCJzaWduQW5kU2VuZCIsImtleVBhaXIiLCJzdGF0dXMiLCJpc0luQmxvY2siLCJhc0luQmxvY2siLCJ0eXBlIiwic2VuZFhjbUV4dHJpbnNpYyIsInRhc2tJZCIsInRhc2siLCJhdXRvbWF0aW9uVGltZSIsImFjY291bnRUYXNrcyIsInRvSHVtYW4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby94Y21wX2F1dG9tYXRpb24vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbIm9ha0hlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBycGMgfSBmcm9tICdAaW1zdGFyMTUvdHlwZXMnO1xuaW1wb3J0IHsgQXBpUHJvbWlzZSwgV3NQcm92aWRlciwgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyB1OGFUb0hleCB9IGZyb20gXCJAcG9sa2Fkb3QvdXRpbFwiO1xuaW1wb3J0IEJOIGZyb20gJ2JuLmpzJztcblxuY29uc3QgT0FLX1BBUkFfSUQgPSAyMTE0O1xuY29uc3QgTUFOR0FUQV9TUzU4ID0gNDI7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5cbmNvbnN0IERFQ0lNQUwgPSB7XG4gIE1HWDogJzEwMDAwMDAwMDAwMDAwMDAwMDAnLFxuICBLU006ICcxMDAwMDAwMDAwMDAwJyxcbiAgVFVSOiAnMTAwMDAwMDAwMDAnLFxufTtcblxuY2xhc3MgT2FrSGVscGVyIHtcbiAgaW5pdGlhbGl6ZSA9IGFzeW5jIChlbmRwb2ludCkgPT4ge1xuICAgIGNvbnN0IGFwaSA9IGF3YWl0IEFwaVByb21pc2UuY3JlYXRlKHsgcHJvdmlkZXI6IG5ldyBXc1Byb3ZpZGVyKGVuZHBvaW50KSwgcnBjIH0pO1xuXHRcdHRoaXMuYXBpID0gYXBpO1xuICB9XG5cbiAgZ2V0QXBpID0gKCkgPT4gdGhpcy5hcGk7XG5cbiAgZ2V0QWNjb3VudEluZm8gPSBhc3luYyhhZGRyZXNzKT0+e1xuICAgIC8vIFJldHJpZXZlIHRoZSBhY2NvdW50IGJhbGFuY2UgJiBub25jZSB2aWEgdGhlIHN5c3RlbSBtb2R1bGVcbiAgICBjb25zdCB7IGRhdGE6IGJhbGFuY2UgfSA9IGF3YWl0IHRoaXMuYXBpLnF1ZXJ5LnN5c3RlbS5hY2NvdW50KGFkZHJlc3MpO1xuXG4gICAgY29uc3QgdHVyQmFsYW5jZSA9IGJhbGFuY2UuZnJlZS5kaXYobmV3IEJOKERFQ0lNQUwuVFVSKSkudG9OdW1iZXIoKVxuXG4gICAgLy8gVE9ETzogZmlndXJlIG91dCBob3cgdG8gcmV0cmlldmUgYmFsYW5jZSBvZiBvdGhlciB0b2tlbnNcbiAgICByZXR1cm4ge1RVUjogdHVyQmFsYW5jZX07XG4gIH1cblxuICBnZXRQcm94eUFkZHJlc3NNYW5nYXRhID0gKGFkZHJlc3MpID0+IHtcbiAgICBjb25zdCBrZXlyaW5nID0gbmV3IEtleXJpbmcoKTtcbiAgICBjb25zdCBtYW5nYXRhQWRkcmVzcyA9IGtleXJpbmcuZW5jb2RlQWRkcmVzcyhhZGRyZXNzLCBNQU5HQVRBX1NTNTgpO1xuXG4gICAgY29uc3QgbG9jYXRpb24gPSB7XG4gICAgICBwYXJlbnRzOiAxLFxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogTUFOR0FUQV9QQVJBX0lEIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgQWNjb3VudElkMzI6IHtcbiAgICAgICAgICAgICAgbmV0d29yazogXCJBbnlcIixcbiAgICAgICAgICAgICAgaWQ6IGtleXJpbmcuZGVjb2RlQWRkcmVzcyhtYW5nYXRhQWRkcmVzcyksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG11bHRpbG9jYXRpb24gPSB0aGlzLmFwaS5jcmVhdGVUeXBlKFwiWGNtVjFNdWx0aUxvY2F0aW9uXCIsIGxvY2F0aW9uKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBwcm94eUFjY291bnQgPSB1OGFUb0hleCh0aGlzLmFwaS5yZWdpc3RyeS5oYXNoKHRvSGFzaCkuc2xpY2UoMCwgMzIpKTtcbiAgICByZXR1cm4gcHJveHlBY2NvdW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBYQ00gZmVlc1xuICAgKiBGYWtlIHNpZ24gdGhlIGNhbGwgaW4gb3JkZXIgdG8gZ2V0IHRoZSBjb21iaW5lZCBmZWVzIGZyb20gVHVyaW5nLlxuICAgKiBUdXJpbmcgeGNtcEhhbmRsZXJfZmVlcyBSUEMgcmVxdWlyZXMgdGhlIGVuY29kZWQgY2FsbCBpbiB0aGlzIGZvcm1hdC5cbiAgICogRmVlcyByZXR1cm5lZCBpbmNsdWRlIGluY2x1c2lvbiwgYWxsIGV4ZWN1dGlvbnMsIGFuZCBYQ01QIGZlZXMgdG8gcnVuIG9uIFRhcmdldCBDaGFpbi5cbiAgICogQHBhcmFtIHsqfSBhZGRyZXNzIFxuICAgKiBAcGFyYW0geyp9IHhjbXBDYWxsIFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIGdldFhjbUZlZXMgPSBhc3luYyAoYWRkcmVzcywgeGNtcENhbGwpID0+IHtcbiAgICBjb25zdCBmYWtlU2lnbmVkWGNtcENhbGwgPSB4Y21wQ2FsbC5zaWduRmFrZShhZGRyZXNzLCB7XG4gICAgICBibG9ja0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgZ2VuZXNpc0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgbm9uY2U6IDEwMCwgLy8gZG9lcyBub3QgZXhjZXB0IG5lZ2F0aXZlP1xuICAgICAgcnVudGltZVZlcnNpb246IHRoaXMuYXBpLnJ1bnRpbWVWZXJzaW9uLFxuICAgIH0pO1xuICBcbiAgICBjb25zdCBmZWVzID0gYXdhaXQgdGhpcy5hcGkucnBjLnhjbXBIYW5kbGVyLmZlZXMoZmFrZVNpZ25lZFhjbXBDYWxsLnRvSGV4KCkpO1xuICAgIHJldHVybiBmZWVzO1xuICB9XG5cbiAgeGNtU2VuZCA9IGFzeW5jIChkZXN0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJ4Y21TZW5kLFwiLGRlc3QsbWVzc2FnZSk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IHVuc3ViID0gYXdhaXQgdGhpcy5hcGkudHgucG9sa2Fkb3RYY20uc2VuZChkZXN0LCBtZXNzYWdlKS5zaWduQW5kU2VuZChrZXlQYWlyLCB7IG5vbmNlOiAtMSB9LCBhc3luYyAoeyBzdGF0dXMgfSkgPT4ge1xuICAgICAgICBpZiAoc3RhdHVzLmlzSW5CbG9jaykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsIHdpdGggaGFzaCAnICsgc3RhdHVzLmFzSW5CbG9jay50b0hleCgpKTtcbiAgXG4gICAgICAgICAgdW5zdWIoKTtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N0YXR1czogJyArIHN0YXR1cy50eXBlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbiAgc2VuZFhjbUV4dHJpbnNpYyA9IGFzeW5jICh4Y21wQ2FsbCwga2V5UGFpciwgdGFza0lkKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCB1bnN1YiA9IGF3YWl0IHhjbXBDYWxsLnNpZ25BbmRTZW5kKGtleVBhaXIsIHsgbm9uY2U6IC0xIH0sIGFzeW5jICh7IHN0YXR1cyB9KSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXMuaXNJbkJsb2NrKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWwgd2l0aCBoYXNoICcgKyBzdGF0dXMuYXNJbkJsb2NrLnRvSGV4KCkpO1xuICBcbiAgICAgICAgICAvLyBHZXQgVGFza1xuICAgICAgICAgIGNvbnN0IHRhc2sgPSBhd2FpdCB0aGlzLmFwaS5xdWVyeS5hdXRvbWF0aW9uVGltZS5hY2NvdW50VGFza3Moa2V5UGFpci5hZGRyZXNzLCB0YXNrSWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGFzazpcIiwgdGFzay50b0h1bWFuKCkpO1xuICBcbiAgICAgICAgICB1bnN1YigpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU3RhdHVzOiAnICsgc3RhdHVzLnR5cGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbmV3IE9ha0hlbHBlcigpOyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBdUI7QUFFdkIsTUFBTUEsV0FBVyxHQUFHLElBQUk7QUFDeEIsTUFBTUMsWUFBWSxHQUFHLEVBQUU7QUFDdkIsTUFBTUMsZUFBZSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsZUFBZTtBQUVuRCxNQUFNRyxPQUFPLEdBQUc7RUFDZEMsR0FBRyxFQUFFLHFCQUFxQjtFQUMxQkMsR0FBRyxFQUFFLGVBQWU7RUFDcEJDLEdBQUcsRUFBRTtBQUNQLENBQUM7QUFFRCxNQUFNQyxTQUFTLENBQUM7RUFDZEMsVUFBVSxHQUFHLE1BQU9DLFFBQVEsSUFBSztJQUMvQixNQUFNQyxHQUFHLEdBQUcsTUFBTUMsZUFBVSxDQUFDQyxNQUFNLENBQUM7TUFBRUMsUUFBUSxFQUFFLElBQUlDLGVBQVUsQ0FBQ0wsUUFBUSxDQUFDO01BQUVNLEdBQUcsRUFBSEE7SUFBSSxDQUFDLENBQUM7SUFDbEYsSUFBSSxDQUFDTCxHQUFHLEdBQUdBLEdBQUc7RUFDZCxDQUFDO0VBRURNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQ04sR0FBRztFQUV2Qk8sY0FBYyxHQUFHLE1BQU1DLE9BQU8sSUFBRztJQUMvQjtJ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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_SS58","MANGATA_PARA_ID","process","env","DECIMAL","MGX","KSM","TUR","OakHelper","initialize","endpoint","api","ApiPromise","create","provider","WsProvider","rpc","getApi","getAccountInfo","address","data","balance","query","system","account","turBalance","free","div","BN","toNumber","getProxyAddressMangata","keyring","Keyring","mangataAddress","encodeAddress","location","parents","interior","X2","Parachain","AccountId32","network","id","decodeAddress","multilocation","createType","toHash","Uint8Array","TextEncoder","encode","toU8a","proxyAccount","u8aToHex","registry","hash","slice","getXcmFees","xcmpCall","fakeSignedXcmpCall","signFake","blockHash","genesisHash","nonce","runtimeVersion","fees","xcmpHandler","toHex","xcmSend","dest","message","console","log","Promise","resolve","unsub","tx","polkadotXcm","send","signAndSend","keyPair","status","isInBlock","asInBlock","type","sendXcmExtrinsic","taskId","task","automationTime","accountTasks","toHuman"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/","sources":["oakHelper.js"],"sourcesContent":["import { rpc } from '@imstar15/types';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport BN from 'bn.js';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\n\nclass OakHelper {\n  initialize = async (endpoint) => {\n    const api = await ApiPromise.create({ provider: new WsProvider(endpoint), rpc });\n\t\tthis.api = api;\n  }\n\n  getApi = () => this.api;\n\n  getAccountInfo = async(address)=>{\n    // Retrieve the account balance & nonce via the system module\n    const { data: balance } = await this.api.query.system.account(address);\n\n    const turBalance = balance.free.div(new BN(DECIMAL.TUR)).toNumber()\n\n    // TODO: figure out how to retrieve balance of other tokens\n    return {TUR: turBalance};\n  }\n\n  getProxyAddressMangata = (address) => {\n    const keyring = new Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [\n          { Parachain: MANGATA_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: keyring.decodeAddress(mangataAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const proxyAccount = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  }\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100, // does not except negative?\n      runtimeVersion: this.api.runtimeVersion,\n    });\n  \n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  }\n\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\",dest,message);\n\n    return new Promise(async (resolve) => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n}\n\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async (resolve) => {\n      const unsub = await xcmpCall.signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  }\n};\n\nexport default new OakHelper();"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAAuB;AAEvB,MAAMA,WAAW,GAAG,IAAI;AACxB,MAAMC,YAAY,GAAG,EAAE;AACvB,MAAMC,eAAe,GAAGC,OAAO,CAACC,GAAG,CAACF,eAAe;AAEnD,MAAMG,OAAO,GAAG;EACdC,GAAG,EAAE,qBAAqB;EAC1BC,GAAG,EAAE,eAAe;EACpBC,GAAG,EAAE;AACP,CAAC;AAED,MAAMC,SAAS,CAAC;EACdC,UAAU,GAAG,MAAOC,QAAQ,IAAK;IAC/B,MAAMC,GAAG,GAAG,MAAMC,eAAU,CAACC,MAAM,CAAC;MAAEC,QAAQ,EAAE,IAAIC,eAAU,CAACL,QAAQ,CAAC;MAAEM,GAAG,EAAHA;IAAI,CAAC,CAAC;IAClF,IAAI,CAACL,GAAG,GAAGA,GAAG;EACd,CAAC;EAEDM,MAAM,GAAG,MAAM,IAAI,CAACN,GAAG;EAEvBO,cAAc,GAAG,MAAMC,OAAO,IAAG;IAC/B;IACA,MAAM;MAAEC,IAAI,EAAEC;IAAQ,CAAC,GAAG,MAAM,IAAI,CAACV,GAAG,CAACW,KAAK,CAACC,MAAM,CAACC,OAAO,CAACL,OAAO,CAAC;IAEtE,MAAMM,UAAU,GAAGJ,OAAO,CAACK,IAAI,CAACC,GAAG,CAAC,IAAIC,WAAE,CAACxB,OAAO,CAACG,GAAG,CAAC,CAAC,CAACsB,QAAQ,EAAE;;IAEnE;IACA,OAAO;MAACtB,GAAG,EAAEkB;IAAU,CAAC;EAC1B,CAAC;EAEDK,sBAAsB,GAAIX,OAAO,IAAK;IACpC,MAAMY,OAAO,GAAG,IAAIC,YAAO,EAAE;IAC7B,MAAMC,cAAc,GAAGF,OAAO,CAACG,aAAa,CAACf,OAAO,EAAEnB,YAAY,CAAC;IAEnE,MAAMmC,QAAQ,GAAG;MACfC,OAAO,EAAE,CAAC;MACVC,QAAQ,EAAE;QACRC,EAAE,EAAE,CACF;UAAEC,SAAS,EAAEtC;QAAgB,CAAC,EAC9B;UACEuC,WAAW,EAAE;YACXC,OAAO,EAAE,KAAK;YACdC,EAAE,EAAEX,OAAO,CAACY,aAAa,CAACV,cAAc;UAC1C;QACF,CAAC;MAEL;IACF,CAAC;IAED,MAAMW,aAAa,GAAG,IAAI,CAACjC,GAAG,CAACkC,UAAU,CAAC,oBAAoB,EAAEV,QAAQ,CAAC;IAEzE,MAAMW,MAAM,GAAG,IAAIC,UAAU,CAAC,CAC5B,GAAG,IAAIA,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,EACvB,GAAG,IAAIC,WAAW,EAAE,CAACC,MAAM,CAAC,UAAU,CAAC,EACvC,GAAGL,aAAa,CAACM,KAAK,EAAE,CACzB,CAAC;IAEF,MAAMC,YAAY,GAAG,IAAAC,cAAQ,EAAC,IAAI,CAACzC,GAAG,CAAC0C,QAAQ,CAACC,IAAI,CAACR,MAAM,CAAC,CAACS,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAC1E,OAAOJ,YAAY;EACrB,CAAC;;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEK,UAAU,GAAG,OAAOrC,OAAO,EAAEsC,QAAQ,KAAK;IACxC,MAAMC,kBAAkB,GAAGD,QAAQ,CAACE,QAAQ,CAACxC,OAAO,EAAE;MACpDyC,SAAS,EAAE,IAAI,CAACjD,GAAG,CAACkD,WAAW;MAC/BA,WAAW,EAAE,IAAI,CAAClD,GAAG,CAACkD,WAAW;MACjCC,KAAK,EAAE,GAAG;MAAE;MACZC,cAAc,EAAE,IAAI,CAACpD,GAAG,CAACoD;IAC3B,CAAC,CAAC;IAEF,MAAMC,IAAI,GAAG,MAAM,IAAI,CAACrD,GAAG,CAACK,GAAG,CAACiD,WAAW,CAACD,IAAI,CAACN,kBAAkB,CAACQ,KAAK,EAAE,CAAC;IAC5E,OAAOF,IAAI;EACb,CAAC;EAEDG,OAAO,GAAG,OAAOC,IAAI,EAAEC,OAAO,KAAK;IACjCC,OAAO,CAACC,GAAG,CAAC,UAAU,EAACH,IAAI,EAACC,OAAO,CAAC;IAEpC,OAAO,IAAIG,OAAO,CAAC,MAAOC,OAAO,IAAK;MACpC,MAAMC,KAAK,GAAG,MAAM,IAAI,CAAC/D,GAAG,CAACgE,EAAE,CAACC,WAAW,CAACC,IAAI,CAACT,IAAI,EAAEC,OAAO,CAAC,CAACS,WAAW,CAACC,OAAO,EAAE;QAAEjB,KAAK,EAAE,CAAC;MAAE,CAAC,EAAE,OAAO;QAAEkB;MAAO,CAAC,KAAK;QACxH,IAAIA,MAAM,CAACC,SAAS,EAAE;UACpBX,OAAO,CAACC,GAAG,CAAC,uBAAuB,GAAGS,MAAM,CAACE,SAAS,CAAChB,KAAK,EAAE,CAAC;UAE/DQ,KAAK,EAAE;UACPD,OAAO,EAAE;QACX,CAAC,MAAM;UACLH,OAAO,CAACC,GAAG,CAAC,UAAU,GAAGS,MAAM,CAACG,IAAI,CAAC;QACvC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACN,CAAC;EAECC,gBAAgB,GAAG,OAAO3B,QAAQ,EAAEsB,OAAO,EAAEM,MAAM,KAAK;IACtD,OAAO,IAAIb,OAAO,CAAC,MAAOC,OAAO,IAAK;MACpC,MAAMC,KAAK,GAAG,MAAMjB,QAAQ,CAACqB,WAAW,CAACC,OAAO,EAAE;QAAEjB,KAAK,EAAE,CAAC;MAAE,CAAC,EAAE,OAAO;QAAEkB;MAAO,CAAC,KAAK;QACrF,IAAIA,MAAM,CAACC,SAAS,EAAE;UACpBX,OAAO,CAACC,GAAG,CAAC,uBAAuB,GAAGS,MAAM,CAACE,SAAS,CAAChB,KAAK,EAAE,CAAC;;UAE/D;UACA,MAAMoB,IAAI,GAAG,MAAM,IAAI,CAAC3E,GAAG,CAACW,KAAK,CAACiE,cAAc,CAACC,YAAY,CAACT,OAAO,CAAC5D,OAAO,EAAEkE,MAAM,CAAC;UACtFf,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEe,IAAI,CAACG,OAAO,EAAE,CAAC;UAEpCf,KAAK,EAAE;UACPD,OAAO,EAAE;QACX,CAAC,MAAM;UACLH,OAAO,CAACC,GAAG,CAAC,UAAU,GAAGS,MAAM,CAACG,IAAI,CAAC;QACvC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;AACH;AAAC;AAAC,eAEa,IAAI3E,SAAS,EAAE;AAAA"}},"mtime":1668757269868},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/mangataHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass MangataHelper {\n  initialize = async mangataEndpoint => {\n    const mangata = _sdk.Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n    this.mangata = mangata;\n    this.api = mangataApi;\n  };\n  getApi = () => this.api;\n  checkFreeBalance = async address => {\n    const tokenBalance = await this.mangata.getTokenBalance('0', address);\n    return tokenBalance.free;\n  };\n  getChainInfo = async account => {\n    // 2. Read chain asssets\n    const assets = await this.mangata.getAssetsInfo();\n    return assets;\n  };\n  getAccountInfo = async address => {\n    const balances = {};\n    balances.MGX = await this.getAssetFreeAmount(0, address, DECIMAL.MGX);\n    balances.KSM = await this.getAssetFreeAmount(4, address, DECIMAL.KSM);\n    balances.TUR = await this.getAssetFreeAmount(7, address, DECIMAL.TUR);\n    // balances['KSM-MGX'] = await this.mangata.getTokenBalance('5', account.address);\n    return balances;\n  };\n  getAssetFreeAmount = async (assetId, address, digits) => {\n    const asset = await this.mangata.getTokenBalance(assetId.toString(), address);\n    return asset.free.div(new _bn.default(digits)).toNumber();\n  };\n  getProxyAccount = address => {\n    const decodedAddress = (0, _utilCrypto.decodeAddress)(address);\n    const decondedAddressHex = (0, _util.u8aToHex)(decodedAddress); // a SS58 public key\n    console.log(\"decondedAddressHex\", decondedAddressHex);\n    const location = {\n      parents: 1,\n      // From Turing to Mangata\n      interior: {\n        X2: [{\n          Parachain: TURING_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: (0, _util.u8aToHex)(decodedAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    console.log(\"multilocation\", multilocation.toString());\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const DescendOriginAddress32 = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return DescendOriginAddress32;\n  };\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n  createPool = async account => {\n    return new Promise(async resolve => {\n      await this.mangata.createPool(account, '0', new _bn.default('1000000000000000000000'),\n      // 1000 MGX (MGX is 18 decimals)\n      '7', new _bn.default('1000000000000'),\n      // 1 TUR (TUR is 12 decimals)\n      {\n        statusCallback: result => {\n          // result is of the form ISubmittableResult\n          console.log(result);\n        },\n        extrinsicStatus: result => {\n          // result is of the form MangataGenericEvent[]\n          for (let index = 0; index < result.length; index++) {\n            console.log('Phase', result[index].phase.toString());\n            console.log('Section', result[index].section);\n            console.log('Method', result[index].method);\n            console.log('Documentation', result[index].metaDocumentation);\n          }\n        }\n      });\n    });\n  };\n  getPools = async () => {\n    return this.mangata.getPools();\n  };\n}\n;\nvar _default = new MangataHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPQUtfUEFSQV9JRCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdYIiwiS1NNIiwiVFVSIiwiTWFuZ2F0YUhlbHBlciIsImluaXRpYWxpemUiLCJtYW5nYXRhRW5kcG9pbnQiLCJtYW5nYXRhIiwiTWFuZ2F0YSIsImdldEluc3RhbmNlIiwibWFuZ2F0YUFwaSIsImdldEFwaSIsImFwaSIsImNoZWNrRnJlZUJhbGFuY2UiLCJhZGRyZXNzIiwidG9rZW5CYWxhbmNlIiwiZ2V0VG9rZW5CYWxhbmNlIiwiZnJlZSIsImdldENoYWluSW5mbyIsImFjY291bnQiLCJhc3NldHMiLCJnZXRBc3NldHNJbmZvIiwiZ2V0QWNjb3VudEluZm8iLCJiYWxhbmNlcyIsImdldEFzc2V0RnJlZUFtb3VudCIsImFzc2V0SWQiLCJkaWdpdHMiLCJhc3NldCIsInRvU3RyaW5nIiwiZGl2IiwiQk4iLCJ0b051bWJlciIsImdldFByb3h5QWNjb3VudCIsImRlY29kZWRBZGRyZXNzIiwiZGVjb2RlQWRkcmVzcyIsImRlY29uZGVkQWRkcmVzc0hleCIsInU4YVRvSGV4IiwiY29uc29sZSIsImxvZyIsImxvY2F0aW9uIiwicGFyZW50cyIsImludGVyaW9yIiwiWDIiLCJQYXJhY2hhaW4iLCJBY2NvdW50SWQzMiIsIm5ldHdvcmsiLCJpZCIsIm11bHRpbG9jYXRpb24iLCJjcmVhdGVUeXBlIiwidG9IYXNoIiwiVWludDhBcnJheSIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwidG9VOGEiLCJEZXNjZW5kT3JpZ2luQWRkcmVzczMyIiwicmVnaXN0cnkiLCJoYXNoIiwic2xpY2UiLCJhZGRQcm94eSIsInByb3h5QWNjb3VudCIsImtleVBhaXIiLCJ0eCIsInByb3h5Iiwic2lnbkFuZFNlbmQiLCJjcmVhdGVQcm94eUNhbGwiLCJleHRyaW5zaWMiLCJjcmVhdGVQb29sIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzdGF0dXNDYWxsYmFjayIsInJlc3VsdCIsImV4dHJpbnNpY1N0YXR1cyIsImluZGV4IiwibGVuZ3RoIiwicGhhc2UiLCJzZWN0aW9uIiwibWV0aG9kIiwibWV0YURvY3VtZW50YXRpb24iLCJnZXRQb29scyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL21pa2FzYS9Db2RlL3hjbS1kZW1vL3hjbXBfYXV0b21hdGlvbi9zcmMvY29tbW9uLyIsInNvdXJjZXMiOlsibWFuZ2F0YUhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYW5nYXRhIH0gZnJvbSAnQG1hbmdhdGEtZmluYW5jZS9zZGsnO1xuaW1wb3J0IHsgQXBpUHJvbWlzZSwgV3NQcm92aWRlciwgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyB1OGFUb0hleCB9IGZyb20gXCJAcG9sa2Fkb3QvdXRpbFwiO1xuaW1wb3J0IHsgZGVjb2RlQWRkcmVzcyB9IGZyb20gJ0Bwb2xrYWRvdC91dGlsLWNyeXB0byc7XG5pbXBvcnQgQk4gZnJvbSAnYm4uanMnO1xuXG5jb25zdCBPQUtfUEFSQV9JRCA9IDIxMTQ7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5cbmNvbnN0IERFQ0lNQUwgPSB7XG4gIE1HWDogJzEwMDAwMDAwMDAwMDAwMDAwMDAnLFxuICBLU006ICcxMDAwMDAwMDAwMDAwJyxcbiAgVFVSOiAnMTAwMDAwMDAwMDAnLFxufTtcbmNsYXNzIE1hbmdhdGFIZWxwZXIge1xuICBpbml0aWFsaXplID0gYXN5bmMgKG1hbmdhdGFFbmRwb2ludCkgPT4ge1xuICAgIGNvbnN0IG1hbmdhdGEgPSBNYW5nYXRhLmdldEluc3RhbmNlKFttYW5nYXRhRW5kcG9pbnRdKTtcbiAgICBjb25zdCBtYW5nYXRhQXBpID0gYXdhaXQgbWFuZ2F0YS5nZXRBcGkoKTtcblxuICAgIHRoaXMubWFuZ2F0YSA9IG1hbmdhdGE7XG4gICAgdGhpcy5hcGkgPSBtYW5nYXRhQXBpO1xuXG5cbiAgfVxuXG4gIGdldEFwaSA9ICgpID0+IHRoaXMuYXBpO1xuXG4gIGNoZWNrRnJlZUJhbGFuY2UgPSBhc3luYyAoYWRkcmVzcykgPT4ge1xuICAgIGNvbnN0IHRva2VuQmFsYW5jZSA9IGF3YWl0IHRoaXMubWFuZ2F0YS5nZXRUb2tlbkJhbGFuY2UoJzAnLCBhZGRyZXNzKTtcbiAgICByZXR1cm4gdG9rZW5CYWxhbmNlLmZyZWU7XG4gIH1cblxuICBnZXRDaGFpbkluZm8gPSBhc3luYyAoYWNjb3VudCkgPT4ge1xuICAgICAgICAvLyAyLiBSZWFkIGNoYWluIGFzc3NldHNcbiAgICBjb25zdCBhc3NldHMgPSBhd2FpdCB0aGlzLm1hbmdhdGEuZ2V0QXNzZXRzSW5mbygpO1xuICAgIHJldHVybiBhc3NldHM7XG4gIH1cblxuICBnZXRBY2NvdW50SW5mbyA9IGFzeW5jIChhZGRyZXNzKSA9PiB7XG4gICAgY29uc3QgYmFsYW5jZXMgPSB7fTtcbiAgICBiYWxhbmNlcy5NR1ggPSBhd2FpdCB0aGlzLmdldEFzc2V0RnJlZUFtb3VudCgwLCBhZGRyZXNzLCBERUNJTUFMLk1HWCk7XG4gICAgYmFsYW5jZXMuS1NNID0gYXdhaXQgdGhpcy5nZXRBc3NldEZyZWVBbW91bnQoNCwgYWRkcmVzcywgREVDSU1BTC5LU00pO1xuICAgIGJhbGFuY2VzLlRVUiA9IGF3YWl0IHRoaXMuZ2V0QXNzZXRGcmVlQW1vdW50KDcsIGFkZHJlc3MsIERFQ0lNQUwuVFVSKTtcbiAgICAvLyBiYWxhbmNlc1snS1NNLU1HWCddID0gYXdhaXQgdGhpcy5tYW5nYXRhLmdldFRva2VuQmFsYW5jZSgnNScsIGFjY291bnQuYWRkcmVzcyk7XG4gICAgcmV0dXJuIGJhbGFuY2VzO1xuICB9XG5cbiAgZ2V0QXNzZXRGcmVlQW1vdW50ID0gYXN5bmMgKGFzc2V0SWQsIGFkZHJlc3MsIGRpZ2l0cyApPT57XG4gICAgY29uc3QgYXNzZXQgPSBhd2FpdCB0aGlzLm1hbmdhdGEuZ2V0VG9rZW5CYWxhbmNlKGFzc2V0SWQudG9TdHJpbmcoKSwgYWRkcmVzcyk7XG4gICAgcmV0dXJuIGFzc2V0LmZyZWUuZGl2KG5ldyBCTihkaWdpdHMpKS50b051bWJlcigpO1xuICB9IFxuXG4gIGdldFByb3h5QWNjb3VudCA9IChhZGRyZXNzKSA9PiB7XG4gICAgY29uc3QgZGVjb2RlZEFkZHJlc3MgPSBkZWNvZGVBZGRyZXNzKGFkZHJlc3MpO1xuICAgIGNvbnN0IGRlY29uZGVkQWRkcmVzc0hleCA9IHU4YVRvSGV4KGRlY29kZWRBZGRyZXNzKTsgLy8gYSBTUzU4IHB1YmxpYyBrZXlcbiAgICBjb25zb2xlLmxvZyhcImRlY29uZGVkQWRkcmVzc0hleFwiLCBkZWNvbmRlZEFkZHJlc3NIZXgpO1xuICAgIFxuICAgIGNvbnN0IGxvY2F0aW9uID0ge1xuICAgICAgcGFyZW50czogMSwgLy8gRnJvbSBUdXJpbmcgdG8gTWFuZ2F0YVxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogT0FLX1BBUkFfSUQgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBBY2NvdW50SWQzMjoge1xuICAgICAgICAgICAgICBuZXR3b3JrOiBcIkFueVwiLFxuICAgICAgICAgICAgICBpZDogdThhVG9IZXgoZGVjb2RlZEFkZHJlc3MpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBtdWx0aWxvY2F0aW9uID0gdGhpcy5hcGkuY3JlYXRlVHlwZShcIlhjbVYxTXVsdGlMb2NhdGlvblwiLCBsb2NhdGlvbik7XG5cbiAgICBjb25zb2xlLmxvZyhcIm11bHRpbG9jYXRpb25cIiwgbXVsdGlsb2NhdGlvbi50b1N0cmluZygpKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBEZXNjZW5kT3JpZ2luQWRkcmVzczMyID0gdThhVG9IZXgodGhpcy5hcGkucmVnaXN0cnkuaGFzaCh0b0hhc2gpLnNsaWNlKDAsIDMyKSk7XG5cbiAgICByZXR1cm4gRGVzY2VuZE9yaWdpbkFkZHJlc3MzMjtcbiAgfVxuXG4gIGFkZFByb3h5ID0gYXN5bmMgKHByb3h5QWNjb3VudCwga2V5UGFpcikgPT4gdGhpcy5hcGkudHgucHJveHkuYWRkUHJveHkocHJveHlBY2NvdW50LCBcIkFueVwiLCAwKS5zaWduQW5kU2VuZChrZXlQYWlyKTtcblxuICBjcmVhdGVQcm94eUNhbGwgPSBhc3luYyAoYWRkcmVzcywgZXh0cmluc2ljKSA9PiB0aGlzLmFwaS50eC5wcm94eS5wcm94eShhZGRyZXNzLCAnQW55JywgZXh0cmluc2ljKTtcblxuICBjcmVhdGVQb29sID0gYXN5bmMgKGFjY291bnQpID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMubWFuZ2F0YS5jcmVhdGVQb29sKFxuICAgICAgICBhY2NvdW50LFxuICAgICAgICAnMCcsXG4gICAgICAgIG5ldyBCTignMTAwMDAwMDAwMDAwMDAwMDAwMDAwMCcpLCAvLyAxMDAwIE1HWCAoTUdYIGlzIDE4IGRlY2ltYWxzKVxuICAgICAgICAnNycsXG4gICAgICAgIG5ldyBCTignMTAwMDAwMDAwMDAwMCcpLCAvLyAxIFRVUiAoVFVSIGlzIDEyIGRlY2ltYWxzKVxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzQ2FsbGJhY2s6IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIC8vIHJlc3VsdCBpcyBvZiB0aGUgZm9ybSBJU3VibWl0dGFibGVSZXN1bHRcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBleHRyaW5zaWNTdGF0dXM6IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIC8vIHJlc3VsdCBpcyBvZiB0aGUgZm9ybSBNYW5nYXRhR2VuZXJpY0V2ZW50W11cbiAgICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCByZXN1bHQubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUGhhc2UnLCByZXN1bHRbaW5kZXhdLnBoYXNlLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VjdGlvbicsIHJlc3VsdFtpbmRleF0uc2VjdGlvbilcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNZXRob2QnLCByZXN1bHRbaW5kZXhdLm1ldGhvZClcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEb2N1bWVudGF0aW9uJywgcmVzdWx0W2luZGV4XS5tZXRhRG9jdW1lbnRhdGlvbilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuICB9XG4gIGdldFBvb2xzID0gYXN5bmMoKSA9PntcbiAgICByZXR1cm4gdGhpcy5tYW5nYXRhLmdldFBvb2xzKCk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBNYW5nYXRhSGVscGVyKCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQXVCO0FBRXZCLE1BQU1BLFdBQVcsR0FBRyxJQUFJO0FBQ3hCLE1BQU1DLGVBQWUsR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNGLGVBQWU7QUFFbkQsTUFBTUcsT0FBTyxHQUFHO0VBQ2RDLEdBQUcsRUFBRSxxQkFBcUI7RUFDMUJDLEdBQUcsRUFBRSxlQUFlO0VBQ3BCQyxHQUFHLEVBQUU7QUFDUCxDQUFDO0FBQ0QsTUFBTUMsYUFBYSxDQUFDO0VBQ2xCQyxVQUFVLEdBQUcsTUFBT0MsZUFBZSxJQUFLO0lBQ3RDLE1BQU1DLE9BQU8sR0FBR0MsWUFBTyxDQUFDQyxXQUFXLENBQUMsQ0FBQ0gsZUFBZSxDQUFDLENBQUM7SUFDdEQsTUFBTUksVUFBVSxHQUFHLE1BQU1ILE9BQU8sQ0FBQ0ksTUFBTSxFQUFFO0lBRXpDLElBQUksQ0FBQ0osT0FBTyxHQUFHQSxPQUFPO0lBQ3RCLElBQUksQ0FBQ0ssR0FBRyxHQUFHRixVQUFVO0VBR3ZCLENBQUM7RUFFREMsTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDQyxHQUFHO0VBRXZCQyxnQkFBZ0IsR0FBRyxNQUFPQyxPQUFPLElBQUs7SUFDcEMsTUFBTUMsWUFBWSxHQUFHLE1BQU0sSUFBSSxDQUFDUixPQUFPLENBQUNTLGVBQWUsQ0FBQyxHQUFHLEVBQUVGLE9BQU8sQ0FBQztJQUNyRSxPQUFPQyxZQUFZLENBQUNFLElBQUk7RUFDMUIsQ0FBQztFQUVEQyxZQUFZLEdBQUcsTUFBT0MsT0FBTyxJQUFLO0lBQzVCO0lBQ0osTUFBTUMsTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDYixPQUFPLENBQUNjLGFBQWEsRUFBRTtJQUNqRCxPQUFPRCxNQUFNO0VBQ2YsQ0FBQztFQUVERSxjQUFjLEdBQUcsTUFBT1IsT0FBTyxJQUFLO0lBQ2xDLE1BQU1TLFFBQVEsR0FBRyxDQUFDLENBQUM7SUFDbkJBLFFBQVEsQ0FBQ3RCLEdBQUcsR0FBRyxNQUFNLElBQUksQ0FBQ3VCLGtCQUFrQixDQUFDLENBQUMsRUFBRVYsT0FBTyxFQUFFZCxPQUFPLENBQUNDLEdBQUcsQ0FBQztJQUNyRXNCLFFBQVEsQ0FBQ3JCLEdBQUcsR0FBRyxNQUFNLElBQUksQ0FBQ3NCLGtCQUFrQixDQUFDLENBQUMsRUFBRVYsT0FBTyxFQUFFZCxPQUFPLENBQUNFLEdBQUcsQ0FBQztJQUNyRXFCLFFBQVEsQ0FBQ3BCLEdBQUcsR0FBRyxNQUFNLElBQUksQ0FBQ3FCLGtCQUFrQixDQUFDLENBQUMsRUFBRVYsT0FBTyxFQUFFZCxPQUFPLENBQUNHLEdBQUcsQ0FBQztJQUNyRTtJQUNBLE9BQU9vQixRQUFRO0VBQ2pCLENBQUM7RUFFREMsa0JBQWtCLEdBQUcsT0FBT0MsT0FBTyxFQUFFWCxPQUFPLEVBQUVZLE1BQU0sS0FBSTtJQUN0RCxNQUFNQyxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUNwQixPQUFPLENBQUNTLGVBQWUsQ0FBQ1MsT0FBTyxDQUFDRyxRQUFRLEVBQUUsRUFBRWQsT0FBTyxDQUFDO0lBQzdFLE9BQU9hLEtBQUssQ0FBQ1YsSUFBSSxDQUFDWSxHQUFHLENBQUMsSUFBSUMsV0FBRSxDQUFDSixNQUFNLENBQUMsQ0FBQyxDQUFDSyxRQUFRLEVBQUU7RUFDbEQsQ0FBQztFQUVEQyxlQUFlLEdBQUlsQixPQUFPLElBQUs7SUFDN0IsTUFBTW1CLGNBQWMsR0FBRyxJQUFBQyx5QkFBYSxFQUFDcEIsT0FBTyxDQUFDO0lBQzdDLE1BQU1xQixrQkFBa0IsR0FBRyxJQUFBQyxjQUFRLEVBQUNILGNBQWMsQ0FBQyxDQUFDLENBQUM7SUFDckRJLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLG9CQUFvQixFQUFFSCxrQkFBa0IsQ0FBQztJQUVyRCxNQUFNSSxRQUFRLEdBQUc7TUFDZkMsT0FBTyxFQUFFLENBQUM7TUFBRTtNQUNaQyxRQUFRLEVBQUU7UUFDUkMsRUFBRSxFQUFFLENBQ0Y7VUFBRUMsU0FBUyxFQUFFL0M7UUFBWSxDQUFDLEVBQzFCO1VBQ0VnRCxXQUFXLEVBQUU7WUFDWEMsT0FBTyxFQUFFLEtBQUs7WUFDZEMsRUFBRSxFQUFFLElBQUFWLGNBQVEsRUFBQ0gsY0FBYztVQUM3QjtRQUNGLENBQUM7TUFFTDtJQUNGLENBQUM7SUFFRCxNQUFNYyxhQUFhLEdBQUcsSUFBSSxDQUFDbkMsR0FBRyxDQUFDb0MsVUFBVSxDQUFDLG9CQUFvQixFQUFFVCxRQUFRLENBQUM7SUFFekVGLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGVBQWUsRUFBRVMsYUFBYSxDQUFDbkIsUUFBUSxFQUFFLENBQUM7SUFFdEQsTUFBTXFCLE1BQU0sR0FBRyxJQUFJQyxVQUFVLENBQUMsQ0FDNUIsR0FBRyxJQUFJQSxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUN2QixHQUFHLElBQUlDLFdBQVcsRUFBRSxDQUFDQyxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQ3ZDLEdBQUdMLGFBQWEsQ0FBQ00sS0FBSyxFQUFFLENBQ3pCLENBQUM7SUFFRixNQUFNQyxzQkFBc0IsR0FBRyxJQUFBbEIsY0FBUSxFQUFDLElBQUksQ0FBQ3hCLEdBQUcsQ0FBQzJDLFFBQVEsQ0FBQ0MsSUFBSSxDQUFDUCxNQUFNLENBQUMsQ0FBQ1EsS0FBSyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUVwRixPQUFPSCxzQkFBc0I7RUFDL0IsQ0FBQztFQUVESSxRQUFRLEdBQUcsT0FBT0MsWUFBWSxFQUFFQyxPQUFPLEtBQUssSUFBSSxDQUFDaEQsR0FBRyxDQUFDaUQsRUFBRSxDQUFDQyxLQUFLLENBQUNKLFFBQVEsQ0FBQ0MsWUFBWSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQ0ksV0FBVyxDQUFDSCxPQUFPLENBQUM7RUFFbkhJLGVBQWUsR0FBRyxPQUFPbEQsT0FBTyxFQUFFbUQsU0FBUyxLQUFLLElBQUksQ0FBQ3JELEdBQUcsQ0FBQ2lELEVBQUUsQ0FBQ0MsS0FBSyxDQUFDQSxLQUFLLENBQUNoRCxPQUFPLEVBQUUsS0FBSyxFQUFFbUQsU0FBUyxDQUFDO0VBRWxHQyxVQUFVLEdBQUcsTUFBTy9DLE9BQU8sSUFBSztJQUM5QixPQUFPLElBQUlnRCxPQUFPLENBQUMsTUFBT0MsT0FBTyxJQUFLO01BQ3BDLE1BQU0sSUFBSSxDQUFDN0QsT0FBTyxDQUFDMkQsVUFBVSxDQUMzQi9DLE9BQU8sRUFDUCxHQUFHLEVBQ0gsSUFBSVcsV0FBRSxDQUFDLHdCQUF3QixDQUFDO01BQUU7TUFDbEMsR0FBRyxFQUNILElBQUlBLFdBQUUsQ0FBQyxlQUFlLENBQUM7TUFBRTtNQUN6QjtRQUNFdUMsY0FBYyxFQUFHQyxNQUFNLElBQUs7VUFDMUI7VUFDQWpDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDZ0MsTUFBTSxDQUFDO1FBQ3JCLENBQUM7UUFDREMsZUFBZSxFQUFHRCxNQUFNLElBQUs7VUFDM0I7VUFDQSxLQUFLLElBQUlFLEtBQUssR0FBRyxDQUFDLEVBQUVBLEtBQUssR0FBR0YsTUFBTSxDQUFDRyxNQUFNLEVBQUVELEtBQUssRUFBRSxFQUFFO1lBQzlDbkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsT0FBTyxFQUFFZ0MsTUFBTSxDQUFDRSxLQUFLLENBQUMsQ0FBQ0UsS0FBSyxDQUFDOUMsUUFBUSxFQUFFLENBQUM7WUFDcERTLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFNBQVMsRUFBRWdDLE1BQU0sQ0FBQ0UsS0FBSyxDQUFDLENBQUNHLE9BQU8sQ0FBQztZQUM3Q3RDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFFBQVEsRUFBRWdDLE1BQU0sQ0FBQ0UsS0FBSyxDQUFDLENBQUNJLE1BQU0sQ0FBQztZQUMzQ3ZDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGVBQWUsRUFBRWdDLE1BQU0sQ0FBQ0UsS0FBSyxDQUFDLENBQUNLLGlCQUFpQixDQUFDO1VBQ25FO1FBQ0Y7TUFDRixDQUFDLENBQ0Y7SUFDSCxDQUFDLENBQUM7RUFDSixDQUFDO0VBQ0RDLFFBQVEsR0FBRyxZQUFVO0lBQ25CLE9BQU8sSUFBSSxDQUFDdkUsT0FBTyxDQUFDdUUsUUFBUSxFQUFFO0VBQ2hDLENBQUM7QUFDSDtBQUFDO0FBQUMsZUFFYSxJQUFJMUUsYUFBYSxFQUFFO0FBQUEifQ==","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_PARA_ID","process","env","DECIMAL","MGX","KSM","TUR","MangataHelper","initialize","mangataEndpoint","mangata","Mangata","getInstance","mangataApi","getApi","api","checkFreeBalance","address","tokenBalance","getTokenBalance","free","getChainInfo","account","assets","getAssetsInfo","getAccountInfo","balances","getAssetFreeAmount","assetId","digits","asset","toString","div","BN","toNumber","getProxyAccount","decodedAddress","decodeAddress","decondedAddressHex","u8aToHex","console","log","location","parents","interior","X2","Parachain","AccountId32","network","id","multilocation","createType","toHash","Uint8Array","TextEncoder","encode","toU8a","DescendOriginAddress32","registry","hash","slice","addProxy","proxyAccount","keyPair","tx","proxy","signAndSend","createProxyCall","extrinsic","createPool","Promise","resolve","statusCallback","result","extrinsicStatus","index","length","phase","section","method","metaDocumentation","getPools"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/","sources":["mangataHelper.js"],"sourcesContent":["import { Mangata } from '@mangata-finance/sdk';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { decodeAddress } from '@polkadot/util-crypto';\nimport BN from 'bn.js';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGX: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\nclass MangataHelper {\n  initialize = async (mangataEndpoint) => {\n    const mangata = Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n\n    this.mangata = mangata;\n    this.api = mangataApi;\n\n\n  }\n\n  getApi = () => this.api;\n\n  checkFreeBalance = async (address) => {\n    const tokenBalance = await this.mangata.getTokenBalance('0', address);\n    return tokenBalance.free;\n  }\n\n  getChainInfo = async (account) => {\n        // 2. Read chain asssets\n    const assets = await this.mangata.getAssetsInfo();\n    return assets;\n  }\n\n  getAccountInfo = async (address) => {\n    const balances = {};\n    balances.MGX = await this.getAssetFreeAmount(0, address, DECIMAL.MGX);\n    balances.KSM = await this.getAssetFreeAmount(4, address, DECIMAL.KSM);\n    balances.TUR = await this.getAssetFreeAmount(7, address, DECIMAL.TUR);\n    // balances['KSM-MGX'] = await this.mangata.getTokenBalance('5', account.address);\n    return balances;\n  }\n\n  getAssetFreeAmount = async (assetId, address, digits )=>{\n    const asset = await this.mangata.getTokenBalance(assetId.toString(), address);\n    return asset.free.div(new BN(digits)).toNumber();\n  } \n\n  getProxyAccount = (address) => {\n    const decodedAddress = decodeAddress(address);\n    const decondedAddressHex = u8aToHex(decodedAddress); // a SS58 public key\n    console.log(\"decondedAddressHex\", decondedAddressHex);\n    \n    const location = {\n      parents: 1, // From Turing to Mangata\n      interior: {\n        X2: [\n          { Parachain: TURING_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: u8aToHex(decodedAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    console.log(\"multilocation\", multilocation.toString());\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const DescendOriginAddress32 = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n\n    return DescendOriginAddress32;\n  }\n\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n\n  createPool = async (account) => {\n    return new Promise(async (resolve) => {\n      await this.mangata.createPool(\n        account,\n        '0',\n        new BN('1000000000000000000000'), // 1000 MGX (MGX is 18 decimals)\n        '7',\n        new BN('1000000000000'), // 1 TUR (TUR is 12 decimals)\n        {\n          statusCallback: (result) => {\n            // result is of the form ISubmittableResult\n            console.log(result);\n          },\n          extrinsicStatus: (result) => {\n            // result is of the form MangataGenericEvent[]\n            for (let index = 0; index < result.length; index++) {\n                  console.log('Phase', result[index].phase.toString())\n                  console.log('Section', result[index].section)\n                  console.log('Method', result[index].method)\n                  console.log('Documentation', result[index].metaDocumentation)\n            }\n          },\n        }\n      );\n    });\n  }\n  getPools = async() =>{\n    return this.mangata.getPools();\n  }\n};\n\nexport default new MangataHelper();"],"mappings":"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"}},"mtime":1668795161468},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sendExtrinsic = void 0;\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst sendExtrinsic = async (api, extrinsic, keyPair, {\n  isSudo = false\n} = {}) => {\n  return new Promise(async resolve => {\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n    const unsub = await newExtrinsic.signAndSend(keyPair, {\n      nonce: -1\n    }, ({\n      status,\n      dispatchError\n    }) => {\n      if (status.type === 'Finalized') {\n        console.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n        if (!_lodash.default.isNil(dispatchError)) {\n          if (dispatchError.isModule) {\n            const metaError = api.registry.findMetaError(dispatchError.asModule);\n            const {\n              docs,\n              name,\n              section\n            } = metaError;\n            const dispatchErrorMessage = JSON.stringify({\n              docs,\n              name,\n              section\n            });\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`;\n            console.log(errMsg);\n          } else {\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`;\n            console.log(errMsg);\n          }\n        }\n        unsub();\n        resolve(status.asFinalized.toString());\n      }\n    });\n  });\n};\nexports.sendExtrinsic = sendExtrinsic;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kRXh0cmluc2ljIiwiYXBpIiwiZXh0cmluc2ljIiwia2V5UGFpciIsImlzU3VkbyIsIlByb21pc2UiLCJyZXNvbHZlIiwibmV3RXh0cmluc2ljIiwidHgiLCJzdWRvIiwidW5zdWIiLCJzaWduQW5kU2VuZCIsIm5vbmNlIiwic3RhdHVzIiwiZGlzcGF0Y2hFcnJvciIsInR5cGUiLCJjb25zb2xlIiwibG9nIiwiYXNGaW5hbGl6ZWQiLCJ0b1N0cmluZyIsIl8iLCJpc05pbCIsImlzTW9kdWxlIiwibWV0YUVycm9yIiwicmVnaXN0cnkiLCJmaW5kTWV0YUVycm9yIiwiYXNNb2R1bGUiLCJkb2NzIiwibmFtZSIsInNlY3Rpb24iLCJkaXNwYXRjaEVycm9yTWVzc2FnZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJNc2ciXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby94Y21wX2F1dG9tYXRpb24vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBjb25zdCBzZW5kRXh0cmluc2ljID0gYXN5bmMgKGFwaSwgZXh0cmluc2ljLCBrZXlQYWlyLCB7IGlzU3VkbyA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcblxuICAgIGNvbnN0IG5ld0V4dHJpbnNpYyA9IGlzU3VkbyA/IGFwaS50eC5zdWRvLnN1ZG8oZXh0cmluc2ljKSA6IGV4dHJpbnNpYztcblx0XHRjb25zdCB1bnN1YiA9IGF3YWl0IG5ld0V4dHJpbnNpYy5zaWduQW5kU2VuZChrZXlQYWlyLCB7IG5vbmNlOiAtMSB9LCAoeyBzdGF0dXMsIGRpc3BhdGNoRXJyb3IgfSkgPT4ge1xuXHRcdFx0aWYgKHN0YXR1cy50eXBlID09PSAnRmluYWxpemVkJykge1xuICAgICAgICBjb25zb2xlLmxvZygnRmluYWxpemUgZXh0cmluc2ljIGluIGJsb2NrOiAnLCBzdGF0dXMuYXNGaW5hbGl6ZWQudG9TdHJpbmcoKSk7XG5cblx0XHRcdFx0aWYgKCFfLmlzTmlsKGRpc3BhdGNoRXJyb3IpKSB7XG5cdFx0XHRcdFx0aWYgKGRpc3BhdGNoRXJyb3IuaXNNb2R1bGUpIHtcblx0XHRcdFx0XHRcdGNvbnN0IG1ldGFFcnJvciA9IGFwaS5yZWdpc3RyeS5maW5kTWV0YUVycm9yKGRpc3BhdGNoRXJyb3IuYXNNb2R1bGUpXG5cdFx0XHRcdFx0XHRjb25zdCB7IGRvY3MsIG5hbWUsIHNlY3Rpb24gfSA9IG1ldGFFcnJvclxuXHRcdFx0XHRcdFx0Y29uc3QgZGlzcGF0Y2hFcnJvck1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7IGRvY3MsIG5hbWUsIHNlY3Rpb24gfSlcblx0XHRcdFx0XHRcdGNvbnN0IGVyck1zZyA9IGBUcmFuc2FjdGlvbiBmaW5hbGl6ZWQgd2l0aCBlcnJvciBieSBibG9ja2NoYWluICR7ZGlzcGF0Y2hFcnJvck1lc3NhZ2V9YFxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyTXNnKVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zdCBlcnJNc2cgPSBgVHJhbnNhY3Rpb24gZmluYWxpemVkIHdpdGggZXJyb3IgYnkgYmxvY2tjaGFpbiAke2Rpc3BhdGNoRXJyb3IudG9TdHJpbmcoKX1gXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnJNc2cpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dW5zdWIoKTtcblx0XHRcdFx0cmVzb2x2ZShzdGF0dXMuYXNGaW5hbGl6ZWQudG9TdHJpbmcoKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFBdUI7QUFFaEIsTUFBTUEsYUFBYSxHQUFHLE9BQU9DLEdBQUcsRUFBRUMsU0FBUyxFQUFFQyxPQUFPLEVBQUU7RUFBRUMsTUFBTSxHQUFHO0FBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLO0VBQ3hGLE9BQU8sSUFBSUMsT0FBTyxDQUFDLE1BQU9DLE9BQU8sSUFBSztJQUVuQyxNQUFNQyxZQUFZLEdBQUdILE1BQU0sR0FBR0gsR0FBRyxDQUFDTyxFQUFFLENBQUNDLElBQUksQ0FBQ0EsSUFBSSxDQUFDUCxTQUFTLENBQUMsR0FBR0EsU0FBUztJQUN2RSxNQUFNUSxLQUFLLEdBQUcsTUFBTUgsWUFBWSxDQUFDSSxXQUFXLENBQUNSLE9BQU8sRUFBRTtNQUFFUyxLQUFLLEVBQUUsQ0FBQztJQUFFLENBQUMsRUFBRSxDQUFDO01BQUVDLE1BQU07TUFBRUM7SUFBYyxDQUFDLEtBQUs7TUFDbkcsSUFBSUQsTUFBTSxDQUFDRSxJQUFJLEtBQUssV0FBVyxFQUFFO1FBQzVCQyxPQUFPLENBQUNDLEdBQUcsQ0FBQywrQkFBK0IsRUFBRUosTUFBTSxDQUFDSyxXQUFXLENBQUNDLFFBQVEsRUFBRSxDQUFDO1FBRS9FLElBQUksQ0FBQ0MsZUFBQyxDQUFDQyxLQUFLLENBQUNQLGFBQWEsQ0FBQyxFQUFFO1VBQzVCLElBQUlBLGFBQWEsQ0FBQ1EsUUFBUSxFQUFFO1lBQzNCLE1BQU1DLFNBQVMsR0FBR3RCLEdBQUcsQ0FBQ3VCLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDWCxhQUFhLENBQUNZLFFBQVEsQ0FBQztZQUNwRSxNQUFNO2NBQUVDLElBQUk7Y0FBRUMsSUFBSTtjQUFFQztZQUFRLENBQUMsR0FBR04sU0FBUztZQUN6QyxNQUFNTyxvQkFBb0IsR0FBR0MsSUFBSSxDQUFDQyxTQUFTLENBQUM7Y0FBRUwsSUFBSTtjQUFFQyxJQUFJO2NBQUVDO1lBQVEsQ0FBQyxDQUFDO1lBQ3BFLE1BQU1JLE1BQU0sR0FBSSxrREFBaURILG9CQUFxQixFQUFDO1lBQ3ZGZCxPQUFPLENBQUNDLEdBQUcsQ0FBQ2dCLE1BQU0sQ0FBQztVQUNwQixDQUFDLE1BQU07WUFDTixNQUFNQSxNQUFNLEdBQUksa0RBQWlEbkIsYUFBYSxDQUFDSyxRQUFRLEVBQUcsRUFBQztZQUMzRkgsT0FBTyxDQUFDQyxHQUFHLENBQUNnQixNQUFNLENBQUM7VUFDcEI7UUFDRDtRQUVBdkIsS0FBSyxFQUFFO1FBQ1BKLE9BQU8sQ0FBQ08sTUFBTSxDQUFDSyxXQUFXLENBQUNDLFFBQVEsRUFBRSxDQUFDO01BQ3ZDO0lBQ0QsQ0FBQyxDQUFDO0VBQ0gsQ0FBQyxDQUFDO0FBQ0gsQ0FBQztBQUFBIn0=","map":{"version":3,"names":["sendExtrinsic","api","extrinsic","keyPair","isSudo","Promise","resolve","newExtrinsic","tx","sudo","unsub","signAndSend","nonce","status","dispatchError","type","console","log","asFinalized","toString","_","isNil","isModule","metaError","registry","findMetaError","asModule","docs","name","section","dispatchErrorMessage","JSON","stringify","errMsg"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/","sources":["utils.js"],"sourcesContent":["import _ from 'lodash';\n\nexport const sendExtrinsic = async (api, extrinsic, keyPair, { isSudo = false } = {}) => {\n\treturn new Promise(async (resolve) => {\n\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n\t\tconst unsub = await newExtrinsic.signAndSend(keyPair, { nonce: -1 }, ({ status, dispatchError }) => {\n\t\t\tif (status.type === 'Finalized') {\n        console.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n\n\t\t\t\tif (!_.isNil(dispatchError)) {\n\t\t\t\t\tif (dispatchError.isModule) {\n\t\t\t\t\t\tconst metaError = api.registry.findMetaError(dispatchError.asModule)\n\t\t\t\t\t\tconst { docs, name, section } = metaError\n\t\t\t\t\t\tconst dispatchErrorMessage = JSON.stringify({ docs, name, section })\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tunsub();\n\t\t\t\tresolve(status.asFinalized.toString());\n\t\t\t}\n\t\t});\n\t});\n}"],"mappings":";;;;;;AAAA;AAAuB;AAEhB,MAAMA,aAAa,GAAG,OAAOC,GAAG,EAAEC,SAAS,EAAEC,OAAO,EAAE;EAAEC,MAAM,GAAG;AAAM,CAAC,GAAG,CAAC,CAAC,KAAK;EACxF,OAAO,IAAIC,OAAO,CAAC,MAAOC,OAAO,IAAK;IAEnC,MAAMC,YAAY,GAAGH,MAAM,GAAGH,GAAG,CAACO,EAAE,CAACC,IAAI,CAACA,IAAI,CAACP,SAAS,CAAC,GAAGA,SAAS;IACvE,MAAMQ,KAAK,GAAG,MAAMH,YAAY,CAACI,WAAW,CAACR,OAAO,EAAE;MAAES,KAAK,EAAE,CAAC;IAAE,CAAC,EAAE,CAAC;MAAEC,MAAM;MAAEC;IAAc,CAAC,KAAK;MACnG,IAAID,MAAM,CAACE,IAAI,KAAK,WAAW,EAAE;QAC5BC,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEJ,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;QAE/E,IAAI,CAACC,eAAC,CAACC,KAAK,CAACP,aAAa,CAAC,EAAE;UAC5B,IAAIA,aAAa,CAACQ,QAAQ,EAAE;YAC3B,MAAMC,SAAS,GAAGtB,GAAG,CAACuB,QAAQ,CAACC,aAAa,CAACX,aAAa,CAACY,QAAQ,CAAC;YACpE,MAAM;cAAEC,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,GAAGN,SAAS;YACzC,MAAMO,oBAAoB,GAAGC,IAAI,CAACC,SAAS,CAAC;cAAEL,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,CAAC;YACpE,MAAMI,MAAM,GAAI,kDAAiDH,oBAAqB,EAAC;YACvFd,OAAO,CAACC,GAAG,CAACgB,MAAM,CAAC;UACpB,CAAC,MAAM;YACN,MAAMA,MAAM,GAAI,kDAAiDnB,aAAa,CAACK,QAAQ,EAAG,EAAC;YAC3FH,OAAO,CAACC,GAAG,CAACgB,MAAM,CAAC;UACpB;QACD;QAEAvB,KAAK,EAAE;QACPJ,OAAO,CAACO,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;MACvC;IACD,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAAA"}},"mtime":1668808911630},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"filename\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo/xcmp_automation\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sendExtrinsic = void 0;\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst sendExtrinsic = async (api, extrinsic, keyPair, {\n  isSudo = false\n} = {}) => {\n  return new Promise(async resolve => {\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n    const unsub = await newExtrinsic.signAndSend(keyPair, {\n      nonce: -1\n    }, ({\n      status,\n      dispatchError\n    }) => {\n      if (status.type === 'Finalized') {\n        console.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n        if (!_lodash.default.isNil(dispatchError)) {\n          if (dispatchError.isModule) {\n            const metaError = api.registry.findMetaError(dispatchError.asModule);\n            const {\n              docs,\n              name,\n              section\n            } = metaError;\n            const dispatchErrorMessage = JSON.stringify({\n              docs,\n              name,\n              section\n            });\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`;\n            console.log(errMsg);\n          } else {\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`;\n            console.log(errMsg);\n          }\n        }\n        unsub();\n        resolve(status.asFinalized.toString());\n      }\n    });\n  });\n};\nexports.sendExtrinsic = sendExtrinsic;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kRXh0cmluc2ljIiwiYXBpIiwiZXh0cmluc2ljIiwia2V5UGFpciIsImlzU3VkbyIsIlByb21pc2UiLCJyZXNvbHZlIiwibmV3RXh0cmluc2ljIiwidHgiLCJzdWRvIiwidW5zdWIiLCJzaWduQW5kU2VuZCIsIm5vbmNlIiwic3RhdHVzIiwiZGlzcGF0Y2hFcnJvciIsInR5cGUiLCJjb25zb2xlIiwibG9nIiwiYXNGaW5hbGl6ZWQiLCJ0b1N0cmluZyIsIl8iLCJpc05pbCIsImlzTW9kdWxlIiwibWV0YUVycm9yIiwicmVnaXN0cnkiLCJmaW5kTWV0YUVycm9yIiwiYXNNb2R1bGUiLCJkb2NzIiwibmFtZSIsInNlY3Rpb24iLCJkaXNwYXRjaEVycm9yTWVzc2FnZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJNc2ciXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby94Y21wX2F1dG9tYXRpb24vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBjb25zdCBzZW5kRXh0cmluc2ljID0gYXN5bmMgKGFwaSwgZXh0cmluc2ljLCBrZXlQYWlyLCB7IGlzU3VkbyA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcblxuICAgIGNvbnN0IG5ld0V4dHJpbnNpYyA9IGlzU3VkbyA/IGFwaS50eC5zdWRvLnN1ZG8oZXh0cmluc2ljKSA6IGV4dHJpbnNpYztcblx0XHRjb25zdCB1bnN1YiA9IGF3YWl0IG5ld0V4dHJpbnNpYy5zaWduQW5kU2VuZChrZXlQYWlyLCB7IG5vbmNlOiAtMSB9LCAoeyBzdGF0dXMsIGRpc3BhdGNoRXJyb3IgfSkgPT4ge1xuXHRcdFx0aWYgKHN0YXR1cy50eXBlID09PSAnRmluYWxpemVkJykge1xuICAgICAgICBjb25zb2xlLmxvZygnRmluYWxpemUgZXh0cmluc2ljIGluIGJsb2NrOiAnLCBzdGF0dXMuYXNGaW5hbGl6ZWQudG9TdHJpbmcoKSk7XG5cblx0XHRcdFx0aWYgKCFfLmlzTmlsKGRpc3BhdGNoRXJyb3IpKSB7XG5cdFx0XHRcdFx0aWYgKGRpc3BhdGNoRXJyb3IuaXNNb2R1bGUpIHtcblx0XHRcdFx0XHRcdGNvbnN0IG1ldGFFcnJvciA9IGFwaS5yZWdpc3RyeS5maW5kTWV0YUVycm9yKGRpc3BhdGNoRXJyb3IuYXNNb2R1bGUpXG5cdFx0XHRcdFx0XHRjb25zdCB7IGRvY3MsIG5hbWUsIHNlY3Rpb24gfSA9IG1ldGFFcnJvclxuXHRcdFx0XHRcdFx0Y29uc3QgZGlzcGF0Y2hFcnJvck1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7IGRvY3MsIG5hbWUsIHNlY3Rpb24gfSlcblx0XHRcdFx0XHRcdGNvbnN0IGVyck1zZyA9IGBUcmFuc2FjdGlvbiBmaW5hbGl6ZWQgd2l0aCBlcnJvciBieSBibG9ja2NoYWluICR7ZGlzcGF0Y2hFcnJvck1lc3NhZ2V9YFxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyTXNnKVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zdCBlcnJNc2cgPSBgVHJhbnNhY3Rpb24gZmluYWxpemVkIHdpdGggZXJyb3IgYnkgYmxvY2tjaGFpbiAke2Rpc3BhdGNoRXJyb3IudG9TdHJpbmcoKX1gXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnJNc2cpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dW5zdWIoKTtcblx0XHRcdFx0cmVzb2x2ZShzdGF0dXMuYXNGaW5hbGl6ZWQudG9TdHJpbmcoKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFBdUI7QUFFaEIsTUFBTUEsYUFBYSxHQUFHLE9BQU9DLEdBQUcsRUFBRUMsU0FBUyxFQUFFQyxPQUFPLEVBQUU7RUFBRUMsTUFBTSxHQUFHO0FBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLO0VBQ3hGLE9BQU8sSUFBSUMsT0FBTyxDQUFDLE1BQU9DLE9BQU8sSUFBSztJQUVuQyxNQUFNQyxZQUFZLEdBQUdILE1BQU0sR0FBR0gsR0FBRyxDQUFDTyxFQUFFLENBQUNDLElBQUksQ0FBQ0EsSUFBSSxDQUFDUCxTQUFTLENBQUMsR0FBR0EsU0FBUztJQUN2RSxNQUFNUSxLQUFLLEdBQUcsTUFBTUgsWUFBWSxDQUFDSSxXQUFXLENBQUNSLE9BQU8sRUFBRTtNQUFFUyxLQUFLLEVBQUUsQ0FBQztJQUFFLENBQUMsRUFBRSxDQUFDO01BQUVDLE1BQU07TUFBRUM7SUFBYyxDQUFDLEtBQUs7TUFDbkcsSUFBSUQsTUFBTSxDQUFDRSxJQUFJLEtBQUssV0FBVyxFQUFFO1FBQzVCQyxPQUFPLENBQUNDLEdBQUcsQ0FBQywrQkFBK0IsRUFBRUosTUFBTSxDQUFDSyxXQUFXLENBQUNDLFFBQVEsRUFBRSxDQUFDO1FBRS9FLElBQUksQ0FBQ0MsZUFBQyxDQUFDQyxLQUFLLENBQUNQLGFBQWEsQ0FBQyxFQUFFO1VBQzVCLElBQUlBLGFBQWEsQ0FBQ1EsUUFBUSxFQUFFO1lBQzNCLE1BQU1DLFNBQVMsR0FBR3RCLEdBQUcsQ0FBQ3VCLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDWCxhQUFhLENBQUNZLFFBQVEsQ0FBQztZQUNwRSxNQUFNO2NBQUVDLElBQUk7Y0FBRUMsSUFBSTtjQUFFQztZQUFRLENBQUMsR0FBR04sU0FBUztZQUN6QyxNQUFNTyxvQkFBb0IsR0FBR0MsSUFBSSxDQUFDQyxTQUFTLENBQUM7Y0FBRUwsSUFBSTtjQUFFQyxJQUFJO2NBQUVDO1lBQVEsQ0FBQyxDQUFDO1lBQ3BFLE1BQU1JLE1BQU0sR0FBSSxrREFBaURILG9CQUFxQixFQUFDO1lBQ3ZGZCxPQUFPLENBQUNDLEdBQUcsQ0FBQ2dCLE1BQU0sQ0FBQztVQUNwQixDQUFDLE1BQU07WUFDTixNQUFNQSxNQUFNLEdBQUksa0RBQWlEbkIsYUFBYSxDQUFDSyxRQUFRLEVBQUcsRUFBQztZQUMzRkgsT0FBTyxDQUFDQyxHQUFHLENBQUNnQixNQUFNLENBQUM7VUFDcEI7UUFDRDtRQUVBdkIsS0FBSyxFQUFFO1FBQ1BKLE9BQU8sQ0FBQ08sTUFBTSxDQUFDSyxXQUFXLENBQUNDLFFBQVEsRUFBRSxDQUFDO01BQ3ZDO0lBQ0QsQ0FBQyxDQUFDO0VBQ0gsQ0FBQyxDQUFDO0FBQ0gsQ0FBQztBQUFBIn0=","map":{"version":3,"names":["sendExtrinsic","api","extrinsic","keyPair","isSudo","Promise","resolve","newExtrinsic","tx","sudo","unsub","signAndSend","nonce","status","dispatchError","type","console","log","asFinalized","toString","_","isNil","isModule","metaError","registry","findMetaError","asModule","docs","name","section","dispatchErrorMessage","JSON","stringify","errMsg"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/xcmp_automation/src/common/","sources":["utils.js"],"sourcesContent":["import _ from 'lodash';\n\nexport const sendExtrinsic = async (api, extrinsic, keyPair, { isSudo = false } = {}) => {\n\treturn new Promise(async (resolve) => {\n\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n\t\tconst unsub = await newExtrinsic.signAndSend(keyPair, { nonce: -1 }, ({ status, dispatchError }) => {\n\t\t\tif (status.type === 'Finalized') {\n        console.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n\n\t\t\t\tif (!_.isNil(dispatchError)) {\n\t\t\t\t\tif (dispatchError.isModule) {\n\t\t\t\t\t\tconst metaError = api.registry.findMetaError(dispatchError.asModule)\n\t\t\t\t\t\tconst { docs, name, section } = metaError\n\t\t\t\t\t\tconst dispatchErrorMessage = JSON.stringify({ docs, name, section })\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tunsub();\n\t\t\t\tresolve(status.asFinalized.toString());\n\t\t\t}\n\t\t});\n\t});\n}"],"mappings":";;;;;;AAAA;AAAuB;AAEhB,MAAMA,aAAa,GAAG,OAAOC,GAAG,EAAEC,SAAS,EAAEC,OAAO,EAAE;EAAEC,MAAM,GAAG;AAAM,CAAC,GAAG,CAAC,CAAC,KAAK;EACxF,OAAO,IAAIC,OAAO,CAAC,MAAOC,OAAO,IAAK;IAEnC,MAAMC,YAAY,GAAGH,MAAM,GAAGH,GAAG,CAACO,EAAE,CAACC,IAAI,CAACA,IAAI,CAACP,SAAS,CAAC,GAAGA,SAAS;IACvE,MAAMQ,KAAK,GAAG,MAAMH,YAAY,CAACI,WAAW,CAACR,OAAO,EAAE;MAAES,KAAK,EAAE,CAAC;IAAE,CAAC,EAAE,CAAC;MAAEC,MAAM;MAAEC;IAAc,CAAC,KAAK;MACnG,IAAID,MAAM,CAACE,IAAI,KAAK,WAAW,EAAE;QAC5BC,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEJ,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;QAE/E,IAAI,CAACC,eAAC,CAACC,KAAK,CAACP,aAAa,CAAC,EAAE;UAC5B,IAAIA,aAAa,CAACQ,QAAQ,EAAE;YAC3B,MAAMC,SAAS,GAAGtB,GAAG,CAACuB,QAAQ,CAACC,aAAa,CAACX,aAAa,CAACY,QAAQ,CAAC;YACpE,MAAM;cAAEC,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,GAAGN,SAAS;YACzC,MAAMO,oBAAoB,GAAGC,IAAI,CAACC,SAAS,CAAC;cAAEL,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,CAAC;YACpE,MAAMI,MAAM,GAAI,kDAAiDH,oBAAqB,EAAC;YACvFd,OAAO,CAACC,GAAG,CAACgB,MAAM,CAAC;UACpB,CAAC,MAAM;YACN,MAAMA,MAAM,GAAI,kDAAiDnB,aAAa,CAACK,QAAQ,EAAG,EAAC;YAC3FH,OAAO,CAACC,GAAG,CAACgB,MAAM,CAAC;UACpB;QACD;QAEAvB,KAAK,EAAE;QACPJ,OAAO,CAACO,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;MACvC;IACD,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAAA"}},"mtime":1668808911630},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/setup.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nrequire(\"@imstar15/api-augment\");\nvar _api = require(\"@polkadot/api\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _turingHelper = _interopRequireDefault(require(\"./common/turingHelper\"));\nvar _mangataHelper = _interopRequireDefault(require(\"./common/mangataHelper\"));\nvar _account = _interopRequireDefault(require(\"./common/account\"));\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _utils = require(\"./common/utils\");\nvar _constants = require(\"./common/constants\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst SUBSTRATE_SS58 = 42;\nconst TURING_SS58 = 51;\nconst MANGATA_SS58 = 42;\nconst TURING_PARA_ID = process.env.TURING_PARA_ID;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst TURING_ENDPOINT = process.env.TURING_ENDPOINT;\nconst MANGATA_ENDPOINT = process.env.MANGATA_ENDPOINT;\n\n// const OAK_SOV_ACCOUNT = \"68kxzikS2WZNkYSPWdYouqH5sEZujecVCy3TFt9xHWB5MDG5\";\nconst keyring = new _api.Keyring();\n\n/*** Main entrance of the program */\n(async function main() {\n  await (0, _utilCrypto.cryptoWaitReady)();\n  console.log(\"Initializing APIs of both chains ...\");\n  await _turingHelper.default.initialize(TURING_ENDPOINT);\n  await _mangataHelper.default.initialize(MANGATA_ENDPOINT);\n  console.log(\"Reading token and balance of Alice and Bob accounts ...\");\n  const alice = new _account.default(\"Alice\");\n  await alice.init();\n  alice.print();\n  console.log(\"Minting tokens for Alice on Maganta if balance is zero ...\");\n  const mangataAddress = alice.assets[1].address;\n  const promises = _lodash.default.map(alice.assets[1].tokens, token => {\n    const {\n      symbol,\n      balance\n    } = token;\n    if (balance.isZero()) {\n      console.log(`[Alice] ${symbol} balance on Mangata is zero; minting ${symbol} with sudo ...`);\n      return _mangataHelper.default.mintToken(mangataAddress, symbol, alice.keyring);\n    } else {\n      return Promise.resolve();\n    }\n  });\n  await Promise.all(promises);\n\n  // Create pool\n  const pools = await _mangataHelper.default.getPools();\n  console.log('Pools: ', pools);\n  const existingPool = _lodash.default.find(pools, pool => {\n    return pool.firstTokenId === _mangataHelper.default.getTokenIdBySymbol(\"MGR\") && pool.secondTokenId === _mangataHelper.default.getTokenIdBySymbol(\"TUR\");\n  });\n  if (_lodash.default.isUndefined(existingPool)) {\n    console.log(`No MGR-TUR pool found; creating a MGR-TUR pool with Alice ...`);\n    await _mangataHelper.default.createPool(\"MGR\", \"TUR\", alice.keyring);\n  } else {\n    console.log(`An existing MGR-TUR pool found; skip pool creation ...`);\n  }\n\n  // Promote pool\n  console.log('Promote pool...');\n  const promotePoolExtrinsic = _mangataHelper.default.api.tx.xyk.promotePool(pools[0].liquidityTokenId);\n  await (0, _utils.sendExtrinsic)(_mangataHelper.default.api, promotePoolExtrinsic, alice.keyring, {\n    isSudo: true\n  });\n\n  // Buy asset\n  console.log('Buy asset...');\n  await _mangataHelper.default.mangata.buyAsset(alice.keyring, '0', '7', new _bn.default('1000000000000'), new _bn.default('100000000000000000000000000'));\n\n  // '8': {\n  //     id: '8',\n  //     chainId: 0,\n  //     decimals: 18,\n  //     name: 'Liquidity Pool Token',\n  //     symbol: 'MGR-TUR',\n  //     address: ''\n  //   }\n\n  // await mangataHelper.mangata.transferToken(\n  //     account, \n  //     '4', // TokenID 4 is KSM\n  //     account.address, \n  //     new BN(100000000000000), // 100 KSM (KSM is 12 decimals)\n  //     {\n  //         statusCallback: (result) => {\n  //           // result is of the form ISubmittableResult\n  //           console.log(result)\n  //         },\n  //         extrinsicStatus: (result) => {\n  //           // result is of the form MangataGenericEvent[]\n  //           for (let index = 0; index < result.length; index++) {\n  //               console.log('Phase', result[index].phase.toString())\n  //               console.log('Section', result[index].section)\n  //               console.log('Method', result[index].method)\n  //               console.log('Documentation', result[index].metaDocumentation)\n  //             }\n  //         },\n  //       }\n  // )\n\n  //   const proxyAccount = mangataHelper.getProxyAddressMangata(keyPair.address);\n  //   console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n  //   mangataHelper.addProxy(proxyAccount, keyPair);\n  //   console.log('Add proxy on mangata successfully!');\n\n  const message = \"empty\";\n  //   await turingHelper.xcmSend(dest, message);\n})();\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTVUJTVFJBVEVfU1M1OCIsIlRVUklOR19TUzU4IiwiTUFOR0FUQV9TUzU4IiwiVFVSSU5HX1BBUkFfSUQiLCJwcm9jZXNzIiwiZW52IiwiTUFOR0FUQV9QQVJBX0lEIiwiVFVSSU5HX0VORFBPSU5UIiwiTUFOR0FUQV9FTkRQT0lOVCIsImtleXJpbmciLCJLZXlyaW5nIiwibWFpbiIsImNyeXB0b1dhaXRSZWFkeSIsImNvbnNvbGUiLCJsb2ciLCJ0dXJpbmdIZWxwZXIiLCJpbml0aWFsaXplIiwibWFuZ2F0YUhlbHBlciIsImFsaWNlIiwiQWNjb3VudCIsImluaXQiLCJwcmludCIsIm1hbmdhdGFBZGRyZXNzIiwiYXNzZXRzIiwiYWRkcmVzcyIsInByb21pc2VzIiwiXyIsIm1hcCIsInRva2VucyIsInRva2VuIiwic3ltYm9sIiwiYmFsYW5jZSIsImlzWmVybyIsIm1pbnRUb2tlbiIsIlByb21pc2UiLCJyZXNvbHZlIiwiYWxsIiwicG9vbHMiLCJnZXRQb29scyIsImV4aXN0aW5nUG9vbCIsImZpbmQiLCJwb29sIiwiZmlyc3RUb2tlbklkIiwiZ2V0VG9rZW5JZEJ5U3ltYm9sIiwic2Vjb25kVG9rZW5JZCIsImlzVW5kZWZpbmVkIiwiY3JlYXRlUG9vbCIsInByb21vdGVQb29sRXh0cmluc2ljIiwiYXBpIiwidHgiLCJ4eWsiLCJwcm9tb3RlUG9vbCIsImxpcXVpZGl0eVRva2VuSWQiLCJzZW5kRXh0cmluc2ljIiwiaXNTdWRvIiwibWFuZ2F0YSIsImJ1eUFzc2V0IiwiQk4iLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbWlrYXNhL0NvZGUveGNtLWRlbW8vc3JjLyIsInNvdXJjZXMiOlsic2V0dXAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwiQGltc3RhcjE1L2FwaS1hdWdtZW50XCI7XG5pbXBvcnQgeyBLZXlyaW5nIH0gZnJvbSBcIkBwb2xrYWRvdC9hcGlcIjtcbmltcG9ydCB7IGNyeXB0b1dhaXRSZWFkeSB9IGZyb20gJ0Bwb2xrYWRvdC91dGlsLWNyeXB0byc7XG5pbXBvcnQgdHVyaW5nSGVscGVyIGZyb20gXCIuL2NvbW1vbi90dXJpbmdIZWxwZXJcIjtcbmltcG9ydCBtYW5nYXRhSGVscGVyIGZyb20gXCIuL2NvbW1vbi9tYW5nYXRhSGVscGVyXCI7XG5pbXBvcnQgQWNjb3VudCBmcm9tICcuL2NvbW1vbi9hY2NvdW50JztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgQk4gZnJvbSAnYm4uanMnO1xuaW1wb3J0IHsgTWFuZ2F0YSB9IGZyb20gXCJAbWFuZ2F0YS1maW5hbmNlL3Nka1wiO1xuaW1wb3J0IHsgc2VuZEV4dHJpbnNpYyB9IGZyb20gXCIuL2NvbW1vbi91dGlsc1wiO1xuaW1wb3J0IHtjaGFpbkNvbmZpZ30gZnJvbSAnLi9jb21tb24vY29uc3RhbnRzJztcblxuY29uc3QgU1VCU1RSQVRFX1NTNTggPSA0MjtcbmNvbnN0IFRVUklOR19TUzU4ID0gNTE7XG5jb25zdCBNQU5HQVRBX1NTNTggPSA0MjtcbmNvbnN0IFRVUklOR19QQVJBX0lEID0gcHJvY2Vzcy5lbnYuVFVSSU5HX1BBUkFfSUQ7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5jb25zdCBUVVJJTkdfRU5EUE9JTlQgPSBwcm9jZXNzLmVudi5UVVJJTkdfRU5EUE9JTlQ7XG5jb25zdCBNQU5HQVRBX0VORFBPSU5UID0gcHJvY2Vzcy5lbnYuTUFOR0FUQV9FTkRQT0lOVDtcblxuLy8gY29uc3QgT0FLX1NPVl9BQ0NPVU5UID0gXCI2OGt4emlrUzJXWk5rWVNQV2RZb3VxSDVzRVp1amVjVkN5M1RGdDl4SFdCNU1ERzVcIjtcbmNvbnN0IGtleXJpbmcgPSBuZXcgS2V5cmluZygpO1xuXG4vKioqIE1haW4gZW50cmFuY2Ugb2YgdGhlIHByb2dyYW0gKi9cbihhc3luYyBmdW5jdGlvbiBtYWluICgpIHtcbiAgYXdhaXQgY3J5cHRvV2FpdFJlYWR5KCk7XG5cbiAgICBjb25zb2xlLmxvZyhcIkluaXRpYWxpemluZyBBUElzIG9mIGJvdGggY2hhaW5zIC4uLlwiKTtcbiAgICBhd2FpdCB0dXJpbmdIZWxwZXIuaW5pdGlhbGl6ZShUVVJJTkdfRU5EUE9JTlQpO1xuICAgIGF3YWl0IG1hbmdhdGFIZWxwZXIuaW5pdGlhbGl6ZShNQU5HQVRBX0VORFBPSU5UKTtcblxuICBjb25zb2xlLmxvZyhcIlJlYWRpbmcgdG9rZW4gYW5kIGJhbGFuY2Ugb2YgQWxpY2UgYW5kIEJvYiBhY2NvdW50cyAuLi5cIik7XG4gIGNvbnN0IGFsaWNlID0gbmV3IEFjY291bnQoXCJBbGljZVwiKTtcbiAgYXdhaXQgYWxpY2UuaW5pdCgpO1xuICBhbGljZS5wcmludCgpO1xuXG4gIGNvbnNvbGUubG9nKFwiTWludGluZyB0b2tlbnMgZm9yIEFsaWNlIG9uIE1hZ2FudGEgaWYgYmFsYW5jZSBpcyB6ZXJvIC4uLlwiKTtcbiAgY29uc3QgbWFuZ2F0YUFkZHJlc3MgPSBhbGljZS5hc3NldHNbMV0uYWRkcmVzcztcbiAgY29uc3QgcHJvbWlzZXMgPSBfLm1hcChhbGljZS5hc3NldHNbMV0udG9rZW5zLCAodG9rZW4pPT57XG4gICAgY29uc3Qge3N5bWJvbCwgYmFsYW5jZX0gPSB0b2tlbjtcblxuICAgIGlmKGJhbGFuY2UuaXNaZXJvKCkpe1xuICAgICAgY29uc29sZS5sb2coYFtBbGljZV0gJHtzeW1ib2x9IGJhbGFuY2Ugb24gTWFuZ2F0YSBpcyB6ZXJvOyBtaW50aW5nICR7c3ltYm9sfSB3aXRoIHN1ZG8gLi4uYCk7XG4gICAgICByZXR1cm4gbWFuZ2F0YUhlbHBlci5taW50VG9rZW4obWFuZ2F0YUFkZHJlc3MsIHN5bWJvbCwgYWxpY2Uua2V5cmluZyk7XG4gICAgfWVsc2V7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICB9KTtcblxuICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cbiAgLy8gQ3JlYXRlIHBvb2xcbiAgY29uc3QgcG9vbHMgPSBhd2FpdCBtYW5nYXRhSGVscGVyLmdldFBvb2xzKCk7XG5cdGNvbnNvbGUubG9nKCdQb29sczogJywgcG9vbHMpO1xuXG4gIGNvbnN0IGV4aXN0aW5nUG9vbCA9IF8uZmluZChwb29scywgKHBvb2wpPT57XG4gICAgcmV0dXJuIHBvb2wuZmlyc3RUb2tlbklkID09PSBtYW5nYXRhSGVscGVyLmdldFRva2VuSWRCeVN5bWJvbChcIk1HUlwiKSAmJiBwb29sLnNlY29uZFRva2VuSWQgPT09IG1hbmdhdGFIZWxwZXIuZ2V0VG9rZW5JZEJ5U3ltYm9sKFwiVFVSXCIpO1xuICB9KTtcblxuICBpZihfLmlzVW5kZWZpbmVkKGV4aXN0aW5nUG9vbCkpXG4gIHtcbiAgICBjb25zb2xlLmxvZyhgTm8gTUdSLVRVUiBwb29sIGZvdW5kOyBjcmVhdGluZyBhIE1HUi1UVVIgcG9vbCB3aXRoIEFsaWNlIC4uLmApO1xuICAgIGF3YWl0IG1hbmdhdGFIZWxwZXIuY3JlYXRlUG9vbChcIk1HUlwiICxcIlRVUlwiLGFsaWNlLmtleXJpbmcpO1xuICB9ZWxzZXtcbiAgICBjb25zb2xlLmxvZyhgQW4gZXhpc3RpbmcgTUdSLVRVUiBwb29sIGZvdW5kOyBza2lwIHBvb2wgY3JlYXRpb24gLi4uYCk7XG4gIH1cblxuICAvLyBQcm9tb3RlIHBvb2xcblx0Y29uc29sZS5sb2coJ1Byb21vdGUgcG9vbC4uLicpO1xuXHRjb25zdCBwcm9tb3RlUG9vbEV4dHJpbnNpYyA9IG1hbmdhdGFIZWxwZXIuYXBpLnR4Lnh5ay5wcm9tb3RlUG9vbChwb29sc1swXS5saXF1aWRpdHlUb2tlbklkKTtcblx0YXdhaXQgc2VuZEV4dHJpbnNpYyhtYW5nYXRhSGVscGVyLmFwaSwgcHJvbW90ZVBvb2xFeHRyaW5zaWMsIGFsaWNlLmtleXJpbmcsIHsgaXNTdWRvOiB0cnVlIH0pO1xuXG5cdC8vIEJ1eSBhc3NldFxuXHRjb25zb2xlLmxvZygnQnV5IGFzc2V0Li4uJyk7XG5cdGF3YWl0IG1hbmdhdGFIZWxwZXIubWFuZ2F0YS5idXlBc3NldChhbGljZS5rZXlyaW5nLCAnMCcsICc3JywgbmV3IEJOKCcxMDAwMDAwMDAwMDAwJyksIG5ldyBCTignMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwJykpO1xuXG4gICAgLy8gJzgnOiB7XG4gICAgLy8gICAgIGlkOiAnOCcsXG4gICAgLy8gICAgIGNoYWluSWQ6IDAsXG4gICAgLy8gICAgIGRlY2ltYWxzOiAxOCxcbiAgICAvLyAgICAgbmFtZTogJ0xpcXVpZGl0eSBQb29sIFRva2VuJyxcbiAgICAvLyAgICAgc3ltYm9sOiAnTUdSLVRVUicsXG4gICAgLy8gICAgIGFkZHJlc3M6ICcnXG4gICAgLy8gICB9XG5cbiAgICAvLyBhd2FpdCBtYW5nYXRhSGVscGVyLm1hbmdhdGEudHJhbnNmZXJUb2tlbihcbiAgICAvLyAgICAgYWNjb3VudCwgXG4gICAgLy8gICAgICc0JywgLy8gVG9rZW5JRCA0IGlzIEtTTVxuICAgIC8vICAgICBhY2NvdW50LmFkZHJlc3MsIFxuICAgIC8vICAgICBuZXcgQk4oMTAwMDAwMDAwMDAwMDAwKSwgLy8gMTAwIEtTTSAoS1NNIGlzIDEyIGRlY2ltYWxzKVxuICAgIC8vICAgICB7XG4gICAgLy8gICAgICAgICBzdGF0dXNDYWxsYmFjazogKHJlc3VsdCkgPT4ge1xuICAgIC8vICAgICAgICAgICAvLyByZXN1bHQgaXMgb2YgdGhlIGZvcm0gSVN1Ym1pdHRhYmxlUmVzdWx0XG4gICAgLy8gICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdClcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICBleHRyaW5zaWNTdGF0dXM6IChyZXN1bHQpID0+IHtcbiAgICAvLyAgICAgICAgICAgLy8gcmVzdWx0IGlzIG9mIHRoZSBmb3JtIE1hbmdhdGFHZW5lcmljRXZlbnRbXVxuICAgIC8vICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzdWx0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgIC8vICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1BoYXNlJywgcmVzdWx0W2luZGV4XS5waGFzZS50b1N0cmluZygpKVxuICAgIC8vICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlY3Rpb24nLCByZXN1bHRbaW5kZXhdLnNlY3Rpb24pXG4gICAgLy8gICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWV0aG9kJywgcmVzdWx0W2luZGV4XS5tZXRob2QpXG4gICAgLy8gICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRG9jdW1lbnRhdGlvbicsIHJlc3VsdFtpbmRleF0ubWV0YURvY3VtZW50YXRpb24pXG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfSxcbiAgICAvLyAgICAgICB9XG4gICAgLy8gKVxuXG4vLyAgIGNvbnN0IHByb3h5QWNjb3VudCA9IG1hbmdhdGFIZWxwZXIuZ2V0UHJveHlBZGRyZXNzTWFuZ2F0YShrZXlQYWlyLmFkZHJlc3MpO1xuLy8gICBjb25zb2xlLmxvZyhcInByb3h5IGFjY291bnQ6XCIsIGtleXJpbmcuZW5jb2RlQWRkcmVzcyhwcm94eUFjY291bnQsIFNVQlNUUkFURV9TUzU4KSk7XG5cbi8vICAgbWFuZ2F0YUhlbHBlci5hZGRQcm94eShwcm94eUFjY291bnQsIGtleVBhaXIpO1xuLy8gICBjb25zb2xlLmxvZygnQWRkIHByb3h5IG9uIG1hbmdhdGEgc3VjY2Vzc2Z1bGx5IScpO1xuXG4gIGNvbnN0IG1lc3NhZ2UgPSBcImVtcHR5XCI7XG4vLyAgIGF3YWl0IHR1cmluZ0hlbHBlci54Y21TZW5kKGRlc3QsIG1lc3NhZ2UpO1xufSkoKTsiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUErQztBQUUvQyxNQUFNQSxjQUFjLEdBQUcsRUFBRTtBQUN6QixNQUFNQyxXQUFXLEdBQUcsRUFBRTtBQUN0QixNQUFNQyxZQUFZLEdBQUcsRUFBRTtBQUN2QixNQUFNQyxjQUFjLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixjQUFjO0FBQ2pELE1BQU1HLGVBQWUsR0FB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","map":{"version":3,"names":["SUBSTRATE_SS58","TURING_SS58","MANGATA_SS58","TURING_PARA_ID","process","env","MANGATA_PARA_ID","TURING_ENDPOINT","MANGATA_ENDPOINT","keyring","Keyring","main","cryptoWaitReady","console","log","turingHelper","initialize","mangataHelper","alice","Account","init","print","mangataAddress","assets","address","promises","_","map","tokens","token","symbol","balance","isZero","mintToken","Promise","resolve","all","pools","getPools","existingPool","find","pool","firstTokenId","getTokenIdBySymbol","secondTokenId","isUndefined","createPool","promotePoolExtrinsic","api","tx","xyk","promotePool","liquidityTokenId","sendExtrinsic","isSudo","mangata","buyAsset","BN","message"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/","sources":["setup.js"],"sourcesContent":["import \"@imstar15/api-augment\";\nimport { Keyring } from \"@polkadot/api\";\nimport { cryptoWaitReady } from '@polkadot/util-crypto';\nimport turingHelper from \"./common/turingHelper\";\nimport mangataHelper from \"./common/mangataHelper\";\nimport Account from './common/account';\nimport _ from 'lodash';\nimport BN from 'bn.js';\nimport { Mangata } from \"@mangata-finance/sdk\";\nimport { sendExtrinsic } from \"./common/utils\";\nimport {chainConfig} from './common/constants';\n\nconst SUBSTRATE_SS58 = 42;\nconst TURING_SS58 = 51;\nconst MANGATA_SS58 = 42;\nconst TURING_PARA_ID = process.env.TURING_PARA_ID;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst TURING_ENDPOINT = process.env.TURING_ENDPOINT;\nconst MANGATA_ENDPOINT = process.env.MANGATA_ENDPOINT;\n\n// const OAK_SOV_ACCOUNT = \"68kxzikS2WZNkYSPWdYouqH5sEZujecVCy3TFt9xHWB5MDG5\";\nconst keyring = new Keyring();\n\n/*** Main entrance of the program */\n(async function main () {\n  await cryptoWaitReady();\n\n    console.log(\"Initializing APIs of both chains ...\");\n    await turingHelper.initialize(TURING_ENDPOINT);\n    await mangataHelper.initialize(MANGATA_ENDPOINT);\n\n  console.log(\"Reading token and balance of Alice and Bob accounts ...\");\n  const alice = new Account(\"Alice\");\n  await alice.init();\n  alice.print();\n\n  console.log(\"Minting tokens for Alice on Maganta if balance is zero ...\");\n  const mangataAddress = alice.assets[1].address;\n  const promises = _.map(alice.assets[1].tokens, (token)=>{\n    const {symbol, balance} = token;\n\n    if(balance.isZero()){\n      console.log(`[Alice] ${symbol} balance on Mangata is zero; minting ${symbol} with sudo ...`);\n      return mangataHelper.mintToken(mangataAddress, symbol, alice.keyring);\n    }else{\n      return Promise.resolve();\n    }\n  });\n\n  await Promise.all(promises);\n\n  // Create pool\n  const pools = await mangataHelper.getPools();\n\tconsole.log('Pools: ', pools);\n\n  const existingPool = _.find(pools, (pool)=>{\n    return pool.firstTokenId === mangataHelper.getTokenIdBySymbol(\"MGR\") && pool.secondTokenId === mangataHelper.getTokenIdBySymbol(\"TUR\");\n  });\n\n  if(_.isUndefined(existingPool))\n  {\n    console.log(`No MGR-TUR pool found; creating a MGR-TUR pool with Alice ...`);\n    await mangataHelper.createPool(\"MGR\" ,\"TUR\",alice.keyring);\n  }else{\n    console.log(`An existing MGR-TUR pool found; skip pool creation ...`);\n  }\n\n  // Promote pool\n\tconsole.log('Promote pool...');\n\tconst promotePoolExtrinsic = mangataHelper.api.tx.xyk.promotePool(pools[0].liquidityTokenId);\n\tawait sendExtrinsic(mangataHelper.api, promotePoolExtrinsic, alice.keyring, { isSudo: true });\n\n\t// Buy asset\n\tconsole.log('Buy asset...');\n\tawait mangataHelper.mangata.buyAsset(alice.keyring, '0', '7', new BN('1000000000000'), new BN('100000000000000000000000000'));\n\n    // '8': {\n    //     id: '8',\n    //     chainId: 0,\n    //     decimals: 18,\n    //     name: 'Liquidity Pool Token',\n    //     symbol: 'MGR-TUR',\n    //     address: ''\n    //   }\n\n    // await mangataHelper.mangata.transferToken(\n    //     account, \n    //     '4', // TokenID 4 is KSM\n    //     account.address, \n    //     new BN(100000000000000), // 100 KSM (KSM is 12 decimals)\n    //     {\n    //         statusCallback: (result) => {\n    //           // result is of the form ISubmittableResult\n    //           console.log(result)\n    //         },\n    //         extrinsicStatus: (result) => {\n    //           // result is of the form MangataGenericEvent[]\n    //           for (let index = 0; index < result.length; index++) {\n    //               console.log('Phase', result[index].phase.toString())\n    //               console.log('Section', result[index].section)\n    //               console.log('Method', result[index].method)\n    //               console.log('Documentation', result[index].metaDocumentation)\n    //             }\n    //         },\n    //       }\n    // )\n\n//   const proxyAccount = mangataHelper.getProxyAddressMangata(keyPair.address);\n//   console.log(\"proxy account:\", keyring.encodeAddress(proxyAccount, SUBSTRATE_SS58));\n\n//   mangataHelper.addProxy(proxyAccount, keyPair);\n//   console.log('Add proxy on mangata successfully!');\n\n  const message = \"empty\";\n//   await turingHelper.xcmSend(dest, message);\n})();"],"mappings":"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"}},"mtime":1668991612101},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/turingHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _types = require(\"@imstar15/types\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass TuringHelper {\n  initialize = async endpoint => {\n    const api = await _api.ApiPromise.create({\n      provider: new _api.WsProvider(endpoint),\n      rpc: _types.rpc\n    });\n    this.api = api;\n  };\n  getApi = () => this.api;\n  getBalance = async address => {\n    // Retrieve the account balance & nonce via the system module\n    const {\n      data: balance\n    } = await this.api.query.system.account(address);\n    return balance;\n  };\n  getProxyAddressMangata = address => {\n    const keyring = new _api.Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [{\n          Parachain: MANGATA_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: keyring.decodeAddress(mangataAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const proxyAccount = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  };\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100,\n      // does not except negative?\n      runtimeVersion: this.api.runtimeVersion\n    });\n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  };\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\", dest, message);\n    return new Promise(async resolve => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async resolve => {\n      const unsub = await xcmpCall.signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n\n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n}\nvar _default = new TuringHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUVVJJTkdfUEFSQV9JRCIsIk1BTkdBVEFfU1M1OCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdSIiwiS1NNIiwiVFVSIiwiVHVyaW5nSGVscGVyIiwiaW5pdGlhbGl6ZSIsImVuZHBvaW50IiwiYXBpIiwiQXBpUHJvbWlzZSIsImNyZWF0ZSIsInByb3ZpZGVyIiwiV3NQcm92aWRlciIsInJwYyIsImdldEFwaSIsImdldEJhbGFuY2UiLCJhZGRyZXNzIiwiZGF0YSIsImJhbGFuY2UiLCJxdWVyeSIsInN5c3RlbSIsImFjY291bnQiLCJnZXRQcm94eUFkZHJlc3NNYW5nYXRhIiwia2V5cmluZyIsIktleXJpbmciLCJtYW5nYXRhQWRkcmVzcyIsImVuY29kZUFkZHJlc3MiLCJsb2NhdGlvbiIsInBhcmVudHMiLCJpbnRlcmlvciIsIlgyIiwiUGFyYWNoYWluIiwiQWNjb3VudElkMzIiLCJuZXR3b3JrIiwiaWQiLCJkZWNvZGVBZGRyZXNzIiwibXVsdGlsb2NhdGlvbiIsImNyZWF0ZVR5cGUiLCJ0b0hhc2giLCJVaW50OEFycmF5IiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJ0b1U4YSIsInByb3h5QWNjb3VudCIsInU4YVRvSGV4IiwicmVnaXN0cnkiLCJoYXNoIiwic2xpY2UiLCJnZXRYY21GZWVzIiwieGNtcENhbGwiLCJmYWtlU2lnbmVkWGNtcENhbGwiLCJzaWduRmFrZSIsImJsb2NrSGFzaCIsImdlbmVzaXNIYXNoIiwibm9uY2UiLCJydW50aW1lVmVyc2lvbiIsImZlZXMiLCJ4Y21wSGFuZGxlciIsInRvSGV4IiwieGNtU2VuZCIsImRlc3QiLCJtZXNzYWdlIiwiY29uc29sZSIsImxvZyIsIlByb21pc2UiLCJyZXNvbHZlIiwidW5zdWIiLCJ0eCIsInBvbGthZG90WGNtIiwic2VuZCIsInNpZ25BbmRTZW5kIiwia2V5UGFpciIsInN0YXR1cyIsImlzSW5CbG9jayIsImFzSW5CbG9jayIsInR5cGUiLCJzZW5kWGNtRXh0cmluc2ljIiwidGFza0lkIiwidGFzayIsImF1dG9tYXRpb25UaW1lIiwiYWNjb3VudFRhc2tzIiwidG9IdW1hbiJdLCJzb3VyY2VSb290IjoiL1VzZXJzL21pa2FzYS9Db2RlL3hjbS1kZW1vL3NyYy9jb21tb24vIiwic291cmNlcyI6WyJ0dXJpbmdIZWxwZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcnBjIH0gZnJvbSAnQGltc3RhcjE1L3R5cGVzJztcbmltcG9ydCB7IEFwaVByb21pc2UsIFdzUHJvdmlkZXIsIEtleXJpbmcgfSBmcm9tIFwiQHBvbGthZG90L2FwaVwiO1xuaW1wb3J0IHsgdThhVG9IZXggfSBmcm9tIFwiQHBvbGthZG90L3V0aWxcIjtcbmltcG9ydCBCTiBmcm9tICdibi5qcyc7XG5cbmNvbnN0IFRVUklOR19QQVJBX0lEID0gMjExNDtcbmNvbnN0IE1BTkdBVEFfU1M1OCA9IDQyO1xuY29uc3QgTUFOR0FUQV9QQVJBX0lEID0gcHJvY2Vzcy5lbnYuTUFOR0FUQV9QQVJBX0lEO1xuXG5jb25zdCBERUNJTUFMID0ge1xuICBNR1I6ICcxMDAwMDAwMDAwMDAwMDAwMDAwJyxcbiAgS1NNOiAnMTAwMDAwMDAwMDAwMCcsXG4gIFRVUjogJzEwMDAwMDAwMDAwJyxcbn07XG5cbmNsYXNzIFR1cmluZ0hlbHBlciB7XG4gIGluaXRpYWxpemUgPSBhc3luYyAoZW5kcG9pbnQpID0+IHtcbiAgICBjb25zdCBhcGkgPSBhd2FpdCBBcGlQcm9taXNlLmNyZWF0ZSh7IHByb3ZpZGVyOiBuZXcgV3NQcm92aWRlcihlbmRwb2ludCksIHJwYyB9KTtcblx0XHR0aGlzLmFwaSA9IGFwaTtcbiAgfVxuXG4gIGdldEFwaSA9ICgpID0+IHRoaXMuYXBpO1xuXG4gIGdldEJhbGFuY2UgPSBhc3luYyhhZGRyZXNzKT0+e1xuICAgIC8vIFJldHJpZXZlIHRoZSBhY2NvdW50IGJhbGFuY2UgJiBub25jZSB2aWEgdGhlIHN5c3RlbSBtb2R1bGVcbiAgICBjb25zdCB7IGRhdGE6IGJhbGFuY2UgfSA9IGF3YWl0IHRoaXMuYXBpLnF1ZXJ5LnN5c3RlbS5hY2NvdW50KGFkZHJlc3MpO1xuXG4gICAgcmV0dXJuIGJhbGFuY2U7XG4gIH1cblxuICBnZXRQcm94eUFkZHJlc3NNYW5nYXRhID0gKGFkZHJlc3MpID0+IHtcbiAgICBjb25zdCBrZXlyaW5nID0gbmV3IEtleXJpbmcoKTtcbiAgICBjb25zdCBtYW5nYXRhQWRkcmVzcyA9IGtleXJpbmcuZW5jb2RlQWRkcmVzcyhhZGRyZXNzLCBNQU5HQVRBX1NTNTgpO1xuXG4gICAgY29uc3QgbG9jYXRpb24gPSB7XG4gICAgICBwYXJlbnRzOiAxLFxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogTUFOR0FUQV9QQVJBX0lEIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgQWNjb3VudElkMzI6IHtcbiAgICAgICAgICAgICAgbmV0d29yazogXCJBbnlcIixcbiAgICAgICAgICAgICAgaWQ6IGtleXJpbmcuZGVjb2RlQWRkcmVzcyhtYW5nYXRhQWRkcmVzcyksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG11bHRpbG9jYXRpb24gPSB0aGlzLmFwaS5jcmVhdGVUeXBlKFwiWGNtVjFNdWx0aUxvY2F0aW9uXCIsIGxvY2F0aW9uKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBwcm94eUFjY291bnQgPSB1OGFUb0hleCh0aGlzLmFwaS5yZWdpc3RyeS5oYXNoKHRvSGFzaCkuc2xpY2UoMCwgMzIpKTtcbiAgICByZXR1cm4gcHJveHlBY2NvdW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBYQ00gZmVlc1xuICAgKiBGYWtlIHNpZ24gdGhlIGNhbGwgaW4gb3JkZXIgdG8gZ2V0IHRoZSBjb21iaW5lZCBmZWVzIGZyb20gVHVyaW5nLlxuICAgKiBUdXJpbmcgeGNtcEhhbmRsZXJfZmVlcyBSUEMgcmVxdWlyZXMgdGhlIGVuY29kZWQgY2FsbCBpbiB0aGlzIGZvcm1hdC5cbiAgICogRmVlcyByZXR1cm5lZCBpbmNsdWRlIGluY2x1c2lvbiwgYWxsIGV4ZWN1dGlvbnMsIGFuZCBYQ01QIGZlZXMgdG8gcnVuIG9uIFRhcmdldCBDaGFpbi5cbiAgICogQHBhcmFtIHsqfSBhZGRyZXNzIFxuICAgKiBAcGFyYW0geyp9IHhjbXBDYWxsIFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIGdldFhjbUZlZXMgPSBhc3luYyAoYWRkcmVzcywgeGNtcENhbGwpID0+IHtcbiAgICBjb25zdCBmYWtlU2lnbmVkWGNtcENhbGwgPSB4Y21wQ2FsbC5zaWduRmFrZShhZGRyZXNzLCB7XG4gICAgICBibG9ja0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgZ2VuZXNpc0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgbm9uY2U6IDEwMCwgLy8gZG9lcyBub3QgZXhjZXB0IG5lZ2F0aXZlP1xuICAgICAgcnVudGltZVZlcnNpb246IHRoaXMuYXBpLnJ1bnRpbWVWZXJzaW9uLFxuICAgIH0pO1xuICBcbiAgICBjb25zdCBmZWVzID0gYXdhaXQgdGhpcy5hcGkucnBjLnhjbXBIYW5kbGVyLmZlZXMoZmFrZVNpZ25lZFhjbXBDYWxsLnRvSGV4KCkpO1xuICAgIHJldHVybiBmZWVzO1xuICB9XG5cbiAgeGNtU2VuZCA9IGFzeW5jIChkZXN0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJ4Y21TZW5kLFwiLGRlc3QsbWVzc2FnZSk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IHVuc3ViID0gYXdhaXQgdGhpcy5hcGkudHgucG9sa2Fkb3RYY20uc2VuZChkZXN0LCBtZXNzYWdlKS5zaWduQW5kU2VuZChrZXlQYWlyLCB7IG5vbmNlOiAtMSB9LCBhc3luYyAoeyBzdGF0dXMgfSkgPT4ge1xuICAgICAgICBpZiAoc3RhdHVzLmlzSW5CbG9jaykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsIHdpdGggaGFzaCAnICsgc3RhdHVzLmFzSW5CbG9jay50b0hleCgpKTtcbiAgXG4gICAgICAgICAgdW5zdWIoKTtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N0YXR1czogJyArIHN0YXR1cy50eXBlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbiAgc2VuZFhjbUV4dHJpbnNpYyA9IGFzeW5jICh4Y21wQ2FsbCwga2V5UGFpciwgdGFza0lkKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCB1bnN1YiA9IGF3YWl0IHhjbXBDYWxsLnNpZ25BbmRTZW5kKGtleVBhaXIsIHsgbm9uY2U6IC0xIH0sIGFzeW5jICh7IHN0YXR1cyB9KSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXMuaXNJbkJsb2NrKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWwgd2l0aCBoYXNoICcgKyBzdGF0dXMuYXNJbkJsb2NrLnRvSGV4KCkpO1xuICBcbiAgICAgICAgICAvLyBHZXQgVGFza1xuICAgICAgICAgIGNvbnN0IHRhc2sgPSBhd2FpdCB0aGlzLmFwaS5xdWVyeS5hdXRvbWF0aW9uVGltZS5hY2NvdW50VGFza3Moa2V5UGFpci5hZGRyZXNzLCB0YXNrSWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGFzazpcIiwgdGFzay50b0h1bWFuKCkpO1xuICBcbiAgICAgICAgICB1bnN1YigpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU3RhdHVzOiAnICsgc3RhdHVzLnR5cGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgVHVyaW5nSGVscGVyKCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUF1QjtBQUV2QixNQUFNQSxjQUFjLEdBQUcsSUFBSTtBQUMzQixNQUFNQyxZQUFZLEdBQUcsRUFBRTtBQUN2QixNQUFNQyxlQUFlLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixlQUFlO0FBRW5ELE1BQU1HLE9BQU8sR0FBRztFQUNkQyxHQUFHLEVBQUUscUJBQXFCO0VBQzFCQyxHQUFHLEVBQUUsZUFBZTtFQUNwQkMsR0FBRyxFQUFFO0FBQ1AsQ0FBQztBQUVELE1BQU1DLFlBQVksQ0FBQztFQUNqQkMsVUFBVSxHQUFHLE1BQU9DLFFBQVEsSUFBSztJQUMvQixNQUFNQyxHQUFHLEdBQUcsTUFBTUMsZUFBVSxDQUFDQyxNQUFNLENBQUM7TUFBRUMsUUFBUSxFQUFFLElBQUlDLGVBQVUsQ0FBQ0wsUUFBUSxDQUFDO01BQUVNLEdBQUcsRUFBSEE7SUFBSSxDQUFDLENBQUM7SUFDbEYsSUFBSSxDQUFDTCxHQUFHLEdBQUdBLEdBQUc7RUFDZCxDQUFDO0VBRURNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQ04sR0FBRztFQUV2Qk8sVUFBVSxHQUFHLE1BQU1DLE9BQU8sSUFBRztJQUMzQjtJQUNBLE1BQU07TUFBRUMsSUFBSSxFQUFFQztJQUFRLENBQUMsR0FBRyxNQUFNLElBQUksQ0FBQ1YsR0FBRyxDQUFDVyxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDTCxPQUFPLENBQUM7SUFFdEUsT0FBT0UsT0FBTztFQUNoQixDQUFDO0VBRURJLHNCQUFzQixHQUFJTixPQUFPLElBQUs7SUFDcEMsTUFBTU8sT0FBTyxHQUFHLElBQUlDLFlB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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_SS58","MANGATA_PARA_ID","process","env","DECIMAL","MGR","KSM","TUR","TuringHelper","initialize","endpoint","api","ApiPromise","create","provider","WsProvider","rpc","getApi","getBalance","address","data","balance","query","system","account","getProxyAddressMangata","keyring","Keyring","mangataAddress","encodeAddress","location","parents","interior","X2","Parachain","AccountId32","network","id","decodeAddress","multilocation","createType","toHash","Uint8Array","TextEncoder","encode","toU8a","proxyAccount","u8aToHex","registry","hash","slice","getXcmFees","xcmpCall","fakeSignedXcmpCall","signFake","blockHash","genesisHash","nonce","runtimeVersion","fees","xcmpHandler","toHex","xcmSend","dest","message","console","log","Promise","resolve","unsub","tx","polkadotXcm","send","signAndSend","keyPair","status","isInBlock","asInBlock","type","sendXcmExtrinsic","taskId","task","automationTime","accountTasks","toHuman"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["turingHelper.js"],"sourcesContent":["import { rpc } from '@imstar15/types';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport BN from 'bn.js';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\n\nclass TuringHelper {\n  initialize = async (endpoint) => {\n    const api = await ApiPromise.create({ provider: new WsProvider(endpoint), rpc });\n\t\tthis.api = api;\n  }\n\n  getApi = () => this.api;\n\n  getBalance = async(address)=>{\n    // Retrieve the account balance & nonce via the system module\n    const { data: balance } = await this.api.query.system.account(address);\n\n    return balance;\n  }\n\n  getProxyAddressMangata = (address) => {\n    const keyring = new Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [\n          { Parachain: MANGATA_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: keyring.decodeAddress(mangataAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const proxyAccount = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  }\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100, // does not except negative?\n      runtimeVersion: this.api.runtimeVersion,\n    });\n  \n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  }\n\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\",dest,message);\n\n    return new Promise(async (resolve) => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n}\n\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async (resolve) => {\n      const unsub = await xcmpCall.signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  }\n}\n\nexport default new TuringHelper();"],"mappings":"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"}},"mtime":1668986832751},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/mangataHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _utils = require(\"./utils\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass MangataHelper {\n  initialize = async mangataEndpoint => {\n    const mangata = _sdk.Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n    this.mangata = mangata;\n    this.api = mangataApi;\n    const assetsResp = await this.mangata.getAssetsInfo();\n    this.assets = _lodash.default.values(_lodash.default.filter(assetsResp, asset => !_lodash.default.isEmpty(asset.symbol)));\n    console.log(\"Assets on Mangata chain: \", this.assets);\n    /**\n    [\n      {\"id\":\"0\",\"chainId\":0,\"decimals\":18,\"name\":\"Mangata\",\"symbol\":\"MGR\",\"address\":\"\"},\n      {\"id\":\"4\",\"chainId\":0,\"decimals\":12,\"name\":\"Rococo  Native\",\"symbol\":\"ROC\",\"address\":\"\"},\n      {\"id\":\"7\",\"chainId\":0,\"decimals\":10,\"name\":\"Turing native token\",\"symbol\":\"TUR\",\"address\":\"\"}\n    ]\n     */\n  };\n\n  getBalance = async (symbol, address) => {\n    const tokenId = _lodash.default.find(this.assets, {\n      symbol\n    }).id;\n    const balance = await this.mangata.getTokenBalance(tokenId, address);\n    return balance;\n  };\n  getTokenIdBySymbol(symbol) {\n    const tokenId = _lodash.default.find(this.assets, {\n      symbol\n    }).id;\n    return tokenId;\n  }\n  getProxyAccount = address => {\n    const decodedAddress = (0, _utilCrypto.decodeAddress)(address); // An Int array presentation of the address ss58 public key\n\n    const location = {\n      parents: 1,\n      // From Turing to Mangata\n      interior: {\n        X2: [{\n          Parachain: TURING_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: (0, _util.u8aToHex)(decodedAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    console.log(\"multilocation\", multilocation.toString());\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const DescendOriginAddress32 = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return DescendOriginAddress32;\n  };\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n  mintToken = async (address, symbol, keyring, amount = 5000000000000000) => {\n    const tokenId = _lodash.default.find(this.assets, {\n      symbol\n    }).id;\n    const mintTokenExtrinsic = this.api.tx.tokens.mint(tokenId, address, amount);\n    await (0, _utils.sendExtrinsic)(this.api, mintTokenExtrinsic, keyring, {\n      isSudo: true\n    });\n  };\n  createPool = async (firstSymbol, secondSymbol, keyring) => {\n    const firstTokenId = _lodash.default.find(this.assets, {\n      symbol: firstSymbol\n    }).id;\n    const secondTokenId = _lodash.default.find(this.assets, {\n      symbol: secondSymbol\n    }).id;\n    return new Promise(resolve => {\n      this.mangata.createPool(keyring, firstTokenId.toString(), new _bn.default('10000000000000000000000'),\n      // 10000 MGR (MGR is 18 decimals)\n      secondTokenId.toString(), new _bn.default('100000000000000'),\n      // 100 TUR (TUR is 12 decimals)\n      {\n        statusCallback: result => {\n          // result is of the form ISubmittableResult\n          console.log(\"call back result\", result);\n          console.log(\"call back result type\", result.status.type);\n        },\n        extrinsicStatus: result => {\n          // result is of the form MangataGenericEvent[]\n          for (let index = 0; index < result.length; index++) {\n            console.log('Phase', result[index].phase.toString());\n            console.log('Section', result[index].section);\n            console.log('Method', result[index].method);\n            console.log('Documentation', result[index].metaDocumentation);\n          }\n        }\n      });\n    });\n  };\n  getPools = async () => {\n    return this.mangata.getPools();\n  };\n}\nvar _default = new MangataHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUVVJJTkdfUEFSQV9JRCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdSIiwiS1NNIiwiVFVSIiwiTWFuZ2F0YUhlbHBlciIsImluaXRpYWxpemUiLCJtYW5nYXRhRW5kcG9pbnQiLCJtYW5nYXRhIiwiTWFuZ2F0YSIsImdldEluc3RhbmNlIiwibWFuZ2F0YUFwaSIsImdldEFwaSIsImFwaSIsImFzc2V0c1Jlc3AiLCJnZXRBc3NldHNJbmZvIiwiYXNzZXRzIiwiXyIsInZhbHVlcyIsImZpbHRlciIsImFzc2V0IiwiaXNFbXB0eSIsInN5bWJvbCIsImNvbnNvbGUiLCJsb2ciLCJnZXRCYWxhbmNlIiwiYWRkcmVzcyIsInRva2VuSWQiLCJmaW5kIiwiaWQiLCJiYWxhbmNlIiwiZ2V0VG9rZW5CYWxhbmNlIiwiZ2V0VG9rZW5JZEJ5U3ltYm9sIiwiZ2V0UHJveHlBY2NvdW50IiwiZGVjb2RlZEFkZHJlc3MiLCJkZWNvZGVBZGRyZXNzIiwibG9jYXRpb24iLCJwYXJlbnRzIiwiaW50ZXJpb3IiLCJYMiIsIlBhcmFjaGFpbiIsIkFjY291bnRJZDMyIiwibmV0d29yayIsInU4YVRvSGV4IiwibXVsdGlsb2NhdGlvbiIsImNyZWF0ZVR5cGUiLCJ0b1N0cmluZyIsInRvSGFzaCIsIlVpbnQ4QXJyYXkiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsInRvVThhIiwiRGVzY2VuZE9yaWdpbkFkZHJlc3MzMiIsInJlZ2lzdHJ5IiwiaGFzaCIsInNsaWNlIiwiYWRkUHJveHkiLCJwcm94eUFjY291bnQiLCJrZXlQYWlyIiwidHgiLCJwcm94eSIsInNpZ25BbmRTZW5kIiwiY3JlYXRlUHJveHlDYWxsIiwiZXh0cmluc2ljIiwibWludFRva2VuIiwia2V5cmluZyIsImFtb3VudCIsIm1pbnRUb2tlbkV4dHJpbnNpYyIsInRva2VucyIsIm1pbnQiLCJzZW5kRXh0cmluc2ljIiwiaXNTdWRvIiwiY3JlYXRlUG9vbCIsImZpcnN0U3ltYm9sIiwic2Vjb25kU3ltYm9sIiwiZmlyc3RUb2tlbklkIiwic2Vjb25kVG9rZW5JZCIsIlByb21pc2UiLCJyZXNvbHZlIiwiQk4iLCJzdGF0dXNDYWxsYmFjayIsInJlc3VsdCIsInN0YXR1cyIsInR5cGUiLCJleHRyaW5zaWNTdGF0dXMiLCJpbmRleCIsImxlbmd0aCIsInBoYXNlIiwic2VjdGlvbiIsIm1ldGhvZCIsIm1ldGFEb2N1bWVudGF0aW9uIiwiZ2V0UG9vbHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby9zcmMvY29tbW9uLyIsInNvdXJjZXMiOlsibWFuZ2F0YUhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYW5nYXRhIH0gZnJvbSAnQG1hbmdhdGEtZmluYW5jZS9zZGsnO1xuaW1wb3J0IHsgQXBpUHJvbWlzZSwgV3NQcm92aWRlciwgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyB1OGFUb0hleCB9IGZyb20gXCJAcG9sa2Fkb3QvdXRpbFwiO1xuaW1wb3J0IHsgZGVjb2RlQWRkcmVzcyB9IGZyb20gJ0Bwb2xrYWRvdC91dGlsLWNyeXB0byc7XG5pbXBvcnQgQk4gZnJvbSAnYm4uanMnO1xuaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0IHsgc2VuZEV4dHJpbnNpYyB9IGZyb20gJy4vdXRpbHMnO1xuXG5jb25zdCBUVVJJTkdfUEFSQV9JRCA9IDIxMTQ7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5cbmNvbnN0IERFQ0lNQUwgPSB7XG4gIE1HUjogJzEwMDAwMDAwMDAwMDAwMDAwMDAnLFxuICBLU006ICcxMDAwMDAwMDAwMDAwJyxcbiAgVFVSOiAnMTAwMDAwMDAwMDAnLFxufTtcbmNsYXNzIE1hbmdhdGFIZWxwZXIge1xuICBpbml0aWFsaXplID0gYXN5bmMgKG1hbmdhdGFFbmRwb2ludCkgPT4ge1xuICAgIGNvbnN0IG1hbmdhdGEgPSBNYW5nYXRhLmdldEluc3RhbmNlKFttYW5nYXRhRW5kcG9pbnRdKTtcbiAgICBjb25zdCBtYW5nYXRhQXBpID0gYXdhaXQgbWFuZ2F0YS5nZXRBcGkoKTtcblxuICAgIHRoaXMubWFuZ2F0YSA9IG1hbmdhdGE7XG4gICAgdGhpcy5hcGkgPSBtYW5nYXRhQXBpO1xuXG4gICAgY29uc3QgYXNzZXRzUmVzcCA9IGF3YWl0IHRoaXMubWFuZ2F0YS5nZXRBc3NldHNJbmZvKCk7XG4gICAgdGhpcy5hc3NldHM9Xy52YWx1ZXMoXy5maWx0ZXIoYXNzZXRzUmVzcCwgYXNzZXQ9PiAhXy5pc0VtcHR5KGFzc2V0LnN5bWJvbCkpKTtcbiAgICBjb25zb2xlLmxvZyhcIkFzc2V0cyBvbiBNYW5nYXRhIGNoYWluOiBcIiwgdGhpcy5hc3NldHMpO1xuICAgIC8qKlxuICAgIFtcbiAgICAgIHtcImlkXCI6XCIwXCIsXCJjaGFpbklkXCI6MCxcImRlY2ltYWxzXCI6MTgsXCJuYW1lXCI6XCJNYW5nYXRhXCIsXCJzeW1ib2xcIjpcIk1HUlwiLFwiYWRkcmVzc1wiOlwiXCJ9LFxuICAgICAge1wiaWRcIjpcIjRcIixcImNoYWluSWRcIjowLFwiZGVjaW1hbHNcIjoxMixcIm5hbWVcIjpcIlJvY29jbyAgTmF0aXZlXCIsXCJzeW1ib2xcIjpcIlJPQ1wiLFwiYWRkcmVzc1wiOlwiXCJ9LFxuICAgICAge1wiaWRcIjpcIjdcIixcImNoYWluSWRcIjowLFwiZGVjaW1hbHNcIjoxMCxcIm5hbWVcIjpcIlR1cmluZyBuYXRpdmUgdG9rZW5cIixcInN5bWJvbFwiOlwiVFVSXCIsXCJhZGRyZXNzXCI6XCJcIn1cbiAgICBdXG4gICAgICovXG4gIH1cblxuICBnZXRCYWxhbmNlID0gYXN5bmMgKHN5bWJvbCwgYWRkcmVzcyApID0+IHtcbiAgICBjb25zdCB0b2tlbklkID0gKF8uZmluZCh0aGlzLmFzc2V0cywge3N5bWJvbH0pKS5pZDtcbiAgICBjb25zdCBiYWxhbmNlID0gYXdhaXQgdGhpcy5tYW5nYXRhLmdldFRva2VuQmFsYW5jZSh0b2tlbklkLCBhZGRyZXNzKTtcbiAgICByZXR1cm4gYmFsYW5jZTtcbiAgfVxuXG4gIGdldFRva2VuSWRCeVN5bWJvbChzeW1ib2wpIHtcbiAgICBjb25zdCB0b2tlbklkID0gKF8uZmluZCh0aGlzLmFzc2V0cywge3N5bWJvbH0pKS5pZDtcbiAgICByZXR1cm4gdG9rZW5JZDtcbiAgfVxuXG4gIGdldFByb3h5QWNjb3VudCA9IChhZGRyZXNzKSA9PiB7XG4gICAgY29uc3QgZGVjb2RlZEFkZHJlc3MgPSBkZWNvZGVBZGRyZXNzKGFkZHJlc3MpOyAvLyBBbiBJbnQgYXJyYXkgcHJlc2VudGF0aW9uIG9mIHRoZSBhZGRyZXNz4oCZIHNzNTggcHVibGljIGtleVxuICAgIFxuICAgIGNvbnN0IGxvY2F0aW9uID0ge1xuICAgICAgcGFyZW50czogMSwgLy8gRnJvbSBUdXJpbmcgdG8gTWFuZ2F0YVxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogVFVSSU5HX1BBUkFfSUQgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBBY2NvdW50SWQzMjoge1xuICAgICAgICAgICAgICBuZXR3b3JrOiBcIkFueVwiLFxuICAgICAgICAgICAgICBpZDogdThhVG9IZXgoZGVjb2RlZEFkZHJlc3MpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBtdWx0aWxvY2F0aW9uID0gdGhpcy5hcGkuY3JlYXRlVHlwZShcIlhjbVYxTXVsdGlMb2NhdGlvblwiLCBsb2NhdGlvbik7XG5cbiAgICBjb25zb2xlLmxvZyhcIm11bHRpbG9jYXRpb25cIiwgbXVsdGlsb2NhdGlvbi50b1N0cmluZygpKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBEZXNjZW5kT3JpZ2luQWRkcmVzczMyID0gdThhVG9IZXgodGhpcy5hcGkucmVnaXN0cnkuaGFzaCh0b0hhc2gpLnNsaWNlKDAsIDMyKSk7XG5cbiAgICByZXR1cm4gRGVzY2VuZE9yaWdpbkFkZHJlc3MzMjtcbiAgfVxuXG4gIGFkZFByb3h5ID0gYXN5bmMgKHByb3h5QWNjb3VudCwga2V5UGFpcikgPT4gdGhpcy5hcGkudHgucHJveHkuYWRkUHJveHkocHJveHlBY2NvdW50LCBcIkFueVwiLCAwKS5zaWduQW5kU2VuZChrZXlQYWlyKTtcblxuICBjcmVhdGVQcm94eUNhbGwgPSBhc3luYyAoYWRkcmVzcywgZXh0cmluc2ljKSA9PiB0aGlzLmFwaS50eC5wcm94eS5wcm94eShhZGRyZXNzLCAnQW55JywgZXh0cmluc2ljKTtcblxuICBtaW50VG9rZW4gPSBhc3luYyhhZGRyZXNzLCBzeW1ib2wsIGtleXJpbmcsIGFtb3VudD01MDAwMDAwMDAwMDAwMDAwKT0+e1xuICAgIGNvbnN0IHRva2VuSWQgPSAoXy5maW5kKHRoaXMuYXNzZXRzLCB7c3ltYm9sfSkpLmlkO1xuICAgIGNvbnN0IG1pbnRUb2tlbkV4dHJpbnNpYyA9IHRoaXMuYXBpLnR4LnRva2Vucy5taW50KHRva2VuSWQsIGFkZHJlc3MsIGFtb3VudCk7XG4gICAgYXdhaXQgc2VuZEV4dHJpbnNpYyh0aGlzLmFwaSwgbWludFRva2VuRXh0cmluc2ljLCBrZXlyaW5nLCB7IGlzU3VkbzogdHJ1ZSB9KTtcbiAgfVxuXG4gIGNyZWF0ZVBvb2wgPSBhc3luYyAoZmlyc3RTeW1ib2wsIHNlY29uZFN5bWJvbCwga2V5cmluZykgPT4ge1xuICAgIGNvbnN0IGZpcnN0VG9rZW5JZCA9IChfLmZpbmQodGhpcy5hc3NldHMsIHtzeW1ib2w6IGZpcnN0U3ltYm9sfSkpLmlkO1xuICAgIGNvbnN0IHNlY29uZFRva2VuSWQgPSAoXy5maW5kKHRoaXMuYXNzZXRzLCB7c3ltYm9sOiBzZWNvbmRTeW1ib2x9KSkuaWQ7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHRoaXMubWFuZ2F0YS5jcmVhdGVQb29sKFxuICAgICAgICBrZXlyaW5nLFxuICAgICAgICBmaXJzdFRva2VuSWQudG9TdHJpbmcoKSxcbiAgICAgICAgbmV3IEJOKCcxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCcpLCAvLyAxMDAwMCBNR1IgKE1HUiBpcyAxOCBkZWNpbWFscylcbiAgICAgICAgc2Vjb25kVG9rZW5JZC50b1N0cmluZygpLFxuICAgICAgICBuZXcgQk4oJzEwMDAwMDAwMDAwMDAwMCcpLCAvLyAxMDAgVFVSIChUVVIgaXMgMTIgZGVjaW1hbHMpXG4gICAgICAgIHtcbiAgICAgICAgICBzdGF0dXNDYWxsYmFjazogKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgLy8gcmVzdWx0IGlzIG9mIHRoZSBmb3JtIElTdWJtaXR0YWJsZVJlc3VsdFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYWxsIGJhY2sgcmVzdWx0XCIsIHJlc3VsdCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhbGwgYmFjayByZXN1bHQgdHlwZVwiLCByZXN1bHQuc3RhdHVzLnR5cGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXh0cmluc2ljU3RhdHVzOiAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAvLyByZXN1bHQgaXMgb2YgdGhlIGZvcm0gTWFuZ2F0YUdlbmVyaWNFdmVudFtdXG4gICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzdWx0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1BoYXNlJywgcmVzdWx0W2luZGV4XS5waGFzZS50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlY3Rpb24nLCByZXN1bHRbaW5kZXhdLnNlY3Rpb24pXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWV0aG9kJywgcmVzdWx0W2luZGV4XS5tZXRob2QpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRG9jdW1lbnRhdGlvbicsIHJlc3VsdFtpbmRleF0ubWV0YURvY3VtZW50YXRpb24pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG4gIH1cblxuICBnZXRQb29scyA9IGFzeW5jKCkgPT57XG4gICAgcmV0dXJuIHRoaXMubWFuZ2F0YS5nZXRQb29scygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBNYW5nYXRhSGVscGVyKCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUF3QztBQUV4QyxNQUFNQSxjQUFjLEdBQUcsSUFBSTtBQUMzQixNQUFNQyxlQUFlLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixlQUFlO0FBRW5ELE1BQU1HLE9BQU8sR0FBRztFQUNkQyxHQUFHLEVBQUUscUJBQXFCO0VBQzFCQyxHQUFHLEVBQUUsZUFBZTtFQUNwQkMsR0FBRyxFQUFFO0FBQ1AsQ0FBQztBQUNELE1BQU1DLGFBQWEsQ0FBQztFQUNsQkMsVUFBVSxHQUFHLE1BQU9DLGVBQWUsSUFBSztJQUN0QyxNQUFNQyxPQUFPLEdBQUdDLFlBQU8sQ0FBQ0MsV0FBVyxDQUFDLENBQUNILGVBQWUsQ0FBQyxDQUFDO0lBQ3RELE1BQU1JLFVBQVUsR0FBRyxNQUFNSCxPQUFPLENBQUNJLE1BQU0sRUFBRTtJQUV6QyxJQUFJLENBQUNKLE9BQU8sR0FBR0EsT0FBTztJQUN0QixJQUFJLENBQUNLLEdBQUcsR0FBR0YsVUFBVTtJQUVyQixNQUFNRyxVQUFVLEdBQUcsTUFBTSxJQUFJLENBQUNOLE9BQU8sQ0FBQ08sYUFBYSxFQUFFO0lBQ3JELElBQUksQ0FBQ0MsTUFBTSxHQUFDQyxlQUFDLENBQUNDLE1BQU0s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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_PARA_ID","process","env","DECIMAL","MGR","KSM","TUR","MangataHelper","initialize","mangataEndpoint","mangata","Mangata","getInstance","mangataApi","getApi","api","assetsResp","getAssetsInfo","assets","_","values","filter","asset","isEmpty","symbol","console","log","getBalance","address","tokenId","find","id","balance","getTokenBalance","getTokenIdBySymbol","getProxyAccount","decodedAddress","decodeAddress","location","parents","interior","X2","Parachain","AccountId32","network","u8aToHex","multilocation","createType","toString","toHash","Uint8Array","TextEncoder","encode","toU8a","DescendOriginAddress32","registry","hash","slice","addProxy","proxyAccount","keyPair","tx","proxy","signAndSend","createProxyCall","extrinsic","mintToken","keyring","amount","mintTokenExtrinsic","tokens","mint","sendExtrinsic","isSudo","createPool","firstSymbol","secondSymbol","firstTokenId","secondTokenId","Promise","resolve","BN","statusCallback","result","status","type","extrinsicStatus","index","length","phase","section","method","metaDocumentation","getPools"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["mangataHelper.js"],"sourcesContent":["import { Mangata } from '@mangata-finance/sdk';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { decodeAddress } from '@polkadot/util-crypto';\nimport BN from 'bn.js';\nimport _ from \"lodash\";\nimport { sendExtrinsic } from './utils';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\nclass MangataHelper {\n  initialize = async (mangataEndpoint) => {\n    const mangata = Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n\n    this.mangata = mangata;\n    this.api = mangataApi;\n\n    const assetsResp = await this.mangata.getAssetsInfo();\n    this.assets=_.values(_.filter(assetsResp, asset=> !_.isEmpty(asset.symbol)));\n    console.log(\"Assets on Mangata chain: \", this.assets);\n    /**\n    [\n      {\"id\":\"0\",\"chainId\":0,\"decimals\":18,\"name\":\"Mangata\",\"symbol\":\"MGR\",\"address\":\"\"},\n      {\"id\":\"4\",\"chainId\":0,\"decimals\":12,\"name\":\"Rococo  Native\",\"symbol\":\"ROC\",\"address\":\"\"},\n      {\"id\":\"7\",\"chainId\":0,\"decimals\":10,\"name\":\"Turing native token\",\"symbol\":\"TUR\",\"address\":\"\"}\n    ]\n     */\n  }\n\n  getBalance = async (symbol, address ) => {\n    const tokenId = (_.find(this.assets, {symbol})).id;\n    const balance = await this.mangata.getTokenBalance(tokenId, address);\n    return balance;\n  }\n\n  getTokenIdBySymbol(symbol) {\n    const tokenId = (_.find(this.assets, {symbol})).id;\n    return tokenId;\n  }\n\n  getProxyAccount = (address) => {\n    const decodedAddress = decodeAddress(address); // An Int array presentation of the address ss58 public key\n    \n    const location = {\n      parents: 1, // From Turing to Mangata\n      interior: {\n        X2: [\n          { Parachain: TURING_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: u8aToHex(decodedAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    console.log(\"multilocation\", multilocation.toString());\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const DescendOriginAddress32 = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n\n    return DescendOriginAddress32;\n  }\n\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n\n  mintToken = async(address, symbol, keyring, amount=5000000000000000)=>{\n    const tokenId = (_.find(this.assets, {symbol})).id;\n    const mintTokenExtrinsic = this.api.tx.tokens.mint(tokenId, address, amount);\n    await sendExtrinsic(this.api, mintTokenExtrinsic, keyring, { isSudo: true });\n  }\n\n  createPool = async (firstSymbol, secondSymbol, keyring) => {\n    const firstTokenId = (_.find(this.assets, {symbol: firstSymbol})).id;\n    const secondTokenId = (_.find(this.assets, {symbol: secondSymbol})).id;\n\n    return new Promise((resolve) => {\n      this.mangata.createPool(\n        keyring,\n        firstTokenId.toString(),\n        new BN('10000000000000000000000'), // 10000 MGR (MGR is 18 decimals)\n        secondTokenId.toString(),\n        new BN('100000000000000'), // 100 TUR (TUR is 12 decimals)\n        {\n          statusCallback: (result) => {\n            // result is of the form ISubmittableResult\n            console.log(\"call back result\", result);\n            console.log(\"call back result type\", result.status.type);\n          },\n          extrinsicStatus: (result) => {\n            // result is of the form MangataGenericEvent[]\n            for (let index = 0; index < result.length; index++) {\n                  console.log('Phase', result[index].phase.toString())\n                  console.log('Section', result[index].section)\n                  console.log('Method', result[index].method)\n                  console.log('Documentation', result[index].metaDocumentation)\n                }\n          },\n        }\n      );\n    });\n  }\n\n  getPools = async() =>{\n    return this.mangata.getPools();\n  }\n}\n\nexport default new MangataHelper();"],"mappings":"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"}},"mtime":1668991036973},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sendExtrinsic = void 0;\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst sendExtrinsic = async (api, extrinsic, keyPair, {\n  isSudo = false\n} = {}) => {\n  return new Promise(resolve => {\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n    newExtrinsic.signAndSend(keyPair, {\n      nonce: -1\n    }, ({\n      status,\n      dispatchError\n    }) => {\n      console.log(\"status\", status);\n      if (status.type === 'Finalized') {\n        console.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n        if (!_lodash.default.isNil(dispatchError)) {\n          if (dispatchError.isModule) {\n            const metaError = api.registry.findMetaError(dispatchError.asModule);\n            const {\n              docs,\n              name,\n              section\n            } = metaError;\n            const dispatchErrorMessage = JSON.stringify({\n              docs,\n              name,\n              section\n            });\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`;\n            console.log(errMsg);\n          } else {\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`;\n            console.log(errMsg);\n          }\n        }\n        resolve(status.asFinalized.toString());\n      }\n    });\n  });\n};\nexports.sendExtrinsic = sendExtrinsic;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kRXh0cmluc2ljIiwiYXBpIiwiZXh0cmluc2ljIiwia2V5UGFpciIsImlzU3VkbyIsIlByb21pc2UiLCJyZXNvbHZlIiwibmV3RXh0cmluc2ljIiwidHgiLCJzdWRvIiwic2lnbkFuZFNlbmQiLCJub25jZSIsInN0YXR1cyIsImRpc3BhdGNoRXJyb3IiLCJjb25zb2xlIiwibG9nIiwidHlwZSIsImFzRmluYWxpemVkIiwidG9TdHJpbmciLCJfIiwiaXNOaWwiLCJpc01vZHVsZSIsIm1ldGFFcnJvciIsInJlZ2lzdHJ5IiwiZmluZE1ldGFFcnJvciIsImFzTW9kdWxlIiwiZG9jcyIsIm5hbWUiLCJzZWN0aW9uIiwiZGlzcGF0Y2hFcnJvck1lc3NhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyTXNnIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbWlrYXNhL0NvZGUveGNtLWRlbW8vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBjb25zdCBzZW5kRXh0cmluc2ljID0gYXN5bmMgKGFwaSwgZXh0cmluc2ljLCBrZXlQYWlyLCB7IGlzU3VkbyA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblxuICAgIGNvbnN0IG5ld0V4dHJpbnNpYyA9IGlzU3VkbyA/IGFwaS50eC5zdWRvLnN1ZG8oZXh0cmluc2ljKSA6IGV4dHJpbnNpYztcblx0XHRuZXdFeHRyaW5zaWMuc2lnbkFuZFNlbmQoa2V5UGFpciwgeyBub25jZTogLTEgfSwgKHsgc3RhdHVzLCBkaXNwYXRjaEVycm9yIH0pID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKFwic3RhdHVzXCIsIHN0YXR1cyk7XG5cdFx0XHRpZiAoc3RhdHVzLnR5cGUgPT09ICdGaW5hbGl6ZWQnKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdGaW5hbGl6ZSBleHRyaW5zaWMgaW4gYmxvY2s6ICcsIHN0YXR1cy5hc0ZpbmFsaXplZC50b1N0cmluZygpKTtcblxuXHRcdFx0XHRpZiAoIV8uaXNOaWwoZGlzcGF0Y2hFcnJvcikpIHtcblx0XHRcdFx0XHRpZiAoZGlzcGF0Y2hFcnJvci5pc01vZHVsZSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgbWV0YUVycm9yID0gYXBpLnJlZ2lzdHJ5LmZpbmRNZXRhRXJyb3IoZGlzcGF0Y2hFcnJvci5hc01vZHVsZSlcblx0XHRcdFx0XHRcdGNvbnN0IHsgZG9jcywgbmFtZSwgc2VjdGlvbiB9ID0gbWV0YUVycm9yXG5cdFx0XHRcdFx0XHRjb25zdCBkaXNwYXRjaEVycm9yTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHsgZG9jcywgbmFtZSwgc2VjdGlvbiB9KVxuXHRcdFx0XHRcdFx0Y29uc3QgZXJyTXNnID0gYFRyYW5zYWN0aW9uIGZpbmFsaXplZCB3aXRoIGVycm9yIGJ5IGJsb2NrY2hhaW4gJHtkaXNwYXRjaEVycm9yTWVzc2FnZX1gXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnJNc2cpXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNvbnN0IGVyck1zZyA9IGBUcmFuc2FjdGlvbiBmaW5hbGl6ZWQgd2l0aCBlcnJvciBieSBibG9ja2NoYWluICR7ZGlzcGF0Y2hFcnJvci50b1N0cmluZygpfWBcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGVyck1zZylcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXNvbHZlKHN0YXR1cy5hc0ZpbmFsaXplZC50b1N0cmluZygpKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUF1QjtBQUVoQixNQUFNQSxhQUFhLEdBQUcsT0FBT0MsR0FBRyxFQUFFQyxTQUFTLEVBQUVDLE9BQU8sRUFBRTtFQUFFQyxNQUFNLEdBQUc7QUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUs7RUFDeEYsT0FBTyxJQUFJQyxPQUFPLENBQUVDLE9BQU8sSUFBSztJQUU3QixNQUFNQyxZQUFZLEdBQUdILE1BQU0sR0FBR0gsR0FBRyxDQUFDTyxFQUFFLENBQUNDLElBQUksQ0FBQ0EsSUFBSSxDQUFDUCxTQUFTLENBQUMsR0FBR0EsU0FBUztJQUN2RUssWUFBWSxDQUFDRyxXQUFXLENBQUNQLE9BQU8sRUFBRTtNQUFFUSxLQUFLLEVBQUUsQ0FBQztJQUFFLENBQUMsRUFBRSxDQUFDO01BQUVDLE1BQU07TUFBRUM7SUFBYyxDQUFDLEtBQUs7TUFDL0VDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFFBQVEsRUFBRUgsTUFBTSxDQUFDO01BQzdCLElBQUlBLE1BQU0sQ0FBQ0ksSUFBSSxLQUFLLFdBQVcsRUFBRTtRQUNoQ0YsT0FBTyxDQUFDQyxHQUFHLENBQUMsK0JBQStCLEVBQUVILE1BQU0sQ0FBQ0ssV0FBVyxDQUFDQyxRQUFRLEVBQUUsQ0FBQztRQUUzRSxJQUFJLENBQUNDLGVBQUMsQ0FBQ0MsS0FBSyxDQUFDUCxhQUFhLENBQUMsRUFBRTtVQUM1QixJQUFJQSxhQUFhLENBQUNRLFFBQVEsRUFBRTtZQUMzQixNQUFNQyxTQUFTLEdBQUdyQixHQUFHLENBQUNzQixRQUFRLENBQUNDLGFBQWEsQ0FBQ1gsYUFBYSxDQUFDWSxRQUFRLENBQUM7WUFDcEUsTUFBTTtjQUFFQyxJQUFJO2NBQUVDLElBQUk7Y0FBRUM7WUFBUSxDQUFDLEdBQUdOLFNBQVM7WUFDekMsTUFBTU8sb0JBQW9CLEdBQUdDLElBQUksQ0FBQ0MsU0FBUyxDQUFDO2NBQUVMLElBQUk7Y0FBRUMsSUFBSTtjQUFFQztZQUFRLENBQUMsQ0FBQztZQUNwRSxNQUFNSSxNQUFNLEdBQUksa0RBQWlESCxvQkFBcUIsRUFBQztZQUN2RmYsT0FBTyxDQUFDQyxHQUFHLENBQUNpQixNQUFNLENBQUM7VUFDcEIsQ0FBQyxNQUFNO1lBQ04sTUFBTUEsTUFBTSxHQUFJLGtEQUFpRG5CLGFBQWEsQ0FBQ0ssUUFBUSxFQUFHLEVBQUM7WUFDM0ZKLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDaUIsTUFBTSxDQUFDO1VBQ3BCO1FBQ0Q7UUFFQTFCLE9BQU8sQ0FBQ00sTUFBTSxDQUFDSyxXQUFXLENBQUNDLFFBQVEsRUFBRSxDQUFDO01BQ3ZDO0lBQ0QsQ0FBQyxDQUFDO0VBQ0gsQ0FBQyxDQUFDO0FBQ0gsQ0FBQztBQUFBIn0=","map":{"version":3,"names":["sendExtrinsic","api","extrinsic","keyPair","isSudo","Promise","resolve","newExtrinsic","tx","sudo","signAndSend","nonce","status","dispatchError","console","log","type","asFinalized","toString","_","isNil","isModule","metaError","registry","findMetaError","asModule","docs","name","section","dispatchErrorMessage","JSON","stringify","errMsg"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["utils.js"],"sourcesContent":["import _ from 'lodash';\n\nexport const sendExtrinsic = async (api, extrinsic, keyPair, { isSudo = false } = {}) => {\n\treturn new Promise((resolve) => {\n\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n\t\tnewExtrinsic.signAndSend(keyPair, { nonce: -1 }, ({ status, dispatchError }) => {\n\t\t\tconsole.log(\"status\", status);\n\t\t\tif (status.type === 'Finalized') {\n\t\t\t\tconsole.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n\n\t\t\t\tif (!_.isNil(dispatchError)) {\n\t\t\t\t\tif (dispatchError.isModule) {\n\t\t\t\t\t\tconst metaError = api.registry.findMetaError(dispatchError.asModule)\n\t\t\t\t\t\tconst { docs, name, section } = metaError\n\t\t\t\t\t\tconst dispatchErrorMessage = JSON.stringify({ docs, name, section })\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve(status.asFinalized.toString());\n\t\t\t}\n\t\t});\n\t});\n}"],"mappings":";;;;;;AAAA;AAAuB;AAEhB,MAAMA,aAAa,GAAG,OAAOC,GAAG,EAAEC,SAAS,EAAEC,OAAO,EAAE;EAAEC,MAAM,GAAG;AAAM,CAAC,GAAG,CAAC,CAAC,KAAK;EACxF,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;IAE7B,MAAMC,YAAY,GAAGH,MAAM,GAAGH,GAAG,CAACO,EAAE,CAACC,IAAI,CAACA,IAAI,CAACP,SAAS,CAAC,GAAGA,SAAS;IACvEK,YAAY,CAACG,WAAW,CAACP,OAAO,EAAE;MAAEQ,KAAK,EAAE,CAAC;IAAE,CAAC,EAAE,CAAC;MAAEC,MAAM;MAAEC;IAAc,CAAC,KAAK;MAC/EC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEH,MAAM,CAAC;MAC7B,IAAIA,MAAM,CAACI,IAAI,KAAK,WAAW,EAAE;QAChCF,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEH,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;QAE3E,IAAI,CAACC,eAAC,CAACC,KAAK,CAACP,aAAa,CAAC,EAAE;UAC5B,IAAIA,aAAa,CAACQ,QAAQ,EAAE;YAC3B,MAAMC,SAAS,GAAGrB,GAAG,CAACsB,QAAQ,CAACC,aAAa,CAACX,aAAa,CAACY,QAAQ,CAAC;YACpE,MAAM;cAAEC,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,GAAGN,SAAS;YACzC,MAAMO,oBAAoB,GAAGC,IAAI,CAACC,SAAS,CAAC;cAAEL,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,CAAC;YACpE,MAAMI,MAAM,GAAI,kDAAiDH,oBAAqB,EAAC;YACvFf,OAAO,CAACC,GAAG,CAACiB,MAAM,CAAC;UACpB,CAAC,MAAM;YACN,MAAMA,MAAM,GAAI,kDAAiDnB,aAAa,CAACK,QAAQ,EAAG,EAAC;YAC3FJ,OAAO,CAACC,GAAG,CAACiB,MAAM,CAAC;UACpB;QACD;QAEA1B,OAAO,CAACM,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;MACvC;IACD,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAAA"}},"mtime":1668989758849},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/constants.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.tokenConfig = exports.chainConfig = void 0;\nconst chainConfig = {\n  \"rococo\": {\n    ss58: 42\n  },\n  \"turing\": {\n    ss58: 51\n  },\n  \"mangata\": {\n    ss58: 42\n  }\n};\nexports.chainConfig = chainConfig;\nconst tokenConfig = {\n  MGR: {\n    decimal: '1000000000000000000'\n  },\n  ROC: {\n    decimal: '1000000000000'\n  },\n  TUR: {\n    decimal: '10000000000'\n  },\n  \"MGR-TUR\": {\n    decimal: '1000000000000000000'\n  }\n};\nexports.tokenConfig = tokenConfig;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaGFpbkNvbmZpZyIsInNzNTgiLCJ0b2tlbkNvbmZpZyIsIk1HUiIsImRlY2ltYWwiLCJST0MiLCJUVVIiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby9zcmMvY29tbW9uLyIsInNvdXJjZXMiOlsiY29uc3RhbnRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNoYWluQ29uZmlnPXtcbiAgICBcInJvY29jb1wiOntcbiAgICAgICAgc3M1ODogNDIsXG4gICAgfSxcbiAgICBcInR1cmluZ1wiOntcbiAgICAgICAgc3M1ODo1MVxuICAgIH0sXG4gICAgXCJtYW5nYXRhXCI6e1xuICAgICAgICBzczU4OiA0MlxuICAgIH1cbn1cblxuY29uc3QgdG9rZW5Db25maWc9e1xuICAgIE1HUjoge1xuICAgICAgICBkZWNpbWFsOicxMDAwMDAwMDAwMDAwMDAwMDAwJ1xuICAgIH0sXG4gICAgUk9DOiB7XG4gICAgICAgIGRlY2ltYWw6ICcxMDAwMDAwMDAwMDAwJ1xuICAgIH0sXG4gICAgVFVSOiB7XG4gICAgICAgIGRlY2ltYWw6JzEwMDAwMDAwMDAwJ1xuICAgIH0sXG4gICAgXCJNR1ItVFVSXCI6IHtcbiAgICAgICAgZGVjaW1hbDonMTAwMDAwMDAwMDAwMDAwMDAwMCdcbiAgICB9XG59XG5cbmV4cG9ydCB7Y2hhaW5Db25maWcsIHRva2VuQ29uZmlnfTsiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFdBQVcsR0FBQztFQUNkLFFBQVEsRUFBQztJQUNMQyxJQUFJLEVBQUU7RUFDVixDQUFDO0VBQ0QsUUFBUSxFQUFDO0lBQ0xBLElBQUksRUFBQztFQUNULENBQUM7RUFDRCxTQUFTLEVBQUM7SUFDTkEsSUFBSSxFQUFFO0VBQ1Y7QUFDSixDQUFDO0FBQUE7QUFFRCxNQUFNQyxXQUFXLEdBQUM7RUFDZEMsR0FBRyxFQUFFO0lBQ0RDLE9BQU8sRUFBQztFQUNaLENBQUM7RUFDREMsR0FBRyxFQUFFO0lBQ0RELE9BQU8sRUFBRTtFQUNiLENBQUM7RUFDREUsR0FBRyxFQUFFO0lBQ0RGLE9BQU8sRUFBQztFQUNaLENBQUM7RUFDRCxTQUFTLEVBQUU7SUFDUEEsT0FBTyxFQUFDO0VBQ1o7QUFDSixDQUFDO0FBQUEifQ==","map":{"version":3,"names":["chainConfig","ss58","tokenConfig","MGR","decimal","ROC","TUR"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["constants.js"],"sourcesContent":["const chainConfig={\n    \"rococo\":{\n        ss58: 42,\n    },\n    \"turing\":{\n        ss58:51\n    },\n    \"mangata\":{\n        ss58: 42\n    }\n}\n\nconst tokenConfig={\n    MGR: {\n        decimal:'1000000000000000000'\n    },\n    ROC: {\n        decimal: '1000000000000'\n    },\n    TUR: {\n        decimal:'10000000000'\n    },\n    \"MGR-TUR\": {\n        decimal:'1000000000000000000'\n    }\n}\n\nexport {chainConfig, tokenConfig};"],"mappings":";;;;;;AAAA,MAAMA,WAAW,GAAC;EACd,QAAQ,EAAC;IACLC,IAAI,EAAE;EACV,CAAC;EACD,QAAQ,EAAC;IACLA,IAAI,EAAC;EACT,CAAC;EACD,SAAS,EAAC;IACNA,IAAI,EAAE;EACV;AACJ,CAAC;AAAA;AAED,MAAMC,WAAW,GAAC;EACdC,GAAG,EAAE;IACDC,OAAO,EAAC;EACZ,CAAC;EACDC,GAAG,EAAE;IACDD,OAAO,EAAE;EACb,CAAC;EACDE,GAAG,EAAE;IACDF,OAAO,EAAC;EACZ,CAAC;EACD,SAAS,EAAE;IACPA,OAAO,EAAC;EACZ;AACJ,CAAC;AAAA"}},"mtime":1668990896582},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/turingHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _types = require(\"@imstar15/types\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass TuringHelper {\n  initialize = async endpoint => {\n    const api = await _api.ApiPromise.create({\n      provider: new _api.WsProvider(endpoint),\n      rpc: _types.rpc\n    });\n    this.api = api;\n  };\n  getApi = () => this.api;\n  getBalance = async address => {\n    // Retrieve the account balance & nonce via the system module\n    const {\n      data: balance\n    } = await this.api.query.system.account(address);\n    return balance;\n  };\n  getProxyAddressMangata = address => {\n    const keyring = new _api.Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [{\n          Parachain: MANGATA_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: keyring.decodeAddress(mangataAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const proxyAccount = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  };\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100,\n      // does not except negative?\n      runtimeVersion: this.api.runtimeVersion\n    });\n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  };\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\", dest, message);\n    return new Promise(async resolve => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async resolve => {\n      const unsub = await xcmpCall.signAndSend(keyPair, {\n        nonce: -1\n      }, async ({\n        status\n      }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n\n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  };\n}\nvar _default = new TuringHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUVVJJTkdfUEFSQV9JRCIsIk1BTkdBVEFfU1M1OCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdSIiwiS1NNIiwiVFVSIiwiVHVyaW5nSGVscGVyIiwiaW5pdGlhbGl6ZSIsImVuZHBvaW50IiwiYXBpIiwiQXBpUHJvbWlzZSIsImNyZWF0ZSIsInByb3ZpZGVyIiwiV3NQcm92aWRlciIsInJwYyIsImdldEFwaSIsImdldEJhbGFuY2UiLCJhZGRyZXNzIiwiZGF0YSIsImJhbGFuY2UiLCJxdWVyeSIsInN5c3RlbSIsImFjY291bnQiLCJnZXRQcm94eUFkZHJlc3NNYW5nYXRhIiwia2V5cmluZyIsIktleXJpbmciLCJtYW5nYXRhQWRkcmVzcyIsImVuY29kZUFkZHJlc3MiLCJsb2NhdGlvbiIsInBhcmVudHMiLCJpbnRlcmlvciIsIlgyIiwiUGFyYWNoYWluIiwiQWNjb3VudElkMzIiLCJuZXR3b3JrIiwiaWQiLCJkZWNvZGVBZGRyZXNzIiwibXVsdGlsb2NhdGlvbiIsImNyZWF0ZVR5cGUiLCJ0b0hhc2giLCJVaW50OEFycmF5IiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJ0b1U4YSIsInByb3h5QWNjb3VudCIsInU4YVRvSGV4IiwicmVnaXN0cnkiLCJoYXNoIiwic2xpY2UiLCJnZXRYY21GZWVzIiwieGNtcENhbGwiLCJmYWtlU2lnbmVkWGNtcENhbGwiLCJzaWduRmFrZSIsImJsb2NrSGFzaCIsImdlbmVzaXNIYXNoIiwibm9uY2UiLCJydW50aW1lVmVyc2lvbiIsImZlZXMiLCJ4Y21wSGFuZGxlciIsInRvSGV4IiwieGNtU2VuZCIsImRlc3QiLCJtZXNzYWdlIiwiY29uc29sZSIsImxvZyIsIlByb21pc2UiLCJyZXNvbHZlIiwidW5zdWIiLCJ0eCIsInBvbGthZG90WGNtIiwic2VuZCIsInNpZ25BbmRTZW5kIiwia2V5UGFpciIsInN0YXR1cyIsImlzSW5CbG9jayIsImFzSW5CbG9jayIsInR5cGUiLCJzZW5kWGNtRXh0cmluc2ljIiwidGFza0lkIiwidGFzayIsImF1dG9tYXRpb25UaW1lIiwiYWNjb3VudFRhc2tzIiwidG9IdW1hbiJdLCJzb3VyY2VSb290IjoiL1VzZXJzL21pa2FzYS9Db2RlL3hjbS1kZW1vL3NyYy9jb21tb24vIiwic291cmNlcyI6WyJ0dXJpbmdIZWxwZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcnBjIH0gZnJvbSAnQGltc3RhcjE1L3R5cGVzJztcbmltcG9ydCB7IEFwaVByb21pc2UsIFdzUHJvdmlkZXIsIEtleXJpbmcgfSBmcm9tIFwiQHBvbGthZG90L2FwaVwiO1xuaW1wb3J0IHsgdThhVG9IZXggfSBmcm9tIFwiQHBvbGthZG90L3V0aWxcIjtcbmltcG9ydCBCTiBmcm9tICdibi5qcyc7XG5cbmNvbnN0IFRVUklOR19QQVJBX0lEID0gMjExNDtcbmNvbnN0IE1BTkdBVEFfU1M1OCA9IDQyO1xuY29uc3QgTUFOR0FUQV9QQVJBX0lEID0gcHJvY2Vzcy5lbnYuTUFOR0FUQV9QQVJBX0lEO1xuXG5jb25zdCBERUNJTUFMID0ge1xuICBNR1I6ICcxMDAwMDAwMDAwMDAwMDAwMDAwJyxcbiAgS1NNOiAnMTAwMDAwMDAwMDAwMCcsXG4gIFRVUjogJzEwMDAwMDAwMDAwJyxcbn07XG5cbmNsYXNzIFR1cmluZ0hlbHBlciB7XG4gIGluaXRpYWxpemUgPSBhc3luYyAoZW5kcG9pbnQpID0+IHtcbiAgICBjb25zdCBhcGkgPSBhd2FpdCBBcGlQcm9taXNlLmNyZWF0ZSh7IHByb3ZpZGVyOiBuZXcgV3NQcm92aWRlcihlbmRwb2ludCksIHJwYyB9KTtcblx0XHR0aGlzLmFwaSA9IGFwaTtcbiAgfVxuXG4gIGdldEFwaSA9ICgpID0+IHRoaXMuYXBpO1xuXG4gIGdldEJhbGFuY2UgPSBhc3luYyhhZGRyZXNzKT0+e1xuICAgIC8vIFJldHJpZXZlIHRoZSBhY2NvdW50IGJhbGFuY2UgJiBub25jZSB2aWEgdGhlIHN5c3RlbSBtb2R1bGVcbiAgICBjb25zdCB7IGRhdGE6IGJhbGFuY2UgfSA9IGF3YWl0IHRoaXMuYXBpLnF1ZXJ5LnN5c3RlbS5hY2NvdW50KGFkZHJlc3MpO1xuXG4gICAgcmV0dXJuIGJhbGFuY2U7XG4gIH1cblxuICBnZXRQcm94eUFkZHJlc3NNYW5nYXRhID0gKGFkZHJlc3MpID0+IHtcbiAgICBjb25zdCBrZXlyaW5nID0gbmV3IEtleXJpbmcoKTtcbiAgICBjb25zdCBtYW5nYXRhQWRkcmVzcyA9IGtleXJpbmcuZW5jb2RlQWRkcmVzcyhhZGRyZXNzLCBNQU5HQVRBX1NTNTgpO1xuXG4gICAgY29uc3QgbG9jYXRpb24gPSB7XG4gICAgICBwYXJlbnRzOiAxLFxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogTUFOR0FUQV9QQVJBX0lEIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgQWNjb3VudElkMzI6IHtcbiAgICAgICAgICAgICAgbmV0d29yazogXCJBbnlcIixcbiAgICAgICAgICAgICAgaWQ6IGtleXJpbmcuZGVjb2RlQWRkcmVzcyhtYW5nYXRhQWRkcmVzcyksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG11bHRpbG9jYXRpb24gPSB0aGlzLmFwaS5jcmVhdGVUeXBlKFwiWGNtVjFNdWx0aUxvY2F0aW9uXCIsIGxvY2F0aW9uKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBwcm94eUFjY291bnQgPSB1OGFUb0hleCh0aGlzLmFwaS5yZWdpc3RyeS5oYXNoKHRvSGFzaCkuc2xpY2UoMCwgMzIpKTtcbiAgICByZXR1cm4gcHJveHlBY2NvdW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBYQ00gZmVlc1xuICAgKiBGYWtlIHNpZ24gdGhlIGNhbGwgaW4gb3JkZXIgdG8gZ2V0IHRoZSBjb21iaW5lZCBmZWVzIGZyb20gVHVyaW5nLlxuICAgKiBUdXJpbmcgeGNtcEhhbmRsZXJfZmVlcyBSUEMgcmVxdWlyZXMgdGhlIGVuY29kZWQgY2FsbCBpbiB0aGlzIGZvcm1hdC5cbiAgICogRmVlcyByZXR1cm5lZCBpbmNsdWRlIGluY2x1c2lvbiwgYWxsIGV4ZWN1dGlvbnMsIGFuZCBYQ01QIGZlZXMgdG8gcnVuIG9uIFRhcmdldCBDaGFpbi5cbiAgICogQHBhcmFtIHsqfSBhZGRyZXNzIFxuICAgKiBAcGFyYW0geyp9IHhjbXBDYWxsIFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIGdldFhjbUZlZXMgPSBhc3luYyAoYWRkcmVzcywgeGNtcENhbGwpID0+IHtcbiAgICBjb25zdCBmYWtlU2lnbmVkWGNtcENhbGwgPSB4Y21wQ2FsbC5zaWduRmFrZShhZGRyZXNzLCB7XG4gICAgICBibG9ja0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgZ2VuZXNpc0hhc2g6IHRoaXMuYXBpLmdlbmVzaXNIYXNoLFxuICAgICAgbm9uY2U6IDEwMCwgLy8gZG9lcyBub3QgZXhjZXB0IG5lZ2F0aXZlP1xuICAgICAgcnVudGltZVZlcnNpb246IHRoaXMuYXBpLnJ1bnRpbWVWZXJzaW9uLFxuICAgIH0pO1xuICBcbiAgICBjb25zdCBmZWVzID0gYXdhaXQgdGhpcy5hcGkucnBjLnhjbXBIYW5kbGVyLmZlZXMoZmFrZVNpZ25lZFhjbXBDYWxsLnRvSGV4KCkpO1xuICAgIHJldHVybiBmZWVzO1xuICB9XG5cbiAgeGNtU2VuZCA9IGFzeW5jIChkZXN0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJ4Y21TZW5kLFwiLGRlc3QsbWVzc2FnZSk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IHVuc3ViID0gYXdhaXQgdGhpcy5hcGkudHgucG9sa2Fkb3RYY20uc2VuZChkZXN0LCBtZXNzYWdlKS5zaWduQW5kU2VuZChrZXlQYWlyLCB7IG5vbmNlOiAtMSB9LCBhc3luYyAoeyBzdGF0dXMgfSkgPT4ge1xuICAgICAgICBpZiAoc3RhdHVzLmlzSW5CbG9jaykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsIHdpdGggaGFzaCAnICsgc3RhdHVzLmFzSW5CbG9jay50b0hleCgpKTtcbiAgXG4gICAgICAgICAgdW5zdWIoKTtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N0YXR1czogJyArIHN0YXR1cy50eXBlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbiAgc2VuZFhjbUV4dHJpbnNpYyA9IGFzeW5jICh4Y21wQ2FsbCwga2V5UGFpciwgdGFza0lkKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCB1bnN1YiA9IGF3YWl0IHhjbXBDYWxsLnNpZ25BbmRTZW5kKGtleVBhaXIsIHsgbm9uY2U6IC0xIH0sIGFzeW5jICh7IHN0YXR1cyB9KSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXMuaXNJbkJsb2NrKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWwgd2l0aCBoYXNoICcgKyBzdGF0dXMuYXNJbkJsb2NrLnRvSGV4KCkpO1xuICBcbiAgICAgICAgICAvLyBHZXQgVGFza1xuICAgICAgICAgIGNvbnN0IHRhc2sgPSBhd2FpdCB0aGlzLmFwaS5xdWVyeS5hdXRvbWF0aW9uVGltZS5hY2NvdW50VGFza3Moa2V5UGFpci5hZGRyZXNzLCB0YXNrSWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGFzazpcIiwgdGFzay50b0h1bWFuKCkpO1xuICBcbiAgICAgICAgICB1bnN1YigpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU3RhdHVzOiAnICsgc3RhdHVzLnR5cGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgVHVyaW5nSGVscGVyKCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUF1QjtBQUV2QixNQUFNQSxjQUFjLEdBQUcsSUFBSTtBQUMzQixNQUFNQyxZQUFZLEdBQUcsRUFBRTtBQUN2QixNQUFNQyxlQUFlLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixlQUFlO0FBRW5ELE1BQU1HLE9BQU8sR0FBRztFQUNkQyxHQUFHLEVBQUUscUJBQXFCO0VBQzFCQyxHQUFHLEVBQUUsZUFBZTtFQUNwQkMsR0FBRyxFQUFFO0FBQ1AsQ0FBQztBQUVELE1BQU1DLFlBQVksQ0FBQztFQUNqQkMsVUFBVSxHQUFHLE1BQU9DLFFBQVEsSUFBSztJQUMvQixNQUFNQyxHQUFHLEdBQUcsTUFBTUMsZUFBVSxDQUFDQyxNQUFNLENBQUM7TUFBRUMsUUFBUSxFQUFFLElBQUlDLGVBQVUsQ0FBQ0wsUUFBUSxDQUFDO01BQUVNLEdBQUcsRUFBSEE7SUFBSSxDQUFDLENBQUM7SUFDbEYsSUFBSSxDQUFDTCxHQUFHLEdBQUdBLEdBQUc7RUFDZCxDQUFDO0VBRURNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQ04sR0FBRztFQUV2Qk8sVUFBVSxHQUFHLE1BQU1DLE9BQU8sSUFBRztJQUMzQjtJQUNBLE1BQU07TUFBRUMsSUFBSSxFQUFFQztJQUFRLENBQUMsR0FBRyxNQUFNLElBQUksQ0FBQ1YsR0FBRyxDQUFDVyxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDTCxPQUFPLENBQUM7SUFFdEUsT0FBT0UsT0FBTztFQUNoQixDQUFDO0VBRURJLHNCQUFzQixHQUFJTixPQUFPLElBQUs7SUFDcEMsTUFBTU8sT0FBTyxHQUFHLElBQUlDLFlBQU8sRUFBRTtJQUM3QixNQUFNQyxjQUFjLEdBQUdGLE9BQU8sQ0FBQ0csYUFBYSxDQUFDVixPQUFPLEVBQUVuQixZQUFZLENBQUM7SUFFbkUsTUFBTThCLFFBQVEsR0FBRztNQUNmQyxPQUFPLEVBQUUsQ0FBQztNQUNWQyxRQUFRLEVBQUU7UUFDUkMsRUFBRSxFQUFFLENBQ0Y7VUFBRUMsU0FBUyxFQUFFakM7UUFBZ0IsQ0FBQyxFQUM5QjtVQUNFa0MsV0FBVyxFQUFFO1lBQ1hDLE9BQU8sRUFBRSxLQUFLO1lBQ2RDLEVBQUUsRUFBRVgsT0FBTyxDQUFDWSxhQUFhLENBQUNWLGNBQWM7VUFDMUM7UUFDRixDQUFDO01BRUw7SUFDRixDQUFDO0lBRUQsTUFBTVcsYUFBYSxHQUFHLElBQUksQ0FBQzVCLEdBQUcsQ0FBQzZCLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRVYsUUFBUSxDQUFDO0lBRXpFLE1BQU1XLE1BQU0sR0FBRyxJQUFJQyxVQUFVLENBQUMsQ0FDNUIsR0FBRyxJQUFJQSxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUN2QixHQUFHLElBQUlDLFdBQVcsRUFBRSxDQUFDQyxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQ3ZDLEdBQUdMLGFBQWEsQ0FBQ00sS0FBSyxFQUFFLENBQ3pCLENBQUM7SUFFRixNQUFNQyxZQUFZLEdBQUcsSUFBQUMsY0FBUSxFQUFDLElBQUksQ0FBQ3BDLEdBQUcsQ0FBQ3FDLFFBQVEsQ0FBQ0MsSUFBSSxDQUFDUixNQUFNLENBQUMsQ0FBQ1MsS0FBSyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMxRSxPQUFPSixZQUFZO0VBQ3JCLENBQUM7O0VBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VLLFVBQVUsR0FBRyxPQUFPaEMsT0FBTyxFQUFFaUMsUUFBUSxLQUFLO0lBQ3hDLE1BQU1DLGtCQUFrQixHQUFHRCxRQUFRLENBQUNFLFFBQVEsQ0FBQ25DLE9BQU8sRUFBRTtNQUNwRG9DLFNBQVMsRUFBRSxJQUFJLENBQUM1QyxHQUFHLENBQUM2QyxXQUFXO01BQy9CQSxXQUFXLEVBQUUsSUFBSSxDQUFDN0MsR0FBRyxDQUFDNkMsV0FBVztNQUNqQ0MsS0FBSyxFQUFFLEdBQUc7TUFBRTtNQUNaQyxjQUFjLEVBQUUsSUFBSSxDQUFDL0MsR0FBRyxDQUFDK0M7SUFDM0IsQ0FBQyxDQUFDO0lBRUYsTUFBTUMsSUFBSSxHQUFHLE1BQU0sSUFBSSxDQUFDaEQsR0FBRyxDQUFDSyxHQUFHLENBQUM0QyxXQUFXLENBQUNELElBQUksQ0FBQ04sa0JBQWtCLENBQUNRLEtBQUssRUFBRSxDQUFDO0lBQzVFLE9BQU9GLElBQUk7RUFDYixDQUFDO0VBRURHLE9BQU8sR0FBRyxPQUFPQyxJQUFJLEVBQUVDLE9BQU8sS0FBSztJQUNqQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsVUFBVSxFQUFDSCxJQUFJLEVBQUNDLE9BQU8sQ0FBQztJQUVwQyxPQUFPLElBQUlHLE9BQU8sQ0FBQyxNQUFPQyxPQUFPLElBQUs7TUFDcEMsTUFBTUMsS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDMUQsR0FBRyxDQUFDMkQsRUFBRSxDQUFDQyxXQUFXLENBQUNDLElBQUksQ0FBQ1QsSUFBSSxFQUFFQyxPQUFPLENBQUMsQ0FBQ1MsV0FBVyxDQUFDQyxPQUFPLEVBQUU7UUFBRWpCLEtBQUssRUFBRSxDQUFDO01BQUUsQ0FBQyxFQUFFLE9BQU87UUFBRWtCO01BQU8sQ0FBQyxLQUFLO1FBQ3hILElBQUlBLE1BQU0sQ0FBQ0MsU0FBUyxFQUFFO1VBQ3BCWCxPQUFPLENBQUNDLEdBQUcsQ0FBQyx1QkFBdUIsR0FBR1MsTUFBTSxDQUFDRSxTQUFTLENBQUNoQixLQUFLLEVBQUUsQ0FBQztVQUUvRFEsS0FBSyxFQUFFO1VBQ1BELE9BQU8sRUFBRTtRQUNYLENBQUMsTUFBTTtVQUNMSCxPQUFPLENBQUNDLEdBQUcsQ0FBQyxVQUFVLEdBQUdTLE1BQU0sQ0FBQ0csSUFBSSxDQUFDO1FBQ3ZDO01BQ0YsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0VBQ04sQ0FBQztFQUVDQyxnQkFBZ0IsR0FBRyxPQUFPM0IsUUFBUSxFQUFFc0IsT0FBTyxFQUFFTSxNQUFNLEtBQUs7SUFDdEQsT0FBTyxJQUFJYixPQUFPLENBQUMsTUFBT0MsT0FBTyxJQUFLO01BQ3BDLE1BQU1DLEtBQUssR0FBRyxNQUFNakIsUUFBUSxDQUFDcUIsV0FBVyxDQUFDQyxPQUFPLEVBQUU7UUFBRWpCLEtBQUssRUFBRSxDQUFDO01BQUUsQ0FBQyxFQUFFLE9BQU87UUFBRWtCO01BQU8sQ0FBQyxLQUFLO1FBQ3JGLElBQUlBLE1BQU0sQ0FBQ0MsU0FBUyxFQUFFO1VBQ3BCWCxPQUFPLENBQUNDLEdBQUcsQ0FBQyx1QkFBdUIsR0FBR1MsTUFBTSxDQUFDRSxTQUFTLENBQUNoQixLQUFLLEVBQUUsQ0FBQzs7VUFFL0Q7VUFDQSxNQUFNb0IsSUFBSSxHQUFHLE1BQU0sSUFBSSxDQUFDdEUsR0FBRyxDQUFDVyxLQUFLLENBQUM0RCxjQUFjLENBQUNDLFlBQVksQ0FBQ1QsT0FBTyxDQUFDdkQsT0FBTyxFQUFFNkQsTUFBTSxDQUFDO1VBQ3RGZixPQUFPLENBQUNDLEdBQUcsQ0FBQyxPQUFPLEVBQUVlLElBQUksQ0FBQ0csT0FBTyxFQUFFLENBQUM7VUFFcENmLEtBQUssRUFBRTtVQUNQRCxPQUFPLEVBQUU7UUFDWCxDQUFDLE1BQU07VUFDTEgsT0FBTyxDQUFDQyxHQUFHLENBQUMsVUFBVSxHQUFHUyxNQUFNLENBQUNHLElBQUksQ0FBQztRQUN2QztNQUNGLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztFQUNKLENBQUM7QUFDSDtBQUFDLGVBRWMsSUFBSXRFLFlBQVksRUFBRTtBQUFBIn0=","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_SS58","MANGATA_PARA_ID","process","env","DECIMAL","MGR","KSM","TUR","TuringHelper","initialize","endpoint","api","ApiPromise","create","provider","WsProvider","rpc","getApi","getBalance","address","data","balance","query","system","account","getProxyAddressMangata","keyring","Keyring","mangataAddress","encodeAddress","location","parents","interior","X2","Parachain","AccountId32","network","id","decodeAddress","multilocation","createType","toHash","Uint8Array","TextEncoder","encode","toU8a","proxyAccount","u8aToHex","registry","hash","slice","getXcmFees","xcmpCall","fakeSignedXcmpCall","signFake","blockHash","genesisHash","nonce","runtimeVersion","fees","xcmpHandler","toHex","xcmSend","dest","message","console","log","Promise","resolve","unsub","tx","polkadotXcm","send","signAndSend","keyPair","status","isInBlock","asInBlock","type","sendXcmExtrinsic","taskId","task","automationTime","accountTasks","toHuman"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["turingHelper.js"],"sourcesContent":["import { rpc } from '@imstar15/types';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport BN from 'bn.js';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_SS58 = 42;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\n\nclass TuringHelper {\n  initialize = async (endpoint) => {\n    const api = await ApiPromise.create({ provider: new WsProvider(endpoint), rpc });\n\t\tthis.api = api;\n  }\n\n  getApi = () => this.api;\n\n  getBalance = async(address)=>{\n    // Retrieve the account balance & nonce via the system module\n    const { data: balance } = await this.api.query.system.account(address);\n\n    return balance;\n  }\n\n  getProxyAddressMangata = (address) => {\n    const keyring = new Keyring();\n    const mangataAddress = keyring.encodeAddress(address, MANGATA_SS58);\n\n    const location = {\n      parents: 1,\n      interior: {\n        X2: [\n          { Parachain: MANGATA_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: keyring.decodeAddress(mangataAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const proxyAccount = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n    return proxyAccount;\n  }\n\n  /**\n   * Get XCM fees\n   * Fake sign the call in order to get the combined fees from Turing.\n   * Turing xcmpHandler_fees RPC requires the encoded call in this format.\n   * Fees returned include inclusion, all executions, and XCMP fees to run on Target Chain.\n   * @param {*} address \n   * @param {*} xcmpCall \n   * @returns \n   */\n  getXcmFees = async (address, xcmpCall) => {\n    const fakeSignedXcmpCall = xcmpCall.signFake(address, {\n      blockHash: this.api.genesisHash,\n      genesisHash: this.api.genesisHash,\n      nonce: 100, // does not except negative?\n      runtimeVersion: this.api.runtimeVersion,\n    });\n  \n    const fees = await this.api.rpc.xcmpHandler.fees(fakeSignedXcmpCall.toHex());\n    return fees;\n  }\n\n  xcmSend = async (dest, message) => {\n    console.log(\"xcmSend,\",dest,message);\n\n    return new Promise(async (resolve) => {\n      const unsub = await this.api.tx.polkadotXcm.send(dest, message).signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n}\n\n  sendXcmExtrinsic = async (xcmpCall, keyPair, taskId) => {\n    return new Promise(async (resolve) => {\n      const unsub = await xcmpCall.signAndSend(keyPair, { nonce: -1 }, async ({ status }) => {\n        if (status.isInBlock) {\n          console.log('Successful with hash ' + status.asInBlock.toHex());\n  \n          // Get Task\n          const task = await this.api.query.automationTime.accountTasks(keyPair.address, taskId);\n          console.log(\"Task:\", task.toHuman());\n  \n          unsub();\n          resolve();\n        } else {\n          console.log('Status: ' + status.type);\n        }\n      });\n    });\n  }\n}\n\nexport default new TuringHelper();"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAAuB;AAEvB,MAAMA,cAAc,GAAG,IAAI;AAC3B,MAAMC,YAAY,GAAG,EAAE;AACvB,MAAMC,eAAe,GAAGC,OAAO,CAACC,GAAG,CAACF,eAAe;AAEnD,MAAMG,OAAO,GAAG;EACdC,GAAG,EAAE,qBAAqB;EAC1BC,GAAG,EAAE,eAAe;EACpBC,GAAG,EAAE;AACP,CAAC;AAED,MAAMC,YAAY,CAAC;EACjBC,UAAU,GAAG,MAAOC,QAAQ,IAAK;IAC/B,MAAMC,GAAG,GAAG,MAAMC,eAAU,CAACC,MAAM,CAAC;MAAEC,QAAQ,EAAE,IAAIC,eAAU,CAACL,QAAQ,CAAC;MAAEM,GAAG,EAAHA;IAAI,CAAC,CAAC;IAClF,IAAI,CAACL,GAAG,GAAGA,GAAG;EACd,CAAC;EAEDM,MAAM,GAAG,MAAM,IAAI,CAACN,GAAG;EAEvBO,UAAU,GAAG,MAAMC,OAAO,IAAG;IAC3B;IACA,MAAM;MAAEC,IAAI,EAAEC;IAAQ,CAAC,GAAG,MAAM,IAAI,CAACV,GAAG,CAACW,KAAK,CAACC,MAAM,CAACC,OAAO,CAACL,OAAO,CAAC;IAEtE,OAAOE,OAAO;EAChB,CAAC;EAEDI,sBAAsB,GAAIN,OAAO,IAAK;IACpC,MAAMO,OAAO,GAAG,IAAIC,YAAO,EAAE;IAC7B,MAAMC,cAAc,GAAGF,OAAO,CAACG,aAAa,CAACV,OAAO,EAAEnB,YAAY,CAAC;IAEnE,MAAM8B,QAAQ,GAAG;MACfC,OAAO,EAAE,CAAC;MACVC,QAAQ,EAAE;QACRC,EAAE,EAAE,CACF;UAAEC,SAAS,EAAEjC;QAAgB,CAAC,EAC9B;UACEkC,WAAW,EAAE;YACXC,OAAO,EAAE,KAAK;YACdC,EAAE,EAAEX,OAAO,CAACY,aAAa,CAACV,cAAc;UAC1C;QACF,CAAC;MAEL;IACF,CAAC;IAED,MAAMW,aAAa,GAAG,IAAI,CAAC5B,GAAG,CAAC6B,UAAU,CAAC,oBAAoB,EAAEV,QAAQ,CAAC;IAEzE,MAAMW,MAAM,GAAG,IAAIC,UAAU,CAAC,CAC5B,GAAG,IAAIA,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,EACvB,GAAG,IAAIC,WAAW,EAAE,CAACC,MAAM,CAAC,UAAU,CAAC,EACvC,GAAGL,aAAa,CAACM,KAAK,EAAE,CACzB,CAAC;IAEF,MAAMC,YAAY,GAAG,IAAAC,cAAQ,EAAC,IAAI,CAACpC,GAAG,CAACqC,QAAQ,CAACC,IAAI,CAACR,MAAM,CAAC,CAACS,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAC1E,OAAOJ,YAAY;EACrB,CAAC;;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEK,UAAU,GAAG,OAAOhC,OAAO,EAAEiC,QAAQ,KAAK;IACxC,MAAMC,kBAAkB,GAAGD,QAAQ,CAACE,QAAQ,CAACnC,OAAO,EAAE;MACpDoC,SAAS,EAAE,IAAI,CAAC5C,GAAG,CAAC6C,WAAW;MAC/BA,WAAW,EAAE,IAAI,CAAC7C,GAAG,CAAC6C,WAAW;MACjCC,KAAK,EAAE,GAAG;MAAE;MACZC,cAAc,EAAE,IAAI,CAAC/C,GAAG,CAAC+C;IAC3B,CAAC,CAAC;IAEF,MAAMC,IAAI,GAAG,MAAM,IAAI,CAAChD,GAAG,CAACK,GAAG,CAAC4C,WAAW,CAACD,IAAI,CAACN,kBAAkB,CAACQ,KAAK,EAAE,CAAC;IAC5E,OAAOF,IAAI;EACb,CAAC;EAEDG,OAAO,GAAG,OAAOC,IAAI,EAAEC,OAAO,KAAK;IACjCC,OAAO,CAACC,GAAG,CAAC,UAAU,EAACH,IAAI,EAACC,OAAO,CAAC;IAEpC,OAAO,IAAIG,OAAO,CAAC,MAAOC,OAAO,IAAK;MACpC,MAAMC,KAAK,GAAG,MAAM,IAAI,CAAC1D,GAAG,CAAC2D,EAAE,CAACC,WAAW,CAACC,IAAI,CAACT,IAAI,EAAEC,OAAO,CAAC,CAACS,WAAW,CAACC,OAAO,EAAE;QAAEjB,KAAK,EAAE,CAAC;MAAE,CAAC,EAAE,OAAO;QAAEkB;MAAO,CAAC,KAAK;QACxH,IAAIA,MAAM,CAACC,SAAS,EAAE;UACpBX,OAAO,CAACC,GAAG,CAAC,uBAAuB,GAAGS,MAAM,CAACE,SAAS,CAAChB,KAAK,EAAE,CAAC;UAE/DQ,KAAK,EAAE;UACPD,OAAO,EAAE;QACX,CAAC,MAAM;UACLH,OAAO,CAACC,GAAG,CAAC,UAAU,GAAGS,MAAM,CAACG,IAAI,CAAC;QACvC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACN,CAAC;EAECC,gBAAgB,GAAG,OAAO3B,QAAQ,EAAEsB,OAAO,EAAEM,MAAM,KAAK;IACtD,OAAO,IAAIb,OAAO,CAAC,MAAOC,OAAO,IAAK;MACpC,MAAMC,KAAK,GAAG,MAAMjB,QAAQ,CAACqB,WAAW,CAACC,OAAO,EAAE;QAAEjB,KAAK,EAAE,CAAC;MAAE,CAAC,EAAE,OAAO;QAAEkB;MAAO,CAAC,KAAK;QACrF,IAAIA,MAAM,CAACC,SAAS,EAAE;UACpBX,OAAO,CAACC,GAAG,CAAC,uBAAuB,GAAGS,MAAM,CAACE,SAAS,CAAChB,KAAK,EAAE,CAAC;;UAE/D;UACA,MAAMoB,IAAI,GAAG,MAAM,IAAI,CAACtE,GAAG,CAACW,KAAK,CAAC4D,cAAc,CAACC,YAAY,CAACT,OAAO,CAACvD,OAAO,EAAE6D,MAAM,CAAC;UACtFf,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEe,IAAI,CAACG,OAAO,EAAE,CAAC;UAEpCf,KAAK,EAAE;UACPD,OAAO,EAAE;QACX,CAAC,MAAM;UACLH,OAAO,CAACC,GAAG,CAAC,UAAU,GAAGS,MAAM,CAACG,IAAI,CAAC;QACvC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;AACH;AAAC,eAEc,IAAItE,YAAY,EAAE;AAAA"}},"mtime":1668986832751},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/mangataHelper.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _utils = require(\"./utils\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass MangataHelper {\n  initialize = async mangataEndpoint => {\n    const mangata = _sdk.Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n    this.mangata = mangata;\n    this.api = mangataApi;\n    const assetsResp = await this.mangata.getAssetsInfo();\n    this.assets = _lodash.default.values(_lodash.default.filter(assetsResp, asset => !_lodash.default.isEmpty(asset.symbol)));\n    console.log(\"Assets on Mangata chain: \", this.assets);\n    /**\n    [\n      {\"id\":\"0\",\"chainId\":0,\"decimals\":18,\"name\":\"Mangata\",\"symbol\":\"MGR\",\"address\":\"\"},\n      {\"id\":\"4\",\"chainId\":0,\"decimals\":12,\"name\":\"Rococo  Native\",\"symbol\":\"ROC\",\"address\":\"\"},\n      {\"id\":\"7\",\"chainId\":0,\"decimals\":10,\"name\":\"Turing native token\",\"symbol\":\"TUR\",\"address\":\"\"}\n    ]\n     */\n  };\n\n  getBalance = async (symbol, address) => {\n    const tokenId = _lodash.default.find(this.assets, {\n      symbol\n    }).id;\n    const balance = await this.mangata.getTokenBalance(tokenId, address);\n    return balance;\n  };\n  getProxyAccount = address => {\n    const decodedAddress = (0, _utilCrypto.decodeAddress)(address); // An Int array presentation of the address ss58 public key\n\n    const location = {\n      parents: 1,\n      // From Turing to Mangata\n      interior: {\n        X2: [{\n          Parachain: TURING_PARA_ID\n        }, {\n          AccountId32: {\n            network: \"Any\",\n            id: (0, _util.u8aToHex)(decodedAddress)\n          }\n        }]\n      }\n    };\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n    console.log(\"multilocation\", multilocation.toString());\n    const toHash = new Uint8Array([...new Uint8Array([32]), ...new TextEncoder().encode(\"multiloc\"), ...multilocation.toU8a()]);\n    const DescendOriginAddress32 = (0, _util.u8aToHex)(this.api.registry.hash(toHash).slice(0, 32));\n    return DescendOriginAddress32;\n  };\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n  mintToken = async (address, symbol, keyring, amount = 5000000000000000) => {\n    const tokenId = _lodash.default.find(this.assets, {\n      symbol\n    }).id;\n    const mintTokenExtrinsic = this.api.tx.tokens.mint(tokenId, address, amount);\n    await (0, _utils.sendExtrinsic)(this.api, mintTokenExtrinsic, keyring, {\n      isSudo: true\n    });\n  };\n  createPool = async (firstSymbol, secondSymbol, keyring) => {\n    const firstTokenId = _lodash.default.find(this.assets, {\n      symbol: firstSymbol\n    }).id;\n    const secondTokenId = _lodash.default.find(this.assets, {\n      symbol: secondSymbol\n    }).id;\n    return new Promise(resolve => {\n      this.mangata.createPool(keyring, firstTokenId.toString(), new _bn.default('10000000000000000000000'),\n      // 10000 MGR (MGR is 18 decimals)\n      secondTokenId.toString(), new _bn.default('100000000000000'),\n      // 100 TUR (TUR is 12 decimals)\n      {\n        statusCallback: result => {\n          // result is of the form ISubmittableResult\n          console.log(\"call back result\", result);\n          console.log(\"call back result type\", result.status.type);\n        },\n        extrinsicStatus: result => {\n          // result is of the form MangataGenericEvent[]\n          for (let index = 0; index < result.length; index++) {\n            console.log('Phase', result[index].phase.toString());\n            console.log('Section', result[index].section);\n            console.log('Method', result[index].method);\n            console.log('Documentation', result[index].metaDocumentation);\n          }\n        }\n      });\n    });\n  };\n  getPools = async () => {\n    return this.mangata.getPools();\n  };\n}\nvar _default = new MangataHelper();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUVVJJTkdfUEFSQV9JRCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdSIiwiS1NNIiwiVFVSIiwiTWFuZ2F0YUhlbHBlciIsImluaXRpYWxpemUiLCJtYW5nYXRhRW5kcG9pbnQiLCJtYW5nYXRhIiwiTWFuZ2F0YSIsImdldEluc3RhbmNlIiwibWFuZ2F0YUFwaSIsImdldEFwaSIsImFwaSIsImFzc2V0c1Jlc3AiLCJnZXRBc3NldHNJbmZvIiwiYXNzZXRzIiwiXyIsInZhbHVlcyIsImZpbHRlciIsImFzc2V0IiwiaXNFbXB0eSIsInN5bWJvbCIsImNvbnNvbGUiLCJsb2ciLCJnZXRCYWxhbmNlIiwiYWRkcmVzcyIsInRva2VuSWQiLCJmaW5kIiwiaWQiLCJiYWxhbmNlIiwiZ2V0VG9rZW5CYWxhbmNlIiwiZ2V0UHJveHlBY2NvdW50IiwiZGVjb2RlZEFkZHJlc3MiLCJkZWNvZGVBZGRyZXNzIiwibG9jYXRpb24iLCJwYXJlbnRzIiwiaW50ZXJpb3IiLCJYMiIsIlBhcmFjaGFpbiIsIkFjY291bnRJZDMyIiwibmV0d29yayIsInU4YVRvSGV4IiwibXVsdGlsb2NhdGlvbiIsImNyZWF0ZVR5cGUiLCJ0b1N0cmluZyIsInRvSGFzaCIsIlVpbnQ4QXJyYXkiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsInRvVThhIiwiRGVzY2VuZE9yaWdpbkFkZHJlc3MzMiIsInJlZ2lzdHJ5IiwiaGFzaCIsInNsaWNlIiwiYWRkUHJveHkiLCJwcm94eUFjY291bnQiLCJrZXlQYWlyIiwidHgiLCJwcm94eSIsInNpZ25BbmRTZW5kIiwiY3JlYXRlUHJveHlDYWxsIiwiZXh0cmluc2ljIiwibWludFRva2VuIiwia2V5cmluZyIsImFtb3VudCIsIm1pbnRUb2tlbkV4dHJpbnNpYyIsInRva2VucyIsIm1pbnQiLCJzZW5kRXh0cmluc2ljIiwiaXNTdWRvIiwiY3JlYXRlUG9vbCIsImZpcnN0U3ltYm9sIiwic2Vjb25kU3ltYm9sIiwiZmlyc3RUb2tlbklkIiwic2Vjb25kVG9rZW5JZCIsIlByb21pc2UiLCJyZXNvbHZlIiwiQk4iLCJzdGF0dXNDYWxsYmFjayIsInJlc3VsdCIsInN0YXR1cyIsInR5cGUiLCJleHRyaW5zaWNTdGF0dXMiLCJpbmRleCIsImxlbmd0aCIsInBoYXNlIiwic2VjdGlvbiIsIm1ldGhvZCIsIm1ldGFEb2N1bWVudGF0aW9uIiwiZ2V0UG9vbHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9taWthc2EvQ29kZS94Y20tZGVtby9zcmMvY29tbW9uLyIsInNvdXJjZXMiOlsibWFuZ2F0YUhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYW5nYXRhIH0gZnJvbSAnQG1hbmdhdGEtZmluYW5jZS9zZGsnO1xuaW1wb3J0IHsgQXBpUHJvbWlzZSwgV3NQcm92aWRlciwgS2V5cmluZyB9IGZyb20gXCJAcG9sa2Fkb3QvYXBpXCI7XG5pbXBvcnQgeyB1OGFUb0hleCB9IGZyb20gXCJAcG9sa2Fkb3QvdXRpbFwiO1xuaW1wb3J0IHsgZGVjb2RlQWRkcmVzcyB9IGZyb20gJ0Bwb2xrYWRvdC91dGlsLWNyeXB0byc7XG5pbXBvcnQgQk4gZnJvbSAnYm4uanMnO1xuaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0IHsgc2VuZEV4dHJpbnNpYyB9IGZyb20gJy4vdXRpbHMnO1xuXG5jb25zdCBUVVJJTkdfUEFSQV9JRCA9IDIxMTQ7XG5jb25zdCBNQU5HQVRBX1BBUkFfSUQgPSBwcm9jZXNzLmVudi5NQU5HQVRBX1BBUkFfSUQ7XG5cbmNvbnN0IERFQ0lNQUwgPSB7XG4gIE1HUjogJzEwMDAwMDAwMDAwMDAwMDAwMDAnLFxuICBLU006ICcxMDAwMDAwMDAwMDAwJyxcbiAgVFVSOiAnMTAwMDAwMDAwMDAnLFxufTtcbmNsYXNzIE1hbmdhdGFIZWxwZXIge1xuICBpbml0aWFsaXplID0gYXN5bmMgKG1hbmdhdGFFbmRwb2ludCkgPT4ge1xuICAgIGNvbnN0IG1hbmdhdGEgPSBNYW5nYXRhLmdldEluc3RhbmNlKFttYW5nYXRhRW5kcG9pbnRdKTtcbiAgICBjb25zdCBtYW5nYXRhQXBpID0gYXdhaXQgbWFuZ2F0YS5nZXRBcGkoKTtcblxuICAgIHRoaXMubWFuZ2F0YSA9IG1hbmdhdGE7XG4gICAgdGhpcy5hcGkgPSBtYW5nYXRhQXBpO1xuXG4gICAgY29uc3QgYXNzZXRzUmVzcCA9IGF3YWl0IHRoaXMubWFuZ2F0YS5nZXRBc3NldHNJbmZvKCk7XG4gICAgdGhpcy5hc3NldHM9Xy52YWx1ZXMoXy5maWx0ZXIoYXNzZXRzUmVzcCwgYXNzZXQ9PiAhXy5pc0VtcHR5KGFzc2V0LnN5bWJvbCkpKTtcbiAgICBjb25zb2xlLmxvZyhcIkFzc2V0cyBvbiBNYW5nYXRhIGNoYWluOiBcIiwgdGhpcy5hc3NldHMpO1xuICAgIC8qKlxuICAgIFtcbiAgICAgIHtcImlkXCI6XCIwXCIsXCJjaGFpbklkXCI6MCxcImRlY2ltYWxzXCI6MTgsXCJuYW1lXCI6XCJNYW5nYXRhXCIsXCJzeW1ib2xcIjpcIk1HUlwiLFwiYWRkcmVzc1wiOlwiXCJ9LFxuICAgICAge1wiaWRcIjpcIjRcIixcImNoYWluSWRcIjowLFwiZGVjaW1hbHNcIjoxMixcIm5hbWVcIjpcIlJvY29jbyAgTmF0aXZlXCIsXCJzeW1ib2xcIjpcIlJPQ1wiLFwiYWRkcmVzc1wiOlwiXCJ9LFxuICAgICAge1wiaWRcIjpcIjdcIixcImNoYWluSWRcIjowLFwiZGVjaW1hbHNcIjoxMCxcIm5hbWVcIjpcIlR1cmluZyBuYXRpdmUgdG9rZW5cIixcInN5bWJvbFwiOlwiVFVSXCIsXCJhZGRyZXNzXCI6XCJcIn1cbiAgICBdXG4gICAgICovXG4gIH1cblxuICBnZXRCYWxhbmNlID0gYXN5bmMgKHN5bWJvbCwgYWRkcmVzcyApID0+IHtcbiAgICBjb25zdCB0b2tlbklkID0gKF8uZmluZCh0aGlzLmFzc2V0cywge3N5bWJvbH0pKS5pZDtcbiAgICBjb25zdCBiYWxhbmNlID0gYXdhaXQgdGhpcy5tYW5nYXRhLmdldFRva2VuQmFsYW5jZSh0b2tlbklkLCBhZGRyZXNzKTtcbiAgICByZXR1cm4gYmFsYW5jZTtcbiAgfVxuXG4gIGdldFByb3h5QWNjb3VudCA9IChhZGRyZXNzKSA9PiB7XG4gICAgY29uc3QgZGVjb2RlZEFkZHJlc3MgPSBkZWNvZGVBZGRyZXNzKGFkZHJlc3MpOyAvLyBBbiBJbnQgYXJyYXkgcHJlc2VudGF0aW9uIG9mIHRoZSBhZGRyZXNz4oCZIHNzNTggcHVibGljIGtleVxuICAgIFxuICAgIGNvbnN0IGxvY2F0aW9uID0ge1xuICAgICAgcGFyZW50czogMSwgLy8gRnJvbSBUdXJpbmcgdG8gTWFuZ2F0YVxuICAgICAgaW50ZXJpb3I6IHtcbiAgICAgICAgWDI6IFtcbiAgICAgICAgICB7IFBhcmFjaGFpbjogVFVSSU5HX1BBUkFfSUQgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBBY2NvdW50SWQzMjoge1xuICAgICAgICAgICAgICBuZXR3b3JrOiBcIkFueVwiLFxuICAgICAgICAgICAgICBpZDogdThhVG9IZXgoZGVjb2RlZEFkZHJlc3MpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBtdWx0aWxvY2F0aW9uID0gdGhpcy5hcGkuY3JlYXRlVHlwZShcIlhjbVYxTXVsdGlMb2NhdGlvblwiLCBsb2NhdGlvbik7XG5cbiAgICBjb25zb2xlLmxvZyhcIm11bHRpbG9jYXRpb25cIiwgbXVsdGlsb2NhdGlvbi50b1N0cmluZygpKTtcblxuICAgIGNvbnN0IHRvSGFzaCA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgIC4uLm5ldyBVaW50OEFycmF5KFszMl0pLFxuICAgICAgLi4ubmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwibXVsdGlsb2NcIiksXG4gICAgICAuLi5tdWx0aWxvY2F0aW9uLnRvVThhKCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBEZXNjZW5kT3JpZ2luQWRkcmVzczMyID0gdThhVG9IZXgodGhpcy5hcGkucmVnaXN0cnkuaGFzaCh0b0hhc2gpLnNsaWNlKDAsIDMyKSk7XG5cbiAgICByZXR1cm4gRGVzY2VuZE9yaWdpbkFkZHJlc3MzMjtcbiAgfVxuXG4gIGFkZFByb3h5ID0gYXN5bmMgKHByb3h5QWNjb3VudCwga2V5UGFpcikgPT4gdGhpcy5hcGkudHgucHJveHkuYWRkUHJveHkocHJveHlBY2NvdW50LCBcIkFueVwiLCAwKS5zaWduQW5kU2VuZChrZXlQYWlyKTtcblxuICBjcmVhdGVQcm94eUNhbGwgPSBhc3luYyAoYWRkcmVzcywgZXh0cmluc2ljKSA9PiB0aGlzLmFwaS50eC5wcm94eS5wcm94eShhZGRyZXNzLCAnQW55JywgZXh0cmluc2ljKTtcblxuICBtaW50VG9rZW4gPSBhc3luYyhhZGRyZXNzLCBzeW1ib2wsIGtleXJpbmcsIGFtb3VudD01MDAwMDAwMDAwMDAwMDAwKT0+e1xuICAgIGNvbnN0IHRva2VuSWQgPSAoXy5maW5kKHRoaXMuYXNzZXRzLCB7c3ltYm9sfSkpLmlkO1xuICAgIGNvbnN0IG1pbnRUb2tlbkV4dHJpbnNpYyA9IHRoaXMuYXBpLnR4LnRva2Vucy5taW50KHRva2VuSWQsIGFkZHJlc3MsIGFtb3VudCk7XG4gICAgYXdhaXQgc2VuZEV4dHJpbnNpYyh0aGlzLmFwaSwgbWludFRva2VuRXh0cmluc2ljLCBrZXlyaW5nLCB7IGlzU3VkbzogdHJ1ZSB9KTtcbiAgfVxuXG4gIGNyZWF0ZVBvb2wgPSBhc3luYyAoZmlyc3RTeW1ib2wsIHNlY29uZFN5bWJvbCwga2V5cmluZykgPT4ge1xuICAgIGNvbnN0IGZpcnN0VG9rZW5JZCA9IChfLmZpbmQodGhpcy5hc3NldHMsIHtzeW1ib2w6IGZpcnN0U3ltYm9sfSkpLmlkO1xuICAgIGNvbnN0IHNlY29uZFRva2VuSWQgPSAoXy5maW5kKHRoaXMuYXNzZXRzLCB7c3ltYm9sOiBzZWNvbmRTeW1ib2x9KSkuaWQ7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHRoaXMubWFuZ2F0YS5jcmVhdGVQb29sKFxuICAgICAgICBrZXlyaW5nLFxuICAgICAgICBmaXJzdFRva2VuSWQudG9TdHJpbmcoKSxcbiAgICAgICAgbmV3IEJOKCcxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCcpLCAvLyAxMDAwMCBNR1IgKE1HUiBpcyAxOCBkZWNpbWFscylcbiAgICAgICAgc2Vjb25kVG9rZW5JZC50b1N0cmluZygpLFxuICAgICAgICBuZXcgQk4oJzEwMDAwMDAwMDAwMDAwMCcpLCAvLyAxMDAgVFVSIChUVVIgaXMgMTIgZGVjaW1hbHMpXG4gICAgICAgIHtcbiAgICAgICAgICBzdGF0dXNDYWxsYmFjazogKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgLy8gcmVzdWx0IGlzIG9mIHRoZSBmb3JtIElTdWJtaXR0YWJsZVJlc3VsdFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYWxsIGJhY2sgcmVzdWx0XCIsIHJlc3VsdCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhbGwgYmFjayByZXN1bHQgdHlwZVwiLCByZXN1bHQuc3RhdHVzLnR5cGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXh0cmluc2ljU3RhdHVzOiAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAvLyByZXN1bHQgaXMgb2YgdGhlIGZvcm0gTWFuZ2F0YUdlbmVyaWNFdmVudFtdXG4gICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzdWx0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1BoYXNlJywgcmVzdWx0W2luZGV4XS5waGFzZS50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlY3Rpb24nLCByZXN1bHRbaW5kZXhdLnNlY3Rpb24pXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWV0aG9kJywgcmVzdWx0W2luZGV4XS5tZXRob2QpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRG9jdW1lbnRhdGlvbicsIHJlc3VsdFtpbmRleF0ubWV0YURvY3VtZW50YXRpb24pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG4gIH1cblxuICBnZXRQb29scyA9IGFzeW5jKCkgPT57XG4gICAgcmV0dXJuIHRoaXMubWFuZ2F0YS5nZXRQb29scygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBNYW5nYXRhSGVscGVyKCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUF3QztBQUV4QyxNQUFNQSxjQUFjLEdBQUcsSUFBSTtBQUMzQixNQUFNQyxlQUFlLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixlQUFlO0FBRW5ELE1BQU1HLE9BQU8sR0FBRztFQUNkQyxHQUFHLEVBQUUscUJBQXFCO0VBQzFCQyxHQUFHLEVBQUUsZUFBZTtFQUNwQkMsR0FBRyxFQUFFO0FBQ1AsQ0FBQztBQUNELE1BQU1DLGFBQWEsQ0FBQztFQUNsQkMsVUFBVSxHQUFHLE1BQU9DLGVBQWUsSUFBSztJQUN0QyxNQUFNQyxPQUFPLEdBQUdDLFlBQU8sQ0FBQ0MsV0FBVyxDQUFDLENBQUNILGVBQWUsQ0FBQyxDQUFDO0lBQ3RELE1BQU1JLFVBQVUsR0FBRyxNQUFNSCxPQUFPLENBQUNJLE1BQU0sRUFBRTtJQUV6QyxJQUFJLENBQUNKLE9BQU8sR0FBR0EsT0FBTztJQUN0QixJQUFJLENBQUNLLEdBQUcsR0FBR0YsVUFBVTtJQUVyQixNQUFNRyxVQUFVLEdBQUcsTUFBTSxJQUFJLENBQUNOLE9BQU8sQ0FBQ08sYUFBYSxFQUFFO0lBQ3JELElBQUksQ0FBQ0MsTUFBTSxHQUFDQyxlQUFDLENBQUNDLE1BQU0sQ0FBQ0QsZUFBQyxDQUFDRSxNQUFNLENBQUNMLFVBQVUsRUFBRU0sS0FBSyxJQUFHLENBQUNILGVBQUMsQ0FBQ0ksT0FBTyxDQUFDRCxLQUFLLENBQUNFLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDNUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDJC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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_PARA_ID","process","env","DECIMAL","MGR","KSM","TUR","MangataHelper","initialize","mangataEndpoint","mangata","Mangata","getInstance","mangataApi","getApi","api","assetsResp","getAssetsInfo","assets","_","values","filter","asset","isEmpty","symbol","console","log","getBalance","address","tokenId","find","id","balance","getTokenBalance","getProxyAccount","decodedAddress","decodeAddress","location","parents","interior","X2","Parachain","AccountId32","network","u8aToHex","multilocation","createType","toString","toHash","Uint8Array","TextEncoder","encode","toU8a","DescendOriginAddress32","registry","hash","slice","addProxy","proxyAccount","keyPair","tx","proxy","signAndSend","createProxyCall","extrinsic","mintToken","keyring","amount","mintTokenExtrinsic","tokens","mint","sendExtrinsic","isSudo","createPool","firstSymbol","secondSymbol","firstTokenId","secondTokenId","Promise","resolve","BN","statusCallback","result","status","type","extrinsicStatus","index","length","phase","section","method","metaDocumentation","getPools"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["mangataHelper.js"],"sourcesContent":["import { Mangata } from '@mangata-finance/sdk';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { decodeAddress } from '@polkadot/util-crypto';\nimport BN from 'bn.js';\nimport _ from \"lodash\";\nimport { sendExtrinsic } from './utils';\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\nclass MangataHelper {\n  initialize = async (mangataEndpoint) => {\n    const mangata = Mangata.getInstance([mangataEndpoint]);\n    const mangataApi = await mangata.getApi();\n\n    this.mangata = mangata;\n    this.api = mangataApi;\n\n    const assetsResp = await this.mangata.getAssetsInfo();\n    this.assets=_.values(_.filter(assetsResp, asset=> !_.isEmpty(asset.symbol)));\n    console.log(\"Assets on Mangata chain: \", this.assets);\n    /**\n    [\n      {\"id\":\"0\",\"chainId\":0,\"decimals\":18,\"name\":\"Mangata\",\"symbol\":\"MGR\",\"address\":\"\"},\n      {\"id\":\"4\",\"chainId\":0,\"decimals\":12,\"name\":\"Rococo  Native\",\"symbol\":\"ROC\",\"address\":\"\"},\n      {\"id\":\"7\",\"chainId\":0,\"decimals\":10,\"name\":\"Turing native token\",\"symbol\":\"TUR\",\"address\":\"\"}\n    ]\n     */\n  }\n\n  getBalance = async (symbol, address ) => {\n    const tokenId = (_.find(this.assets, {symbol})).id;\n    const balance = await this.mangata.getTokenBalance(tokenId, address);\n    return balance;\n  }\n\n  getProxyAccount = (address) => {\n    const decodedAddress = decodeAddress(address); // An Int array presentation of the address ss58 public key\n    \n    const location = {\n      parents: 1, // From Turing to Mangata\n      interior: {\n        X2: [\n          { Parachain: TURING_PARA_ID },\n          {\n            AccountId32: {\n              network: \"Any\",\n              id: u8aToHex(decodedAddress),\n            }\n          }\n        ]\n      }\n    };\n\n    const multilocation = this.api.createType(\"XcmV1MultiLocation\", location);\n\n    console.log(\"multilocation\", multilocation.toString());\n\n    const toHash = new Uint8Array([\n      ...new Uint8Array([32]),\n      ...new TextEncoder().encode(\"multiloc\"),\n      ...multilocation.toU8a(),\n    ]);\n\n    const DescendOriginAddress32 = u8aToHex(this.api.registry.hash(toHash).slice(0, 32));\n\n    return DescendOriginAddress32;\n  }\n\n  addProxy = async (proxyAccount, keyPair) => this.api.tx.proxy.addProxy(proxyAccount, \"Any\", 0).signAndSend(keyPair);\n\n  createProxyCall = async (address, extrinsic) => this.api.tx.proxy.proxy(address, 'Any', extrinsic);\n\n  mintToken = async(address, symbol, keyring, amount=5000000000000000)=>{\n    const tokenId = (_.find(this.assets, {symbol})).id;\n    const mintTokenExtrinsic = this.api.tx.tokens.mint(tokenId, address, amount);\n    await sendExtrinsic(this.api, mintTokenExtrinsic, keyring, { isSudo: true });\n  }\n\n  createPool = async (firstSymbol, secondSymbol, keyring) => {\n    const firstTokenId = (_.find(this.assets, {symbol: firstSymbol})).id;\n    const secondTokenId = (_.find(this.assets, {symbol: secondSymbol})).id;\n\n    return new Promise((resolve) => {\n      this.mangata.createPool(\n        keyring,\n        firstTokenId.toString(),\n        new BN('10000000000000000000000'), // 10000 MGR (MGR is 18 decimals)\n        secondTokenId.toString(),\n        new BN('100000000000000'), // 100 TUR (TUR is 12 decimals)\n        {\n          statusCallback: (result) => {\n            // result is of the form ISubmittableResult\n            console.log(\"call back result\", result);\n            console.log(\"call back result type\", result.status.type);\n          },\n          extrinsicStatus: (result) => {\n            // result is of the form MangataGenericEvent[]\n            for (let index = 0; index < result.length; index++) {\n                  console.log('Phase', result[index].phase.toString())\n                  console.log('Section', result[index].section)\n                  console.log('Method', result[index].method)\n                  console.log('Documentation', result[index].metaDocumentation)\n                }\n          },\n        }\n      );\n    });\n  }\n\n  getPools = async() =>{\n    return this.mangata.getPools();\n  }\n}\n\nexport default new MangataHelper();"],"mappings":"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"}},"mtime":1668990774230},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/account.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nvar _turingHelper = _interopRequireDefault(require(\"./turingHelper\"));\nvar _mangataHelper = _interopRequireDefault(require(\"./mangataHelper\"));\nvar _constants = require(\"./constants\");\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _util2 = _interopRequireDefault(require(\"util\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass Account {\n  constructor(name) {\n    this.name = name;\n    const keyring = new _api.Keyring();\n    this.account = keyring.addFromUri(`//${name}`, undefined, 'sr25519');\n    this.publicKey = this.account.address;\n    const mangataAddress = keyring.encodeAddress(this.publicKey, _constants.chainConfig.mangata.ss58);\n    this.assets = [{\n      chain: \"rococo\",\n      address: keyring.encodeAddress(this.publicKey, _constants.chainConfig.rococo.ss58)\n    }, {\n      chain: \"mangata\",\n      address: mangataAddress,\n      proxyAddress: _mangataHelper.default.getProxyAccount(mangataAddress),\n      tokens: []\n    }, {\n      chain: \"turing\",\n      address: keyring.encodeAddress(this.publicKey, _constants.chainConfig.turing.ss58),\n      tokens: []\n    }];\n  }\n  async init() {\n    const mangataAssets = _lodash.default.find(this.assets, {\n      chain: \"mangata\"\n    });\n    console.log(\"mangataHelper.assets\", _mangataHelper.default.assets);\n    const balancePromises = _lodash.default.map(_mangataHelper.default.assets, async asset => {\n      const {\n        symbol\n      } = asset;\n      console.log(\"symbol\", symbol);\n      const mangataBalance = await _mangataHelper.default.getBalance(symbol, mangataAssets.address);\n      console.log(\"mangataBalance\", mangataBalance);\n      const decimal = _constants.tokenConfig[symbol].decimal;\n      console.log(\"mangataBalance\", mangataBalance);\n      console.log(mangataAssets);\n      mangataAssets.tokens.push({\n        \"symbol\": symbol,\n        balance: mangataBalance.free,\n        balanceFloat: mangataBalance.free.div(new _bn.default(decimal)).toNumber()\n      });\n      console.log(mangataAssets);\n    });\n    await Promise.all(balancePromises);\n    const turing = _lodash.default.find(this.assets, {\n      chain: \"turing\"\n    });\n    const balance = await _turingHelper.default.getBalance(turing.address);\n    const decimal = _constants.tokenConfig['TUR'].decimal;\n    turing.tokens.push({\n      symbol: 'TUR',\n      balance: balance.free,\n      balanceFloat: balance.free.div(new _bn.default(decimal)).toNumber()\n    });\n\n    // Create key names for easy access\n    this.assets.mangata = this.assets[1];\n    this.assets.turing = this.assets[2];\n  }\n  print() {\n    console.log(_util2.default.inspect(this.assets, {\n      depth: 4,\n      colors: true\n    }));\n  }\n}\nvar _default = Account;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUVVJJTkdfUEFSQV9JRCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdSIiwiS1NNIiwiVFVSIiwiQWNjb3VudCIsImNvbnN0cnVjdG9yIiwibmFtZSIsImtleXJpbmciLCJLZXlyaW5nIiwiYWNjb3VudCIsImFkZEZyb21VcmkiLCJ1bmRlZmluZWQiLCJwdWJsaWNLZXkiLCJhZGRyZXNzIiwibWFuZ2F0YUFkZHJlc3MiLCJlbmNvZGVBZGRyZXNzIiwiY2hhaW5Db25maWciLCJtYW5nYXRhIiwic3M1OCIsImFzc2V0cyIsImNoYWluIiwicm9jb2NvIiwicHJveHlBZGRyZXNzIiwibWFuZ2F0YUhlbHBlciIsImdldFByb3h5QWNjb3VudCIsInRva2VucyIsInR1cmluZyIsImluaXQiLCJtYW5nYXRhQXNzZXRzIiwiXyIsImZpbmQiLCJjb25zb2xlIiwibG9nIiwiYmFsYW5jZVByb21pc2VzIiwibWFwIiwiYXNzZXQiLCJzeW1ib2wiLCJtYW5nYXRhQmFsYW5jZSIsImdldEJhbGFuY2UiLCJkZWNpbWFsIiwidG9rZW5Db25maWciLCJwdXNoIiwiYmFsYW5jZSIsImZyZWUiLCJiYWxhbmNlRmxvYXQiLCJkaXYiLCJCTiIsInRvTnVtYmVyIiwiUHJvbWlzZSIsImFsbCIsInR1cmluZ0hlbHBlciIsInByaW50IiwidXRpbCIsImluc3BlY3QiLCJkZXB0aCIsImNvbG9ycyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL21pa2FzYS9Db2RlL3hjbS1kZW1vL3NyYy9jb21tb24vIiwic291cmNlcyI6WyJhY2NvdW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1hbmdhdGEgfSBmcm9tICdAbWFuZ2F0YS1maW5hbmNlL3Nkayc7XG5pbXBvcnQgeyBBcGlQcm9taXNlLCBXc1Byb3ZpZGVyLCBLZXlyaW5nIH0gZnJvbSBcIkBwb2xrYWRvdC9hcGlcIjtcbmltcG9ydCB7IHU4YVRvSGV4IH0gZnJvbSBcIkBwb2xrYWRvdC91dGlsXCI7XG5pbXBvcnQgeyBkZWNvZGVBZGRyZXNzIH0gZnJvbSAnQHBvbGthZG90L3V0aWwtY3J5cHRvJztcbmltcG9ydCBCTiBmcm9tICdibi5qcyc7XG5pbXBvcnQgdHVyaW5nSGVscGVyIGZyb20gXCIuL3R1cmluZ0hlbHBlclwiO1xuaW1wb3J0IG1hbmdhdGFIZWxwZXIgZnJvbSBcIi4vbWFuZ2F0YUhlbHBlclwiO1xuaW1wb3J0IHsgY2hhaW5Db25maWcsIHRva2VuQ29uZmlnIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB1dGlsIGZyb20gXCJ1dGlsXCI7XG5cbmNvbnN0IFRVUklOR19QQVJBX0lEID0gMjExNDtcbmNvbnN0IE1BTkdBVEFfUEFSQV9JRCA9IHByb2Nlc3MuZW52Lk1BTkdBVEFfUEFSQV9JRDtcblxuY29uc3QgREVDSU1BTCA9IHtcbiAgTUdSOiAnMTAwMDAwMDAwMDAwMDAwMDAwMCcsXG4gIEtTTTogJzEwMDAwMDAwMDAwMDAnLFxuICBUVVI6ICcxMDAwMDAwMDAwMCcsXG59O1xuXG5jbGFzcyBBY2NvdW50IHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIGNvbnN0IGtleXJpbmcgPSBuZXcgS2V5cmluZygpO1xuICAgICAgICB0aGlzLmFjY291bnQgPSBrZXlyaW5nLmFkZEZyb21VcmkoYC8vJHtuYW1lfWAsIHVuZGVmaW5lZCwgJ3NyMjU1MTknKTtcbiAgICAgICAgdGhpcy5wdWJsaWNLZXk9IHRoaXMuYWNjb3VudC5hZGRyZXNzO1xuXG4gICAgICAgIGNvbnN0IG1hbmdhdGFBZGRyZXNzID0ga2V5cmluZy5lbmNvZGVBZGRyZXNzKHRoaXMucHVibGljS2V5LCBjaGFpbkNvbmZpZy5tYW5nYXRhLnNzNTgpO1xuXG4gICAgICAgIHRoaXMuYXNzZXRzPVtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGFpbjogXCJyb2NvY29cIixcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiBrZXlyaW5nLmVuY29kZUFkZHJlc3ModGhpcy5wdWJsaWNLZXksIGNoYWluQ29uZmlnLnJvY29jby5zczU4KSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2hhaW46IFwibWFuZ2F0YVwiLFxuICAgICAgICAgICAgICAgIGFkZHJlc3M6IG1hbmdhdGFBZGRyZXNzLFxuICAgICAgICAgICAgICAgIHByb3h5QWRkcmVzczogbWFuZ2F0YUhlbHBlci5nZXRQcm94eUFjY291bnQobWFuZ2F0YUFkZHJlc3MpLFxuICAgICAgICAgICAgICAgIHRva2VuczpbXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2hhaW46IFwidHVyaW5nXCIsXG4gICAgICAgICAgICAgICAgYWRkcmVzczoga2V5cmluZy5lbmNvZGVBZGRyZXNzKHRoaXMucHVibGljS2V5LCBjaGFpbkNvbmZpZy50dXJpbmcuc3M1OCksXG4gICAgICAgICAgICAgICAgdG9rZW5zOltdLFxuICAgICAgICAgICAgfVxuICAgICAgICBdXG4gICAgfVxuICAgIFxuICAgIGFzeW5jIGluaXQoKXtcbiAgICAgICAgY29uc3QgbWFuZ2F0YUFzc2V0cyA9IF8uZmluZCh0aGlzLmFzc2V0cywge2NoYWluOiBcIm1hbmdhdGFcIn0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwibWFuZ2F0YUhlbHBlci5hc3NldHNcIiwgbWFuZ2F0YUhlbHBlci5hc3NldHMpO1xuICAgICAgICBjb25zdCBiYWxhbmNlUHJvbWlzZXMgPSBfLm1hcChtYW5nYXRhSGVscGVyLmFzc2V0cywgYXN5bmMgKGFzc2V0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHN5bWJvbCB9ID0gYXNzZXQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInN5bWJvbFwiLCBzeW1ib2wpO1xuICAgICAgICAgICAgY29uc3QgbWFuZ2F0YUJhbGFuY2UgPSBhd2FpdCBtYW5nYXRhSGVscGVyLmdldEJhbGFuY2Uoc3ltYm9sLCBtYW5nYXRhQXNzZXRzLmFkZHJlc3MpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtYW5nYXRhQmFsYW5jZVwiLCBtYW5nYXRhQmFsYW5jZSk7XG4gICAgICAgICAgICBjb25zdCBkZWNpbWFsID0gdG9rZW5Db25maWdbc3ltYm9sXS5kZWNpbWFsO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtYW5nYXRhQmFsYW5jZVwiLCBtYW5nYXRhQmFsYW5jZSk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1hbmdhdGFBc3NldHMpO1xuICAgICAgICAgICAgbWFuZ2F0YUFzc2V0cy50b2tlbnMucHVzaChcbiAgICAgICAgICAgICAgICB7IFwic3ltYm9sXCI6c3ltYm9sLFxuICAgICAgICAgICAgICAgIGJhbGFuY2U6IG1hbmdhdGFCYWxhbmNlLmZyZWUsXG4gICAgICAgICAgICAgICAgYmFsYW5jZUZsb2F0OiBtYW5nYXRhQmFsYW5jZS5mcmVlLmRpdihuZXcgQk4oZGVjaW1hbCkpLnRvTnVtYmVyKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWFuZ2F0YUFzc2V0cyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGJhbGFuY2VQcm9taXNlcyk7XG5cbiAgICAgICAgY29uc3QgdHVyaW5nID0gXy5maW5kKHRoaXMuYXNzZXRzLCB7Y2hhaW46IFwidHVyaW5nXCJ9KTtcbiAgICAgICAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IHR1cmluZ0hlbHBlci5nZXRCYWxhbmNlKHR1cmluZy5hZGRyZXNzKTtcbiAgICAgICAgY29uc3QgZGVjaW1hbCA9IHRva2VuQ29uZmlnWydUVVInXS5kZWNpbWFsO1xuICAgICAgICB0dXJpbmcudG9rZW5zLnB1c2goeyBzeW1ib2w6J1RVUicsIGJhbGFuY2U6IGJhbGFuY2UuZnJlZSwgYmFsYW5jZUZsb2F0OiBiYWxhbmNlLmZyZWUuZGl2KG5ldyBCTihkZWNpbWFsKSkudG9OdW1iZXIoKX0pO1xuXG4gICAgICAgIC8vIENyZWF0ZSBrZXkgbmFtZXMgZm9yIGVhc3kgYWNjZXNzXG4gICAgICAgIHRoaXMuYXNzZXRzLm1hbmdhdGEgPSB0aGlzLmFzc2V0c1sxXTtcbiAgICAgICAgdGhpcy5hc3NldHMudHVyaW5nID0gdGhpcy5hc3NldHNbMl07XG4gICAgfVxuXG4gICAgcHJpbnQoKXtcbiAgICAgICAgY29uc29sZS5sb2codXRpbC5pbnNwZWN0KHRoaXMuYXNzZXRzLCB7ZGVwdGg6IDQsIGNvbG9yczogdHJ1ZX0pKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudDsiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQXdCO0FBRXhCLE1BQU1BLGNBQWMsR0FBRyxJQUFJO0FBQzNCLE1BQU1DLGVBQWUsR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNGLGVBQWU7QUFFbkQsTUFBTUcsT0FBTyxHQUFHO0VBQ2RDLEdBQUcsRUFBRSxxQkFBcUI7RUFDMUJDLEdBQUcsRUFBRSxlQUFlO0VBQ3BCQyxHQUFHLEVBQUU7QUFDUCxDQUFDO0FBRUQsTUFBTUMsT0FBTyxDQUFDO0VBQ1ZDLFdBQVcsQ0FBQ0MsSUFBSSxFQUFFO0lBQ2QsSUFBSSxDQUFDQSxJQUFJLEdBQUdBLElBQUk7SUFDaEIsTUFBTUMsT0FBTyxHQUFHLElBQUlDLFlBQU8sRUFBRTtJQUM3QixJQUFJLENBQUNDLE9BQU8sR0FBR0YsT0FBTyxDQUFDRyxVQUFVLENBQUUsS0FBSUosSUFBSyxFQUFDLEVBQUVLLFNBQVMsRUFBRSxTQUFTLENBQUM7SUFDcEUsSUFBSSxDQUFDQyxTQUFTLEdBQUUsSUFBSSxDQUFDSCxPQUFPLENBQUNJLE9BQU87SUFFcEMsTUFBTUMsY0FBYyxHQUFHUCxPQUFPLENBQUNRLGFBQWEsQ0FBQyxJQUFJLENBQUNILFNBQVMsRUFBRUksc0JBQVcsQ0FBQ0MsT0FBTyxDQUFDQyxJ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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_PARA_ID","process","env","DECIMAL","MGR","KSM","TUR","Account","constructor","name","keyring","Keyring","account","addFromUri","undefined","publicKey","address","mangataAddress","encodeAddress","chainConfig","mangata","ss58","assets","chain","rococo","proxyAddress","mangataHelper","getProxyAccount","tokens","turing","init","mangataAssets","_","find","console","log","balancePromises","map","asset","symbol","mangataBalance","getBalance","decimal","tokenConfig","push","balance","free","balanceFloat","div","BN","toNumber","Promise","all","turingHelper","print","util","inspect","depth","colors"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["account.js"],"sourcesContent":["import { Mangata } from '@mangata-finance/sdk';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { decodeAddress } from '@polkadot/util-crypto';\nimport BN from 'bn.js';\nimport turingHelper from \"./turingHelper\";\nimport mangataHelper from \"./mangataHelper\";\nimport { chainConfig, tokenConfig } from './constants';\nimport _ from 'lodash';\nimport util from \"util\";\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\n\nclass Account {\n    constructor(name) {\n        this.name = name;\n        const keyring = new Keyring();\n        this.account = keyring.addFromUri(`//${name}`, undefined, 'sr25519');\n        this.publicKey= this.account.address;\n\n        const mangataAddress = keyring.encodeAddress(this.publicKey, chainConfig.mangata.ss58);\n\n        this.assets=[\n            {\n                chain: \"rococo\",\n                address: keyring.encodeAddress(this.publicKey, chainConfig.rococo.ss58),\n            },\n            {\n                chain: \"mangata\",\n                address: mangataAddress,\n                proxyAddress: mangataHelper.getProxyAccount(mangataAddress),\n                tokens:[],\n            },\n            {\n                chain: \"turing\",\n                address: keyring.encodeAddress(this.publicKey, chainConfig.turing.ss58),\n                tokens:[],\n            }\n        ]\n    }\n    \n    async init(){\n        const mangataAssets = _.find(this.assets, {chain: \"mangata\"});\n\n        console.log(\"mangataHelper.assets\", mangataHelper.assets);\n        const balancePromises = _.map(mangataHelper.assets, async (asset) => {\n            const { symbol } = asset;\n            console.log(\"symbol\", symbol);\n            const mangataBalance = await mangataHelper.getBalance(symbol, mangataAssets.address);\n            console.log(\"mangataBalance\", mangataBalance);\n            const decimal = tokenConfig[symbol].decimal;\n            console.log(\"mangataBalance\", mangataBalance);\n\n            console.log(mangataAssets);\n            mangataAssets.tokens.push(\n                { \"symbol\":symbol,\n                balance: mangataBalance.free,\n                balanceFloat: mangataBalance.free.div(new BN(decimal)).toNumber()\n            });\n            console.log(mangataAssets);\n        });\n\n        await Promise.all(balancePromises);\n\n        const turing = _.find(this.assets, {chain: \"turing\"});\n        const balance = await turingHelper.getBalance(turing.address);\n        const decimal = tokenConfig['TUR'].decimal;\n        turing.tokens.push({ symbol:'TUR', balance: balance.free, balanceFloat: balance.free.div(new BN(decimal)).toNumber()});\n\n        // Create key names for easy access\n        this.assets.mangata = this.assets[1];\n        this.assets.turing = this.assets[2];\n    }\n\n    print(){\n        console.log(util.inspect(this.assets, {depth: 4, colors: true}))\n    }\n}\n\nexport default Account;"],"mappings":"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"}},"mtime":1668988792196},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/account.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _sdk = require(\"@mangata-finance/sdk\");\nvar _api = require(\"@polkadot/api\");\nvar _util = require(\"@polkadot/util\");\nvar _utilCrypto = require(\"@polkadot/util-crypto\");\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\nvar _turingHelper = _interopRequireDefault(require(\"./turingHelper\"));\nvar _mangataHelper = _interopRequireDefault(require(\"./mangataHelper\"));\nvar _constants = require(\"./constants\");\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _util2 = _interopRequireDefault(require(\"util\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000'\n};\nclass Account {\n  constructor(name) {\n    this.name = name;\n    const keyring = new _api.Keyring();\n    this.keyring = keyring.addFromUri(`//${name}`, undefined, 'sr25519');\n    this.publicKey = this.keyring.address;\n    const mangataAddress = keyring.encodeAddress(this.publicKey, _constants.chainConfig.mangata.ss58);\n    this.assets = [{\n      chain: \"rococo\",\n      address: keyring.encodeAddress(this.publicKey, _constants.chainConfig.rococo.ss58)\n    }, {\n      chain: \"mangata\",\n      address: mangataAddress,\n      proxyAddress: _mangataHelper.default.getProxyAccount(mangataAddress),\n      tokens: []\n    }, {\n      chain: \"turing\",\n      address: keyring.encodeAddress(this.publicKey, _constants.chainConfig.turing.ss58),\n      tokens: []\n    }];\n  }\n  async init() {\n    const mangataAssets = _lodash.default.find(this.assets, {\n      chain: \"mangata\"\n    });\n    const balancePromises = _lodash.default.map(_mangataHelper.default.assets, async asset => {\n      const {\n        symbol\n      } = asset;\n      const mangataBalance = await _mangataHelper.default.getBalance(symbol, mangataAssets.address);\n      const decimal = _constants.tokenConfig[symbol].decimal;\n      mangataAssets.tokens.push({\n        \"symbol\": symbol,\n        balance: mangataBalance.free,\n        balanceFloat: mangataBalance.free.div(new _bn.default(decimal)).toNumber()\n      });\n    });\n    await Promise.all(balancePromises);\n    const turing = _lodash.default.find(this.assets, {\n      chain: \"turing\"\n    });\n    const balance = await _turingHelper.default.getBalance(turing.address);\n    const decimal = _constants.tokenConfig['TUR'].decimal;\n    turing.tokens.push({\n      symbol: 'TUR',\n      balance: balance.free,\n      balanceFloat: balance.free.div(new _bn.default(decimal)).toNumber()\n    });\n  }\n  print() {\n    console.log(_util2.default.inspect(this.assets, {\n      depth: 4,\n      colors: true\n    }));\n  }\n}\nvar _default = Account;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUVVJJTkdfUEFSQV9JRCIsIk1BTkdBVEFfUEFSQV9JRCIsInByb2Nlc3MiLCJlbnYiLCJERUNJTUFMIiwiTUdSIiwiS1NNIiwiVFVSIiwiQWNjb3VudCIsImNvbnN0cnVjdG9yIiwibmFtZSIsImtleXJpbmciLCJLZXlyaW5nIiwiYWRkRnJvbVVyaSIsInVuZGVmaW5lZCIsInB1YmxpY0tleSIsImFkZHJlc3MiLCJtYW5nYXRhQWRkcmVzcyIsImVuY29kZUFkZHJlc3MiLCJjaGFpbkNvbmZpZyIsIm1hbmdhdGEiLCJzczU4IiwiYXNzZXRzIiwiY2hhaW4iLCJyb2NvY28iLCJwcm94eUFkZHJlc3MiLCJtYW5nYXRhSGVscGVyIiwiZ2V0UHJveHlBY2NvdW50IiwidG9rZW5zIiwidHVyaW5nIiwiaW5pdCIsIm1hbmdhdGFBc3NldHMiLCJfIiwiZmluZCIsImJhbGFuY2VQcm9taXNlcyIsIm1hcCIsImFzc2V0Iiwic3ltYm9sIiwibWFuZ2F0YUJhbGFuY2UiLCJnZXRCYWxhbmNlIiwiZGVjaW1hbCIsInRva2VuQ29uZmlnIiwicHVzaCIsImJhbGFuY2UiLCJmcmVlIiwiYmFsYW5jZUZsb2F0IiwiZGl2IiwiQk4iLCJ0b051bWJlciIsIlByb21pc2UiLCJhbGwiLCJ0dXJpbmdIZWxwZXIiLCJwcmludCIsImNvbnNvbGUiLCJsb2ciLCJ1dGlsIiwiaW5zcGVjdCIsImRlcHRoIiwiY29sb3JzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbWlrYXNhL0NvZGUveGNtLWRlbW8vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbImFjY291bnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTWFuZ2F0YSB9IGZyb20gJ0BtYW5nYXRhLWZpbmFuY2Uvc2RrJztcbmltcG9ydCB7IEFwaVByb21pc2UsIFdzUHJvdmlkZXIsIEtleXJpbmcgfSBmcm9tIFwiQHBvbGthZG90L2FwaVwiO1xuaW1wb3J0IHsgdThhVG9IZXggfSBmcm9tIFwiQHBvbGthZG90L3V0aWxcIjtcbmltcG9ydCB7IGRlY29kZUFkZHJlc3MgfSBmcm9tICdAcG9sa2Fkb3QvdXRpbC1jcnlwdG8nO1xuaW1wb3J0IEJOIGZyb20gJ2JuLmpzJztcbmltcG9ydCB0dXJpbmdIZWxwZXIgZnJvbSBcIi4vdHVyaW5nSGVscGVyXCI7XG5pbXBvcnQgbWFuZ2F0YUhlbHBlciBmcm9tIFwiLi9tYW5nYXRhSGVscGVyXCI7XG5pbXBvcnQgeyBjaGFpbkNvbmZpZywgdG9rZW5Db25maWcgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHV0aWwgZnJvbSBcInV0aWxcIjtcblxuY29uc3QgVFVSSU5HX1BBUkFfSUQgPSAyMTE0O1xuY29uc3QgTUFOR0FUQV9QQVJBX0lEID0gcHJvY2Vzcy5lbnYuTUFOR0FUQV9QQVJBX0lEO1xuXG5jb25zdCBERUNJTUFMID0ge1xuICBNR1I6ICcxMDAwMDAwMDAwMDAwMDAwMDAwJyxcbiAgS1NNOiAnMTAwMDAwMDAwMDAwMCcsXG4gIFRVUjogJzEwMDAwMDAwMDAwJyxcbn07XG5cbmNsYXNzIEFjY291bnQge1xuICAgIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgY29uc3Qga2V5cmluZyA9IG5ldyBLZXlyaW5nKCk7XG4gICAgICAgIHRoaXMua2V5cmluZyA9IGtleXJpbmcuYWRkRnJvbVVyaShgLy8ke25hbWV9YCwgdW5kZWZpbmVkLCAnc3IyNTUxOScpO1xuICAgICAgICB0aGlzLnB1YmxpY0tleT0gdGhpcy5rZXlyaW5nLmFkZHJlc3M7XG5cbiAgICAgICAgY29uc3QgbWFuZ2F0YUFkZHJlc3MgPSBrZXlyaW5nLmVuY29kZUFkZHJlc3ModGhpcy5wdWJsaWNLZXksIGNoYWluQ29uZmlnLm1hbmdhdGEuc3M1OCk7XG5cbiAgICAgICAgdGhpcy5hc3NldHM9W1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNoYWluOiBcInJvY29jb1wiLFxuICAgICAgICAgICAgICAgIGFkZHJlc3M6IGtleXJpbmcuZW5jb2RlQWRkcmVzcyh0aGlzLnB1YmxpY0tleSwgY2hhaW5Db25maWcucm9jb2NvLnNzNTgpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGFpbjogXCJtYW5nYXRhXCIsXG4gICAgICAgICAgICAgICAgYWRkcmVzczogbWFuZ2F0YUFkZHJlc3MsXG4gICAgICAgICAgICAgICAgcHJveHlBZGRyZXNzOiBtYW5nYXRhSGVscGVyLmdldFByb3h5QWNjb3VudChtYW5nYXRhQWRkcmVzcyksXG4gICAgICAgICAgICAgICAgdG9rZW5zOltdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGFpbjogXCJ0dXJpbmdcIixcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiBrZXlyaW5nLmVuY29kZUFkZHJlc3ModGhpcy5wdWJsaWNLZXksIGNoYWluQ29uZmlnLnR1cmluZy5zczU4KSxcbiAgICAgICAgICAgICAgICB0b2tlbnM6W10sXG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICB9XG4gICAgXG4gICAgYXN5bmMgaW5pdCgpe1xuICAgICAgICBjb25zdCBtYW5nYXRhQXNzZXRzID0gXy5maW5kKHRoaXMuYXNzZXRzLCB7Y2hhaW46IFwibWFuZ2F0YVwifSk7XG5cbiAgICAgICAgY29uc3QgYmFsYW5jZVByb21pc2VzID0gXy5tYXAobWFuZ2F0YUhlbHBlci5hc3NldHMsIGFzeW5jIChhc3NldCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBzeW1ib2wgfSA9IGFzc2V0O1xuICAgICAgICAgICAgY29uc3QgbWFuZ2F0YUJhbGFuY2UgPSBhd2FpdCBtYW5nYXRhSGVscGVyLmdldEJhbGFuY2Uoc3ltYm9sLCBtYW5nYXRhQXNzZXRzLmFkZHJlc3MpO1xuICAgICAgICAgICAgY29uc3QgZGVjaW1hbCA9IHRva2VuQ29uZmlnW3N5bWJvbF0uZGVjaW1hbDtcbiAgICAgICAgICAgIG1hbmdhdGFBc3NldHMudG9rZW5zLnB1c2goXG4gICAgICAgICAgICAgICAgeyBcInN5bWJvbFwiOnN5bWJvbCxcbiAgICAgICAgICAgICAgICBiYWxhbmNlOiBtYW5nYXRhQmFsYW5jZS5mcmVlLFxuICAgICAgICAgICAgICAgIGJhbGFuY2VGbG9hdDogbWFuZ2F0YUJhbGFuY2UuZnJlZS5kaXYobmV3IEJOKGRlY2ltYWwpKS50b051bWJlcigpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoYmFsYW5jZVByb21pc2VzKTtcblxuICAgICAgICBjb25zdCB0dXJpbmcgPSBfLmZpbmQodGhpcy5hc3NldHMsIHtjaGFpbjogXCJ0dXJpbmdcIn0pO1xuICAgICAgICBjb25zdCBiYWxhbmNlID0gYXdhaXQgdHVyaW5nSGVscGVyLmdldEJhbGFuY2UodHVyaW5nLmFkZHJlc3MpO1xuICAgICAgICBjb25zdCBkZWNpbWFsID0gdG9rZW5Db25maWdbJ1RVUiddLmRlY2ltYWw7XG4gICAgICAgIHR1cmluZy50b2tlbnMucHVzaCh7IHN5bWJvbDonVFVSJywgYmFsYW5jZTogYmFsYW5jZS5mcmVlLCBiYWxhbmNlRmxvYXQ6IGJhbGFuY2UuZnJlZS5kaXYobmV3IEJOKGRlY2ltYWwpKS50b051bWJlcigpfSk7XG4gICAgfVxuXG4gICAgcHJpbnQoKXtcbiAgICAgICAgY29uc29sZS5sb2codXRpbC5pbnNwZWN0KHRoaXMuYXNzZXRzLCB7ZGVwdGg6IDQsIGNvbG9yczogdHJ1ZX0pKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudDsiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQXdCO0FBRXhCLE1BQU1BLGNBQWMsR0FBRyxJQUFJO0FBQzNCLE1BQU1DLGVBQWUsR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNGLGVBQWU7QUFFbkQsTUFBTUcsT0FBTyxHQUFH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","map":{"version":3,"names":["TURING_PARA_ID","MANGATA_PARA_ID","process","env","DECIMAL","MGR","KSM","TUR","Account","constructor","name","keyring","Keyring","addFromUri","undefined","publicKey","address","mangataAddress","encodeAddress","chainConfig","mangata","ss58","assets","chain","rococo","proxyAddress","mangataHelper","getProxyAccount","tokens","turing","init","mangataAssets","_","find","balancePromises","map","asset","symbol","mangataBalance","getBalance","decimal","tokenConfig","push","balance","free","balanceFloat","div","BN","toNumber","Promise","all","turingHelper","print","console","log","util","inspect","depth","colors"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["account.js"],"sourcesContent":["import { Mangata } from '@mangata-finance/sdk';\nimport { ApiPromise, WsProvider, Keyring } from \"@polkadot/api\";\nimport { u8aToHex } from \"@polkadot/util\";\nimport { decodeAddress } from '@polkadot/util-crypto';\nimport BN from 'bn.js';\nimport turingHelper from \"./turingHelper\";\nimport mangataHelper from \"./mangataHelper\";\nimport { chainConfig, tokenConfig } from './constants';\nimport _ from 'lodash';\nimport util from \"util\";\n\nconst TURING_PARA_ID = 2114;\nconst MANGATA_PARA_ID = process.env.MANGATA_PARA_ID;\n\nconst DECIMAL = {\n  MGR: '1000000000000000000',\n  KSM: '1000000000000',\n  TUR: '10000000000',\n};\n\nclass Account {\n    constructor(name) {\n        this.name = name;\n        const keyring = new Keyring();\n        this.keyring = keyring.addFromUri(`//${name}`, undefined, 'sr25519');\n        this.publicKey= this.keyring.address;\n\n        const mangataAddress = keyring.encodeAddress(this.publicKey, chainConfig.mangata.ss58);\n\n        this.assets=[\n            {\n                chain: \"rococo\",\n                address: keyring.encodeAddress(this.publicKey, chainConfig.rococo.ss58),\n            },\n            {\n                chain: \"mangata\",\n                address: mangataAddress,\n                proxyAddress: mangataHelper.getProxyAccount(mangataAddress),\n                tokens:[],\n            },\n            {\n                chain: \"turing\",\n                address: keyring.encodeAddress(this.publicKey, chainConfig.turing.ss58),\n                tokens:[],\n            }\n        ]\n    }\n    \n    async init(){\n        const mangataAssets = _.find(this.assets, {chain: \"mangata\"});\n\n        const balancePromises = _.map(mangataHelper.assets, async (asset) => {\n            const { symbol } = asset;\n            const mangataBalance = await mangataHelper.getBalance(symbol, mangataAssets.address);\n            const decimal = tokenConfig[symbol].decimal;\n            mangataAssets.tokens.push(\n                { \"symbol\":symbol,\n                balance: mangataBalance.free,\n                balanceFloat: mangataBalance.free.div(new BN(decimal)).toNumber()\n            });\n        });\n\n        await Promise.all(balancePromises);\n\n        const turing = _.find(this.assets, {chain: \"turing\"});\n        const balance = await turingHelper.getBalance(turing.address);\n        const decimal = tokenConfig['TUR'].decimal;\n        turing.tokens.push({ symbol:'TUR', balance: balance.free, balanceFloat: balance.free.div(new BN(decimal)).toNumber()});\n    }\n\n    print(){\n        console.log(util.inspect(this.assets, {depth: 4, colors: true}))\n    }\n}\n\nexport default Account;"],"mappings":"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"}},"mtime":1668989245568},"{\"assumptions\":{},\"sourceRoot\":\"/Users/mikasa/Code/xcm-demo/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/mikasa/Code/xcm-demo\",\"filename\":\"/Users/mikasa/Code/xcm-demo/src/common/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/mikasa/Code/xcm-demo\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sendExtrinsic = void 0;\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst sendExtrinsic = async (api, extrinsic, keyPair, {\n  isSudo = false\n} = {}) => {\n  return new Promise(resolve => {\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n    newExtrinsic.signAndSend(keyPair, {\n      nonce: -1\n    }, ({\n      status,\n      dispatchError\n    }) => {\n      console.log(\"status\", status);\n      if (status.type === 'Finalized') {\n        console.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n        if (!_lodash.default.isNil(dispatchError)) {\n          if (dispatchError.isModule) {\n            const metaError = api.registry.findMetaError(dispatchError.asModule);\n            const {\n              docs,\n              name,\n              section\n            } = metaError;\n            const dispatchErrorMessage = JSON.stringify({\n              docs,\n              name,\n              section\n            });\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`;\n            console.log(errMsg);\n          } else {\n            const errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`;\n            console.log(errMsg);\n          }\n        }\n        resolve(status.asFinalized.toString());\n      }\n    });\n  });\n};\nexports.sendExtrinsic = sendExtrinsic;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kRXh0cmluc2ljIiwiYXBpIiwiZXh0cmluc2ljIiwia2V5UGFpciIsImlzU3VkbyIsIlByb21pc2UiLCJyZXNvbHZlIiwibmV3RXh0cmluc2ljIiwidHgiLCJzdWRvIiwic2lnbkFuZFNlbmQiLCJub25jZSIsInN0YXR1cyIsImRpc3BhdGNoRXJyb3IiLCJjb25zb2xlIiwibG9nIiwidHlwZSIsImFzRmluYWxpemVkIiwidG9TdHJpbmciLCJfIiwiaXNOaWwiLCJpc01vZHVsZSIsIm1ldGFFcnJvciIsInJlZ2lzdHJ5IiwiZmluZE1ldGFFcnJvciIsImFzTW9kdWxlIiwiZG9jcyIsIm5hbWUiLCJzZWN0aW9uIiwiZGlzcGF0Y2hFcnJvck1lc3NhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyTXNnIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbWlrYXNhL0NvZGUveGNtLWRlbW8vc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBjb25zdCBzZW5kRXh0cmluc2ljID0gYXN5bmMgKGFwaSwgZXh0cmluc2ljLCBrZXlQYWlyLCB7IGlzU3VkbyA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblxuICAgIGNvbnN0IG5ld0V4dHJpbnNpYyA9IGlzU3VkbyA/IGFwaS50eC5zdWRvLnN1ZG8oZXh0cmluc2ljKSA6IGV4dHJpbnNpYztcblx0XHRuZXdFeHRyaW5zaWMuc2lnbkFuZFNlbmQoa2V5UGFpciwgeyBub25jZTogLTEgfSwgKHsgc3RhdHVzLCBkaXNwYXRjaEVycm9yIH0pID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKFwic3RhdHVzXCIsIHN0YXR1cyk7XG5cdFx0XHRpZiAoc3RhdHVzLnR5cGUgPT09ICdGaW5hbGl6ZWQnKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdGaW5hbGl6ZSBleHRyaW5zaWMgaW4gYmxvY2s6ICcsIHN0YXR1cy5hc0ZpbmFsaXplZC50b1N0cmluZygpKTtcblxuXHRcdFx0XHRpZiAoIV8uaXNOaWwoZGlzcGF0Y2hFcnJvcikpIHtcblx0XHRcdFx0XHRpZiAoZGlzcGF0Y2hFcnJvci5pc01vZHVsZSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgbWV0YUVycm9yID0gYXBpLnJlZ2lzdHJ5LmZpbmRNZXRhRXJyb3IoZGlzcGF0Y2hFcnJvci5hc01vZHVsZSlcblx0XHRcdFx0XHRcdGNvbnN0IHsgZG9jcywgbmFtZSwgc2VjdGlvbiB9ID0gbWV0YUVycm9yXG5cdFx0XHRcdFx0XHRjb25zdCBkaXNwYXRjaEVycm9yTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHsgZG9jcywgbmFtZSwgc2VjdGlvbiB9KVxuXHRcdFx0XHRcdFx0Y29uc3QgZXJyTXNnID0gYFRyYW5zYWN0aW9uIGZpbmFsaXplZCB3aXRoIGVycm9yIGJ5IGJsb2NrY2hhaW4gJHtkaXNwYXRjaEVycm9yTWVzc2FnZX1gXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnJNc2cpXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNvbnN0IGVyck1zZyA9IGBUcmFuc2FjdGlvbiBmaW5hbGl6ZWQgd2l0aCBlcnJvciBieSBibG9ja2NoYWluICR7ZGlzcGF0Y2hFcnJvci50b1N0cmluZygpfWBcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGVyck1zZylcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXNvbHZlKHN0YXR1cy5hc0ZpbmFsaXplZC50b1N0cmluZygpKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUF1QjtBQUVoQixNQUFNQSxhQUFhLEdBQUcsT0FBT0MsR0FBRyxFQUFFQyxTQUFTLEVBQUVDLE9BQU8sRUFBRTtFQUFFQyxNQUFNLEdBQUc7QUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUs7RUFDeEYsT0FBTyxJQUFJQyxPQUFPLENBQUVDLE9BQU8sSUFBSztJQUU3QixNQUFNQyxZQUFZLEdBQUdILE1BQU0sR0FBR0gsR0FBRyxDQUFDTyxFQUFFLENBQUNDLElBQUksQ0FBQ0EsSUFBSSxDQUFDUCxTQUFTLENBQUMsR0FBR0EsU0FBUztJQUN2RUssWUFBWSxDQUFDRyxXQUFXLENBQUNQLE9BQU8sRUFBRTtNQUFFUSxLQUFLLEVBQUUsQ0FBQztJQUFFLENBQUMsRUFBRSxDQUFDO01BQUVDLE1BQU07TUFBRUM7SUFBYyxDQUFDLEtBQUs7TUFDL0VDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFFBQVEsRUFBRUgsTUFBTSxDQUFDO01BQzdCLElBQUlBLE1BQU0sQ0FBQ0ksSUFBSSxLQUFLLFdBQVcsRUFBRTtRQUNoQ0YsT0FBTyxDQUFDQyxHQUFHLENBQUMsK0JBQStCLEVBQUVILE1BQU0sQ0FBQ0ssV0FBVyxDQUFDQyxRQUFRLEVBQUUsQ0FBQztRQUUzRSxJQUFJLENBQUNDLGVBQUMsQ0FBQ0MsS0FBSyxDQUFDUCxhQUFhLENBQUMsRUFBRTtVQUM1QixJQUFJQSxhQUFhLENBQUNRLFFBQVEsRUFBRTtZQUMzQixNQUFNQyxTQUFTLEdBQUdyQixHQUFHLENBQUNzQixRQUFRLENBQUNDLGFBQWEsQ0FBQ1gsYUFBYSxDQUFDWSxRQUFRLENBQUM7WUFDcEUsTUFBTTtjQUFFQyxJQUFJO2NBQUVDLElBQUk7Y0FBRUM7WUFBUSxDQUFDLEdBQUdOLFNBQVM7WUFDekMsTUFBTU8sb0JBQW9CLEdBQUdDLElBQUksQ0FBQ0MsU0FBUyxDQUFDO2NBQUVMLElBQUk7Y0FBRUMsSUFBSTtjQUFFQztZQUFRLENBQUMsQ0FBQztZQUNwRSxNQUFNSSxNQUFNLEdBQUksa0RBQWlESCxvQkFBcUIsRUFBQztZQUN2RmYsT0FBTyxDQUFDQyxHQUFHLENBQUNpQixNQUFNLENBQUM7VUFDcEIsQ0FBQyxNQUFNO1lBQ04sTUFBTUEsTUFBTSxHQUFJLGtEQUFpRG5CLGFBQWEsQ0FBQ0ssUUFBUSxFQUFHLEVBQUM7WUFDM0ZKLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDaUIsTUFBTSxDQUFDO1VBQ3BCO1FBQ0Q7UUFFQTFCLE9BQU8sQ0FBQ00sTUFBTSxDQUFDSyxXQUFXLENBQUNDLFFBQVEsRUFBRSxDQUFDO01BQ3ZDO0lBQ0QsQ0FBQyxDQUFDO0VBQ0gsQ0FBQyxDQUFDO0FBQ0gsQ0FBQztBQUFBIn0=","map":{"version":3,"names":["sendExtrinsic","api","extrinsic","keyPair","isSudo","Promise","resolve","newExtrinsic","tx","sudo","signAndSend","nonce","status","dispatchError","console","log","type","asFinalized","toString","_","isNil","isModule","metaError","registry","findMetaError","asModule","docs","name","section","dispatchErrorMessage","JSON","stringify","errMsg"],"sourceRoot":"/Users/mikasa/Code/xcm-demo/src/common/","sources":["utils.js"],"sourcesContent":["import _ from 'lodash';\n\nexport const sendExtrinsic = async (api, extrinsic, keyPair, { isSudo = false } = {}) => {\n\treturn new Promise((resolve) => {\n\n    const newExtrinsic = isSudo ? api.tx.sudo.sudo(extrinsic) : extrinsic;\n\t\tnewExtrinsic.signAndSend(keyPair, { nonce: -1 }, ({ status, dispatchError }) => {\n\t\t\tconsole.log(\"status\", status);\n\t\t\tif (status.type === 'Finalized') {\n\t\t\t\tconsole.log('Finalize extrinsic in block: ', status.asFinalized.toString());\n\n\t\t\t\tif (!_.isNil(dispatchError)) {\n\t\t\t\t\tif (dispatchError.isModule) {\n\t\t\t\t\t\tconst metaError = api.registry.findMetaError(dispatchError.asModule)\n\t\t\t\t\t\tconst { docs, name, section } = metaError\n\t\t\t\t\t\tconst dispatchErrorMessage = JSON.stringify({ docs, name, section })\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchErrorMessage}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst errMsg = `Transaction finalized with error by blockchain ${dispatchError.toString()}`\n\t\t\t\t\t\tconsole.log(errMsg)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve(status.asFinalized.toString());\n\t\t\t}\n\t\t});\n\t});\n}"],"mappings":";;;;;;AAAA;AAAuB;AAEhB,MAAMA,aAAa,GAAG,OAAOC,GAAG,EAAEC,SAAS,EAAEC,OAAO,EAAE;EAAEC,MAAM,GAAG;AAAM,CAAC,GAAG,CAAC,CAAC,KAAK;EACxF,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;IAE7B,MAAMC,YAAY,GAAGH,MAAM,GAAGH,GAAG,CAACO,EAAE,CAACC,IAAI,CAACA,IAAI,CAACP,SAAS,CAAC,GAAGA,SAAS;IACvEK,YAAY,CAACG,WAAW,CAACP,OAAO,EAAE;MAAEQ,KAAK,EAAE,CAAC;IAAE,CAAC,EAAE,CAAC;MAAEC,MAAM;MAAEC;IAAc,CAAC,KAAK;MAC/EC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEH,MAAM,CAAC;MAC7B,IAAIA,MAAM,CAACI,IAAI,KAAK,WAAW,EAAE;QAChCF,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEH,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;QAE3E,IAAI,CAACC,eAAC,CAACC,KAAK,CAACP,aAAa,CAAC,EAAE;UAC5B,IAAIA,aAAa,CAACQ,QAAQ,EAAE;YAC3B,MAAMC,SAAS,GAAGrB,GAAG,CAACsB,QAAQ,CAACC,aAAa,CAACX,aAAa,CAACY,QAAQ,CAAC;YACpE,MAAM;cAAEC,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,GAAGN,SAAS;YACzC,MAAMO,oBAAoB,GAAGC,IAAI,CAACC,SAAS,CAAC;cAAEL,IAAI;cAAEC,IAAI;cAAEC;YAAQ,CAAC,CAAC;YACpE,MAAMI,MAAM,GAAI,kDAAiDH,oBAAqB,EAAC;YACvFf,OAAO,CAACC,GAAG,CAACiB,MAAM,CAAC;UACpB,CAAC,MAAM;YACN,MAAMA,MAAM,GAAI,kDAAiDnB,aAAa,CAACK,QAAQ,EAAG,EAAC;YAC3FJ,OAAO,CAACC,GAAG,CAACiB,MAAM,CAAC;UACpB;QACD;QAEA1B,OAAO,CAACM,MAAM,CAACK,WAAW,CAACC,QAAQ,EAAE,CAAC;MACvC;IACD,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAAA"}},"mtime":1668989758849}}